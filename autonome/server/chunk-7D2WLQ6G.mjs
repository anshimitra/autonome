import './polyfills.server.mjs';
import{a as mf}from"./chunk-NOTL7ADE.mjs";import{a as Yd,d as Xd}from"./chunk-AHD53AN3.mjs";import{a as ds,b as fs,c as ps,d as gs,e as ms,f as ys,g as cf,h as vs,i as Ss,j as hf,k as df,l as pf}from"./chunk-CNAVFXVK.mjs";import{a as Za,c as ff,i as gf}from"./chunk-NZDS2GPD.mjs";import{b as Zd,d as ef,f as tf,h as nf,i as hs,j as rf,k as sf,l as of,m as af,o as lf,q as xn,u as uf}from"./chunk-LOFND3JM.mjs";import{d as $d,e as Wd,i as Kd,j as Hd,k as Qd,m as us,r as Jd}from"./chunk-RLYSOZOD.mjs";import{d as Gd,u as jd}from"./chunk-BSW6OZM2.mjs";import{$ as Yn,Ab as Jn,Fa as Bd,S as Pd,Sa as Xn,U as ss,X as os,aa as as,eb as qd,fb as Ud,gb as cs,jc as zd,ka as Vt,ma as Ld,na as en,ra as ls,ub as Vd,wa as Fd}from"./chunk-XF4G7L4G.mjs";import{c as K,e as g,g as Md,i as U}from"./chunk-LK223424.mjs";var $=g(Ze=>{"use strict";Object.defineProperty(Ze,"__esModule",{value:!0});Ze.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=Ze.DEFAULT_MAX_SEND_MESSAGE_LENGTH=Ze.Propagate=Ze.LogVerbosity=Ze.Status=void 0;var Vp=function(t){return t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t}(Vp||(Ze.Status=Vp={})),zp=function(t){return t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.ERROR=2]="ERROR",t[t.NONE=3]="NONE",t}(zp||(Ze.LogVerbosity=zp={})),Gp=function(t){return t[t.DEADLINE=1]="DEADLINE",t[t.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",t[t.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",t[t.CANCELLATION=8]="CANCELLATION",t[t.DEFAULTS=65535]="DEFAULTS",t}(Gp||(Ze.Propagate=Gp={}));Ze.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;Ze.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var jl=g((dN,eE)=>{eE.exports={name:"@grpc/grpc-js",version:"1.9.13",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:"^8.13.0 || >=10.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@types/gulp":"^4.0.6","@types/gulp-mocha":"0.0.32","@types/lodash":"^4.14.186","@types/mocha":"^5.2.6","@types/ncp":"^2.0.1","@types/pify":"^3.0.2","@types/semver":"^7.3.9","@typescript-eslint/eslint-plugin":"^5.59.11","@typescript-eslint/parser":"^5.59.11","@typescript-eslint/typescript-estree":"^5.59.11","clang-format":"^1.0.55",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.4",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.3.5","ts-node":"^10.9.1",typescript:"^5.1.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.8","@types/node":">=12.12.47"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var le=g(Ue=>{"use strict";var $l,Wl,Kl,Hl;Object.defineProperty(Ue,"__esModule",{value:!0});Ue.isTracerEnabled=Ue.trace=Ue.log=Ue.setLoggerVerbosity=Ue.setLogger=Ue.getLogger=void 0;var rn=$(),tE=K("process"),nE=jl().version,rE={error:(t,...e)=>{console.error("E "+t,...e)},info:(t,...e)=>{console.error("I "+t,...e)},debug:(t,...e)=>{console.error("D "+t,...e)}},Bn=rE,sr=rn.LogVerbosity.ERROR,iE=(Wl=($l=process.env.GRPC_NODE_VERBOSITY)!==null&&$l!==void 0?$l:process.env.GRPC_VERBOSITY)!==null&&Wl!==void 0?Wl:"";switch(iE.toUpperCase()){case"DEBUG":sr=rn.LogVerbosity.DEBUG;break;case"INFO":sr=rn.LogVerbosity.INFO;break;case"ERROR":sr=rn.LogVerbosity.ERROR;break;case"NONE":sr=rn.LogVerbosity.NONE;break;default:}var sE=()=>Bn;Ue.getLogger=sE;var oE=t=>{Bn=t};Ue.setLogger=oE;var aE=t=>{sr=t};Ue.setLoggerVerbosity=aE;var lE=(t,...e)=>{let n;if(t>=sr){switch(t){case rn.LogVerbosity.DEBUG:n=Bn.debug;break;case rn.LogVerbosity.INFO:n=Bn.info;break;case rn.LogVerbosity.ERROR:n=Bn.error;break}n||(n=Bn.error),n&&n.bind(Bn)(...e)}};Ue.log=lE;var cE=(Hl=(Kl=process.env.GRPC_NODE_TRACE)!==null&&Kl!==void 0?Kl:process.env.GRPC_TRACE)!==null&&Hl!==void 0?Hl:"",Ql=new Set,jp=new Set;for(let t of cE.split(","))t.startsWith("-")?jp.add(t.substring(1)):Ql.add(t);var uE=Ql.has("all");function hE(t,e,n){$p(e)&&(0,Ue.log)(t,new Date().toISOString()+" | v"+nE+" "+tE.pid+" | "+e+" | "+n)}Ue.trace=hE;function $p(t){return!jp.has(t)&&(uE||Ql.has(t))}Ue.isTracerEnabled=$p});var Qs=g(or=>{"use strict";Object.defineProperty(or,"__esModule",{value:!0});or.getErrorCode=or.getErrorMessage=void 0;function dE(t){return t instanceof Error?t.message:String(t)}or.getErrorMessage=dE;function fE(t){return typeof t=="object"&&t!==null&&"code"in t&&typeof t.code=="number"?t.code:null}or.getErrorCode=fE});var Ve=g(Xs=>{"use strict";Object.defineProperty(Xs,"__esModule",{value:!0});Xs.Metadata=void 0;var pE=le(),gE=$(),mE=Qs(),yE=/^[0-9a-z_.-]+$/,vE=/^[ -~]*$/;function SE(t){return yE.test(t)}function TE(t){return vE.test(t)}function Kp(t){return t.endsWith("-bin")}function EE(t){return!t.startsWith("grpc-")}function Ys(t){return t.toLowerCase()}function Wp(t,e){if(!SE(t))throw new Error('Metadata key "'+t+'" contains illegal characters');if(e!=null)if(Kp(t)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!TE(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var Yl=class t{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,n){e=Ys(e),Wp(e,n),this.internalRepr.set(e,[n])}add(e,n){e=Ys(e),Wp(e,n);let r=this.internalRepr.get(e);r===void 0?this.internalRepr.set(e,[n]):r.push(n)}remove(e){e=Ys(e),this.internalRepr.delete(e)}get(e){return e=Ys(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[n,r]of this.internalRepr)if(r.length>0){let i=r[0];e[n]=Buffer.isBuffer(i)?Buffer.from(i):i}return e}clone(){let e=new t(this.options),n=e.internalRepr;for(let[r,i]of this.internalRepr){let s=i.map(o=>Buffer.isBuffer(o)?Buffer.from(o):o);n.set(r,s)}return e}merge(e){for(let[n,r]of e.internalRepr){let i=(this.internalRepr.get(n)||[]).concat(r);this.internalRepr.set(n,i)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[n,r]of this.internalRepr)e[n]=r.map(wE);return e}toJSON(){let e={};for(let[n,r]of this.internalRepr)e[n]=r;return e}static fromHttp2Headers(e){let n=new t;for(let r of Object.keys(e)){if(r.charAt(0)===":")continue;let i=e[r];try{Kp(r)?Array.isArray(i)?i.forEach(s=>{n.add(r,Buffer.from(s,"base64"))}):i!==void 0&&(EE(r)?i.split(",").forEach(s=>{n.add(r,Buffer.from(s.trim(),"base64"))}):n.add(r,Buffer.from(i,"base64"))):Array.isArray(i)?i.forEach(s=>{n.add(r,s)}):i!==void 0&&n.add(r,i)}catch(s){let o=`Failed to add metadata entry ${r}: ${i}. ${(0,mE.getErrorMessage)(s)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,pE.log)(gE.LogVerbosity.ERROR,o)}}return n}};Xs.Metadata=Yl;var wE=t=>Buffer.isBuffer(t)?t.toString("base64"):t});var tc=g(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.CallCredentials=void 0;var ec=Ve();function CE(t){return"getRequestHeaders"in t&&typeof t.getRequestHeaders=="function"}var ar=class t{static createFromMetadataGenerator(e){return new Jl(e)}static createFromGoogleCredential(e){return t.createFromMetadataGenerator((n,r)=>{let i;CE(e)?i=e.getRequestHeaders(n.service_url):i=new Promise((s,o)=>{e.getRequestMetadata(n.service_url,(a,l)=>{if(a){o(a);return}if(!l){o(new Error("Headers not set by metadata plugin"));return}s(l)})}),i.then(s=>{let o=new ec.Metadata;for(let a of Object.keys(s))o.add(a,s[a]);r(null,o)},s=>{r(s)})})}static createEmpty(){return new Zl}};Js.CallCredentials=ar;var Xl=class t extends ar{constructor(e){super(),this.creds=e}generateMetadata(e){return U(this,null,function*(){let n=new ec.Metadata,r=yield Promise.all(this.creds.map(i=>i.generateMetadata(e)));for(let i of r)n.merge(i);return n})}compose(e){return new t(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof t?this.creds.every((n,r)=>n._equals(e.creds[r])):!1}},Jl=class t extends ar{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((n,r)=>{this.metadataGenerator(e,(i,s)=>{s!==void 0?n(s):r(i)})})}compose(e){return new Xl([this,e])}_equals(e){return this===e?!0:e instanceof t?this.metadataGenerator===e.metadataGenerator:!1}},Zl=class t extends ar{generateMetadata(e){return Promise.resolve(new ec.Metadata)}compose(e){return e}_equals(e){return e instanceof t}}});var rc=g(lr=>{"use strict";Object.defineProperty(lr,"__esModule",{value:!0});lr.getDefaultRootsData=lr.CIPHER_SUITES=void 0;var _E=K("fs");lr.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var Hp=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,nc=null;function bE(){return Hp?(nc===null&&(nc=_E.readFileSync(Hp)),nc):null}lr.getDefaultRootsData=bE});var to=g(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.ChannelCredentials=void 0;var IE=K("tls"),AE=tc(),Qp=rc();function ic(t,e){if(t&&!(t instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var cr=class{constructor(e){this.callCredentials=e||AE.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,n,r,i){var s;if(ic(e,"Root certificate"),ic(n,"Private key"),ic(r,"Certificate chain"),n&&!r)throw new Error("Private key must be given with accompanying certificate chain");if(!n&&r)throw new Error("Certificate chain must be given with accompanying private key");let o=(0,IE.createSecureContext)({ca:(s=e??(0,Qp.getDefaultRootsData)())!==null&&s!==void 0?s:void 0,key:n??void 0,cert:r??void 0,ciphers:Qp.CIPHER_SUITES});return new Zs(o,i??{})}static createFromSecureContext(e,n){return new Zs(e,n??{})}static createInsecure(){return new sc}};eo.ChannelCredentials=cr;var sc=class t extends cr{constructor(e){super(e)}compose(e){throw new Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof t}},Zs=class t extends cr{constructor(e,n){super(),this.secureContext=e,this.verifyOptions=n,this.connectionOptions={secureContext:e},n?.checkServerIdentity&&(this.connectionOptions.checkServerIdentity=n.checkServerIdentity)}compose(e){let n=this.callCredentials.compose(e);return new oc(this,n)}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof t?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}},oc=class t extends cr{constructor(e,n){super(n),this.channelCredentials=e}compose(e){let n=this.callCredentials.compose(e);return new t(this.channelCredentials,n)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof t?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}}});var on=g(Oe=>{"use strict";Object.defineProperty(Oe,"__esModule",{value:!0});Oe.validateLoadBalancingConfig=Oe.getFirstUsableConfig=Oe.isLoadBalancerNameRegistered=Oe.createLoadBalancer=Oe.registerDefaultLoadBalancerType=Oe.registerLoadBalancerType=Oe.createChildChannelControlHelper=void 0;function RE(t,e){var n,r,i,s,o,a,l,c,h,d;return{createSubchannel:(r=(n=e.createSubchannel)===null||n===void 0?void 0:n.bind(e))!==null&&r!==void 0?r:t.createSubchannel.bind(t),updateState:(s=(i=e.updateState)===null||i===void 0?void 0:i.bind(e))!==null&&s!==void 0?s:t.updateState.bind(t),requestReresolution:(a=(o=e.requestReresolution)===null||o===void 0?void 0:o.bind(e))!==null&&a!==void 0?a:t.requestReresolution.bind(t),addChannelzChild:(c=(l=e.addChannelzChild)===null||l===void 0?void 0:l.bind(e))!==null&&c!==void 0?c:t.addChannelzChild.bind(t),removeChannelzChild:(d=(h=e.removeChannelzChild)===null||h===void 0?void 0:h.bind(e))!==null&&d!==void 0?d:t.removeChannelzChild.bind(t)}}Oe.createChildChannelControlHelper=RE;var sn={},ac=null;function DE(t,e,n){sn[t]={LoadBalancer:e,LoadBalancingConfig:n}}Oe.registerLoadBalancerType=DE;function NE(t){ac=t}Oe.registerDefaultLoadBalancerType=NE;function kE(t,e){let n=t.getLoadBalancerName();return n in sn?new sn[n].LoadBalancer(e):null}Oe.createLoadBalancer=kE;function OE(t){return t in sn}Oe.isLoadBalancerNameRegistered=OE;function xE(t,e=!1){for(let n of t)if(n.getLoadBalancerName()in sn)return n;return e&&ac?new sn[ac].LoadBalancingConfig:null}Oe.getFirstUsableConfig=xE;function ME(t){if(!(t!==null&&typeof t=="object"))throw new Error("Load balancing config must be an object");let e=Object.keys(t);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let n=e[0];if(n in sn)return sn[n].LoadBalancingConfig.createFromJson(t[n]);throw new Error(`Unrecognized load balancing config name ${n}`)}Oe.validateLoadBalancingConfig=ME});var lc=g(an=>{"use strict";Object.defineProperty(an,"__esModule",{value:!0});an.extractAndSelectServiceConfig=an.validateServiceConfig=an.validateRetryThrottling=void 0;var PE=K("os"),no=$(),LE=on(),ro=/^\d+(\.\d{1,9})?s$/,FE="node";function BE(t){if("service"in t&&t.service!==""){if(typeof t.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof t.service}`);if("method"in t&&t.method!==""){if(typeof t.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof t.service}`);return{service:t.service,method:t.method}}else return{service:t.service}}else{if("method"in t&&t.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function qE(t){if(!("maxAttempts"in t)||!Number.isInteger(t.maxAttempts)||t.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in t)||typeof t.initialBackoff!="string"||!ro.test(t.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in t)||typeof t.maxBackoff!="string"||!ro.test(t.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in t)||typeof t.backoffMultiplier!="number"||t.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in t&&Array.isArray(t.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(t.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of t.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(no.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(no.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:t.maxAttempts,initialBackoff:t.initialBackoff,maxBackoff:t.maxBackoff,backoffMultiplier:t.backoffMultiplier,retryableStatusCodes:t.retryableStatusCodes}}function UE(t){if(!("maxAttempts"in t)||!Number.isInteger(t.maxAttempts)||t.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in t&&(typeof t.hedgingDelay!="string"||!ro.test(t.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in t&&Array.isArray(t.nonFatalStatusCodes))for(let n of t.nonFatalStatusCodes)if(typeof n=="number"){if(!Object.values(no.Status).includes(n))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof n=="string"){if(!Object.values(no.Status).includes(n.toUpperCase()))throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:t.maxAttempts};return t.hedgingDelay&&(e.hedgingDelay=t.hedgingDelay),t.nonFatalStatusCodes&&(e.nonFatalStatusCodes=t.nonFatalStatusCodes),e}function VE(t){var e;let n={name:[]};if(!("name"in t)||!Array.isArray(t.name))throw new Error("Invalid method config: invalid name array");for(let r of t.name)n.name.push(BE(r));if("waitForReady"in t){if(typeof t.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");n.waitForReady=t.waitForReady}if("timeout"in t)if(typeof t.timeout=="object"){if(!("seconds"in t.timeout)||typeof t.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in t.timeout)||typeof t.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");n.timeout=t.timeout}else if(typeof t.timeout=="string"&&ro.test(t.timeout)){let r=t.timeout.substring(0,t.timeout.length-1).split(".");n.timeout={seconds:r[0]|0,nanos:((e=r[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in t){if(typeof t.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");n.maxRequestBytes=t.maxRequestBytes}if("maxResponseBytes"in t){if(typeof t.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");n.maxResponseBytes=t.maxResponseBytes}if("retryPolicy"in t){if("hedgingPolicy"in t)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");n.retryPolicy=qE(t.retryPolicy)}else"hedgingPolicy"in t&&(n.hedgingPolicy=UE(t.hedgingPolicy));return n}function Yp(t){if(!("maxTokens"in t)||typeof t.maxTokens!="number"||t.maxTokens<=0||t.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in t)||typeof t.tokenRatio!="number"||t.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+t.maxTokens.toFixed(3),tokenRatio:+t.tokenRatio.toFixed(3)}}an.validateRetryThrottling=Yp;function Xp(t){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in t)if(typeof t.loadBalancingPolicy=="string")e.loadBalancingPolicy=t.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in t)if(Array.isArray(t.loadBalancingConfig))for(let r of t.loadBalancingConfig)e.loadBalancingConfig.push((0,LE.validateLoadBalancingConfig)(r));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in t&&Array.isArray(t.methodConfig))for(let r of t.methodConfig)e.methodConfig.push(VE(r));"retryThrottling"in t&&(e.retryThrottling=Yp(t.retryThrottling));let n=[];for(let r of e.methodConfig)for(let i of r.name){for(let s of n)if(i.service===s.service&&i.method===s.method)throw new Error(`Invalid service config: duplicate name ${i.service}/${i.method}`);n.push(i)}return e}an.validateServiceConfig=Xp;function zE(t){if(!("serviceConfig"in t))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:Xp(t.serviceConfig)};if("clientLanguage"in t)if(Array.isArray(t.clientLanguage)){e.clientLanguage=[];for(let r of t.clientLanguage)if(typeof r=="string")e.clientLanguage.push(r);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in t)if(Array.isArray(t.clientHostname)){e.clientHostname=[];for(let r of t.clientHostname)if(typeof r=="string")e.clientHostname.push(r);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in t)if(typeof t.percentage=="number"&&0<=t.percentage&&t.percentage<=100)e.percentage=t.percentage;else throw new Error("Invalid service config choice: invalid percentage");let n=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let r in t)if(!n.includes(r))throw new Error(`Invalid service config choice: unexpected field ${r}`);return e}function GE(t,e){if(!Array.isArray(t))throw new Error("Invalid service config list");for(let n of t){let r=zE(n);if(!(typeof r.percentage=="number"&&e>r.percentage)){if(Array.isArray(r.clientHostname)){let i=!1;for(let s of r.clientHostname)s===PE.hostname()&&(i=!0);if(!i)continue}if(Array.isArray(r.clientLanguage)){let i=!1;for(let s of r.clientLanguage)s===FE&&(i=!0);if(!i)continue}return r.serviceConfig}}throw new Error("No matching service config found")}function jE(t,e){for(let n of t)if(n.length>0&&n[0].startsWith("grpc_config=")){let r=n.join("").substring(12),i=JSON.parse(r);return GE(i,e)}return null}an.extractAndSelectServiceConfig=jE});var et=g(io=>{"use strict";Object.defineProperty(io,"__esModule",{value:!0});io.ConnectivityState=void 0;var Jp=function(t){return t[t.IDLE=0]="IDLE",t[t.CONNECTING=1]="CONNECTING",t[t.READY=2]="READY",t[t.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",t[t.SHUTDOWN=4]="SHUTDOWN",t}(Jp||(io.ConnectivityState=Jp={}))});var Qe=g(ln=>{"use strict";Object.defineProperty(ln,"__esModule",{value:!0});ln.uriToString=ln.splitHostPort=ln.parseUri=void 0;var $E=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function WE(t){let e=$E.exec(t);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}ln.parseUri=WE;var Zp=/^\d+$/;function KE(t){if(t.startsWith("[")){let e=t.indexOf("]");if(e===-1)return null;let n=t.substring(1,e);if(n.indexOf(":")===-1)return null;if(t.length>e+1)if(t[e+1]===":"){let r=t.substring(e+2);return Zp.test(r)?{host:n,port:+r}:null}else return null;else return{host:n}}else{let e=t.split(":");return e.length===2?Zp.test(e[1])?{host:e[0],port:+e[1]}:null:{host:t}}}ln.splitHostPort=KE;function HE(t){let e="";return t.scheme!==void 0&&(e+=t.scheme+":"),t.authority!==void 0&&(e+="//"+t.authority+"/"),e+=t.path,e}ln.uriToString=HE});var _t=g(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.mapUriDefaultScheme=tt.getDefaultAuthority=tt.createResolver=tt.registerDefaultScheme=tt.registerResolver=void 0;var uc=Qe(),ur={},cc=null;function QE(t,e){ur[t]=e}tt.registerResolver=QE;function YE(t){cc=t}tt.registerDefaultScheme=YE;function XE(t,e,n){if(t.scheme!==void 0&&t.scheme in ur)return new ur[t.scheme](t,e,n);throw new Error(`No resolver could be created for target ${(0,uc.uriToString)(t)}`)}tt.createResolver=XE;function JE(t){if(t.scheme!==void 0&&t.scheme in ur)return ur[t.scheme].getDefaultAuthority(t);throw new Error(`Invalid target ${(0,uc.uriToString)(t)}`)}tt.getDefaultAuthority=JE;function ZE(t){return t.scheme===void 0||!(t.scheme in ur)?cc!==null?{scheme:cc,authority:void 0,path:(0,uc.uriToString)(t)}:null:t}tt.mapUriDefaultScheme=ZE});var un=g(cn=>{"use strict";Object.defineProperty(cn,"__esModule",{value:!0});cn.QueuePicker=cn.UnavailablePicker=cn.PickResultType=void 0;var ew=Ve(),tw=$(),so=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.QUEUE=1]="QUEUE",t[t.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",t[t.DROP=3]="DROP",t}(so||(cn.PickResultType=so={})),hc=class{constructor(e){this.status=Object.assign({code:tw.Status.UNAVAILABLE,details:"No connection established",metadata:new ew.Metadata},e)}pick(e){return{pickResultType:so.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};cn.UnavailablePicker=hc;var dc=class{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:so.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};cn.QueuePicker=dc});var Ei=g(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.BackoffTimeout=void 0;var nw=1e3,rw=1.6,iw=12e4,sw=.2;function ow(t,e){return Math.random()*(e-t)+t}var fc=class{constructor(e,n){this.callback=e,this.initialDelay=nw,this.multiplier=rw,this.maxDelay=iw,this.jitter=sw,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,n&&(n.initialDelay&&(this.initialDelay=n.initialDelay),n.multiplier&&(this.multiplier=n.multiplier),n.jitter&&(this.jitter=n.jitter),n.maxDelay&&(this.maxDelay=n.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var n,r;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||(r=(n=this.timerId).unref)===null||r===void 0||r.call(n)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),n=e*this.jitter;this.nextDelay=e+ow(-n,n)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,n=this.startTime;n.setMilliseconds(n.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<n?this.runTimer(n.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,n;this.hasRef=!0,(n=(e=this.timerId).ref)===null||n===void 0||n.call(e)}unref(){var e,n;this.hasRef=!1,(n=(e=this.timerId).unref)===null||n===void 0||n.call(e)}getEndTime(){return this.endTime}};oo.BackoffTimeout=fc});var lo=g(ao=>{"use strict";Object.defineProperty(ao,"__esModule",{value:!0});ao.ChildLoadBalancerHandler=void 0;var aw=on(),lw=et(),cw="child_load_balancer_helper",pc=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(n){this.parent=n,this.child=null}createSubchannel(n,r){return this.parent.channelControlHelper.createSubchannel(n,r)}updateState(n,r){var i;if(this.calledByPendingChild()){if(n===lw.ConnectivityState.CONNECTING)return;(i=this.parent.currentChild)===null||i===void 0||i.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(n,r)}requestReresolution(){var n;let r=(n=this.parent.pendingChild)!==null&&n!==void 0?n:this.parent.currentChild;this.child===r&&this.parent.channelControlHelper.requestReresolution()}setChild(n){this.child=n}addChannelzChild(n){this.parent.channelControlHelper.addChannelzChild(n)}removeChannelzChild(n){this.parent.channelControlHelper.removeChannelzChild(n)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,n){return e.getLoadBalancerName()!==n.getLoadBalancerName()}updateAddressList(e,n,r){let i;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,n)){let s=new this.ChildPolicyHelper(this),o=(0,aw.createLoadBalancer)(n,s);s.setChild(o),this.currentChild===null?(this.currentChild=o,i=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=o,i=this.pendingChild)}else this.pendingChild===null?i=this.currentChild:i=this.pendingChild;this.latestConfig=n,i.updateAddressList(e,n,r)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return cw}};ao.ChildLoadBalancerHandler=pc});var tg=g(co=>{"use strict";Object.defineProperty(co,"__esModule",{value:!0});co.ResolvingLoadBalancer=void 0;var uw=on(),hw=lc(),Ge=et(),dw=_t(),hr=un(),fw=Ei(),gc=$(),pw=Ve(),gw=le(),mw=$(),yw=Qe(),vw=lo(),Sw="resolving_load_balancer";function eg(t){gw.trace(mw.LogVerbosity.DEBUG,Sw,t)}var Tw=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function Ew(t,e,n,r){for(let i of n.name)switch(r){case"EMPTY":if(!i.service&&!i.method)return!0;break;case"SERVICE":if(i.service===t&&!i.method)return!0;break;case"SERVICE_AND_METHOD":if(i.service===t&&i.method===e)return!0}return!1}function ww(t,e,n,r){for(let i of n)if(Ew(t,e,i,r))return i;return null}function Cw(t){return function(n,r){var i,s;let o=n.split("/").filter(c=>c.length>0),a=(i=o[0])!==null&&i!==void 0?i:"",l=(s=o[1])!==null&&s!==void 0?s:"";if(t&&t.methodConfig)for(let c of Tw){let h=ww(a,l,t.methodConfig,c);if(h)return{methodConfig:h,pickInformation:{},status:gc.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:gc.Status.OK,dynamicFilterFactories:[]}}}var mc=class{constructor(e,n,r,i,s){this.target=e,this.channelControlHelper=n,this.onSuccessfulResolution=i,this.onFailedResolution=s,this.latestChildState=Ge.ConnectivityState.IDLE,this.latestChildPicker=new hr.QueuePicker(this),this.currentState=Ge.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,r["grpc.service_config"]?this.defaultServiceConfig=(0,hw.validateServiceConfig)(JSON.parse(r["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(Ge.ConnectivityState.IDLE,new hr.QueuePicker(this)),this.childLoadBalancer=new vw.ChildLoadBalancerHandler({createSubchannel:n.createSubchannel.bind(n),requestReresolution:()=>{this.backoffTimeout.isRunning()?(eg("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,l)=>{this.latestChildState=a,this.latestChildPicker=l,this.updateState(a,l)},addChannelzChild:n.addChannelzChild.bind(n),removeChannelzChild:n.removeChannelzChild.bind(n)}),this.innerResolver=(0,dw.createResolver)(e,{onSuccessfulResolution:(a,l,c,h,d)=>{var f;this.backoffTimeout.stop(),this.backoffTimeout.reset();let p=null;l===null?c===null?(this.previousServiceConfig=null,p=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(c):p=this.previousServiceConfig:(p=l,this.previousServiceConfig=l);let y=(f=p?.loadBalancingConfig)!==null&&f!==void 0?f:[],S=(0,uw.getFirstUsableConfig)(y,!0);if(S===null){this.handleResolutionFailure({code:gc.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new pw.Metadata});return}this.childLoadBalancer.updateAddressList(a,S,d);let C=p??this.defaultServiceConfig;this.onSuccessfulResolution(C,h??Cw(C))},onError:a=>{this.handleResolutionFailure(a)}},r);let o={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new fw.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},o),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===Ge.ConnectivityState.IDLE&&this.updateState(Ge.ConnectivityState.CONNECTING,new hr.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,n){eg((0,yw.uriToString)(this.target)+" "+Ge.ConnectivityState[this.currentState]+" -> "+Ge.ConnectivityState[e]),e===Ge.ConnectivityState.IDLE&&(n=new hr.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,n)}handleResolutionFailure(e){this.latestChildState===Ge.ConnectivityState.IDLE&&(this.updateState(Ge.ConnectivityState.TRANSIENT_FAILURE,new hr.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===Ge.ConnectivityState.IDLE||this.currentState===Ge.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,n){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=Ge.ConnectivityState.IDLE,this.latestChildPicker=new hr.QueuePicker(this),this.currentState=Ge.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};co.ResolvingLoadBalancer=mc});var ng=g(dr=>{"use strict";Object.defineProperty(dr,"__esModule",{value:!0});dr.channelOptionsEqual=dr.recognizedOptions=void 0;dr.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0};function _w(t,e){let n=Object.keys(t).sort(),r=Object.keys(e).sort();if(n.length!==r.length)return!1;for(let i=0;i<n.length;i+=1)if(n[i]!==r[i]||t[n[i]]!==e[r[i]])return!1;return!0}dr.channelOptionsEqual=_w});var It=g(bt=>{"use strict";Object.defineProperty(bt,"__esModule",{value:!0});bt.stringToSubchannelAddress=bt.subchannelAddressToString=bt.subchannelAddressEqual=bt.isTcpSubchannelAddress=void 0;var bw=K("net");function wi(t){return"port"in t}bt.isTcpSubchannelAddress=wi;function Iw(t,e){return!t&&!e?!0:!t||!e?!1:wi(t)?wi(e)&&t.host===e.host&&t.port===e.port:!wi(e)&&t.path===e.path}bt.subchannelAddressEqual=Iw;function Aw(t){return wi(t)?t.host+":"+t.port:t.path}bt.subchannelAddressToString=Aw;var Rw=443;function Dw(t,e){return(0,bw.isIP)(t)?{host:t,port:e??Rw}:{path:t}}bt.stringToSubchannelAddress=Dw});var uo=g(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.addAdminServicesToServer=fr.registerAdminService=void 0;var rg=[];function Nw(t,e){rg.push({getServiceDefinition:t,getHandlers:e})}fr.registerAdminService=Nw;function kw(t){for(let{getServiceDefinition:e,getHandlers:n}of rg)t.addService(e(),n())}fr.addAdminServicesToServer=kw});var ig=g(nt=>{"use strict";Object.defineProperty(nt,"__esModule",{value:!0});nt.ClientDuplexStreamImpl=nt.ClientWritableStreamImpl=nt.ClientReadableStreamImpl=nt.ClientUnaryCallImpl=nt.callErrorFromStatus=void 0;var Ow=K("events"),Ec=K("stream"),Ci=$();function xw(t,e){let n=`${t.code} ${Ci.Status[t.code]}: ${t.details}`,i=`${new Error(n).stack}
for call at
${e}`;return Object.assign(new Error(n),t,{stack:i})}nt.callErrorFromStatus=xw;var yc=class extends Ow.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Ci.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,n;return(n=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&n!==void 0?n:"unknown"}};nt.ClientUnaryCallImpl=yc;var vc=class extends Ec.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Ci.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,n;return(n=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&n!==void 0?n:"unknown"}_read(e){var n;(n=this.call)===null||n===void 0||n.startRead()}};nt.ClientReadableStreamImpl=vc;var Sc=class extends Ec.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Ci.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,n;return(n=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&n!==void 0?n:"unknown"}_write(e,n,r){var i;let s={callback:r},o=Number(n);Number.isNaN(o)||(s.flags=o),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var n;(n=this.call)===null||n===void 0||n.halfClose(),e()}};nt.ClientWritableStreamImpl=Sc;var Tc=class extends Ec.Duplex{constructor(e,n){super({objectMode:!0}),this.serialize=e,this.deserialize=n}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(Ci.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,n;return(n=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&n!==void 0?n:"unknown"}_read(e){var n;(n=this.call)===null||n===void 0||n.startRead()}_write(e,n,r){var i;let s={callback:r},o=Number(n);Number.isNaN(o)||(s.flags=o),(i=this.call)===null||i===void 0||i.sendMessageWithContext(s,e)}_final(e){var n;(n=this.call)===null||n===void 0||n.halfClose(),e()}};nt.ClientDuplexStreamImpl=Tc});var sg=g(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.InterceptingListenerImpl=pr.isInterceptingListener=void 0;function Mw(t){return t.onReceiveMetadata!==void 0&&t.onReceiveMetadata.length===1}pr.isInterceptingListener=Mw;var wc=class{constructor(e,n){this.listener=e,this.nextListener=n,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,n=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(n),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,n=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=n,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(n),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,n=>{this.processingMetadata||this.processingMessage?this.pendingStatus=n:this.nextListener.onReceiveStatus(n)})}};pr.InterceptingListenerImpl=wc});var Dc=g(rt=>{"use strict";Object.defineProperty(rt,"__esModule",{value:!0});rt.getInterceptingCall=rt.InterceptingCall=rt.RequesterBuilder=rt.ListenerBuilder=rt.InterceptorConfigurationError=void 0;var Pw=Ve(),og=sg(),ag=$(),lg=Qs(),bi=class t extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,t)}};rt.InterceptorConfigurationError=bi;var _c=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};rt.ListenerBuilder=_c;var bc=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};rt.RequesterBuilder=bc;var Cc={onReceiveMetadata:(t,e)=>{e(t)},onReceiveMessage:(t,e)=>{e(t)},onReceiveStatus:(t,e)=>{e(t)}},_i={start:(t,e,n)=>{n(t,e)},sendMessage:(t,e)=>{e(t)},halfClose:t=>{t()},cancel:t=>{t()}},Ic=class{constructor(e,n){var r,i,s,o;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,n?this.requester={start:(r=n.start)!==null&&r!==void 0?r:_i.start,sendMessage:(i=n.sendMessage)!==null&&i!==void 0?i:_i.sendMessage,halfClose:(s=n.halfClose)!==null&&s!==void 0?s:_i.halfClose,cancel:(o=n.cancel)!==null&&o!==void 0?o:_i.cancel}:this.requester=_i}cancelWithStatus(e,n){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,n)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,n){var r,i,s,o,a,l;let c={onReceiveMetadata:(i=(r=n?.onReceiveMetadata)===null||r===void 0?void 0:r.bind(n))!==null&&i!==void 0?i:h=>{},onReceiveMessage:(o=(s=n?.onReceiveMessage)===null||s===void 0?void 0:s.bind(n))!==null&&o!==void 0?o:h=>{},onReceiveStatus:(l=(a=n?.onReceiveStatus)===null||a===void 0?void 0:a.bind(n))!==null&&l!==void 0?l:h=>{}};this.processingMetadata=!0,this.requester.start(e,c,(h,d)=>{var f,p,y;this.processingMetadata=!1;let S;if((0,og.isInterceptingListener)(d))S=d;else{let C={onReceiveMetadata:(f=d.onReceiveMetadata)!==null&&f!==void 0?f:Cc.onReceiveMetadata,onReceiveMessage:(p=d.onReceiveMessage)!==null&&p!==void 0?p:Cc.onReceiveMessage,onReceiveStatus:(y=d.onReceiveStatus)!==null&&y!==void 0?y:Cc.onReceiveStatus};S=new og.InterceptingListenerImpl(C,c)}this.nextCall.start(h,S),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,n){this.processingMessage=!0,this.requester.sendMessage(n,r=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=n):(this.nextCall.sendMessageWithContext(e,r),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};rt.InterceptingCall=Ic;function Lw(t,e,n){var r,i;let s=(r=n.deadline)!==null&&r!==void 0?r:1/0,o=n.host,a=(i=n.parent)!==null&&i!==void 0?i:null,l=n.propagate_flags,c=n.credentials,h=t.createCall(e,s,o,a,l);return c&&h.setCredentials(c),h}var ho=class{constructor(e,n){this.call=e,this.methodDefinition=n}cancelWithStatus(e,n){this.call.cancelWithStatus(e,n)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,n){let r;try{r=this.methodDefinition.requestSerialize(n)}catch(i){this.call.cancelWithStatus(ag.Status.INTERNAL,`Request message serialization failure: ${(0,lg.getErrorMessage)(i)}`);return}this.call.sendMessageWithContext(e,r)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,n){let r=null;this.call.start(e,{onReceiveMetadata:i=>{var s;(s=n?.onReceiveMetadata)===null||s===void 0||s.call(n,i)},onReceiveMessage:i=>{var s;let o;try{o=this.methodDefinition.responseDeserialize(i)}catch(a){r={code:ag.Status.INTERNAL,details:`Response message parsing error: ${(0,lg.getErrorMessage)(a)}`,metadata:new Pw.Metadata},this.call.cancelWithStatus(r.code,r.details);return}(s=n?.onReceiveMessage)===null||s===void 0||s.call(n,o)},onReceiveStatus:i=>{var s,o;r?(s=n?.onReceiveStatus)===null||s===void 0||s.call(n,r):(o=n?.onReceiveStatus)===null||o===void 0||o.call(n,i)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},Ac=class extends ho{constructor(e,n){super(e,n)}start(e,n){var r,i;let s=!1,o={onReceiveMetadata:(i=(r=n?.onReceiveMetadata)===null||r===void 0?void 0:r.bind(n))!==null&&i!==void 0?i:a=>{},onReceiveMessage:a=>{var l;s=!0,(l=n?.onReceiveMessage)===null||l===void 0||l.call(n,a)},onReceiveStatus:a=>{var l,c;s||(l=n?.onReceiveMessage)===null||l===void 0||l.call(n,null),(c=n?.onReceiveStatus)===null||c===void 0||c.call(n,a)}};super.start(e,o),this.call.startRead()}},Rc=class extends ho{};function Fw(t,e,n){let r=Lw(t,n.path,e);return n.responseStream?new Rc(r,n):new Ac(r,n)}function Bw(t,e,n,r){if(t.clientInterceptors.length>0&&t.clientInterceptorProviders.length>0)throw new bi("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(t.callInterceptors.length>0&&t.callInterceptorProviders.length>0)throw new bi("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let i=[];t.callInterceptors.length>0||t.callInterceptorProviders.length>0?i=[].concat(t.callInterceptors,t.callInterceptorProviders.map(a=>a(e))).filter(a=>a):i=[].concat(t.clientInterceptors,t.clientInterceptorProviders.map(a=>a(e))).filter(a=>a);let s=Object.assign({},n,{method_definition:e});return i.reduceRight((a,l)=>c=>l(c,a),a=>Fw(r,a,e))(s)}rt.getInterceptingCall=Bw});var Oc=g(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.Client=void 0;var At=ig(),qw=xc(),Uw=et(),hn=$(),gr=Ve(),fo=Dc(),ft=Symbol(),mr=Symbol(),yr=Symbol(),jt=Symbol();function Nc(t){return typeof t=="function"}function vr(t){return t.stack.split(`
`).slice(1).join(`
`)}var kc=class{constructor(e,n,r={}){var i,s;if(r=Object.assign({},r),this[mr]=(i=r.interceptors)!==null&&i!==void 0?i:[],delete r.interceptors,this[yr]=(s=r.interceptor_providers)!==null&&s!==void 0?s:[],delete r.interceptor_providers,this[mr].length>0&&this[yr].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[jt]=r.callInvocationTransformer,delete r.callInvocationTransformer,r.channelOverride)this[ft]=r.channelOverride;else if(r.channelFactoryOverride){let o=r.channelFactoryOverride;delete r.channelFactoryOverride,this[ft]=o(e,n,r)}else this[ft]=new qw.ChannelImplementation(e,n,r)}close(){this[ft].close()}getChannel(){return this[ft]}waitForReady(e,n){let r=i=>{if(i){n(new Error("Failed to connect before the deadline"));return}let s;try{s=this[ft].getConnectivityState(!0)}catch{n(new Error("The channel has been closed"));return}if(s===Uw.ConnectivityState.READY)n();else try{this[ft].watchConnectivityState(s,e,r)}catch{n(new Error("The channel has been closed"))}};setImmediate(r)}checkOptionalUnaryResponseArguments(e,n,r){if(Nc(e))return{metadata:new gr.Metadata,options:{},callback:e};if(Nc(n))return e instanceof gr.Metadata?{metadata:e,options:{},callback:n}:{metadata:new gr.Metadata,options:e,callback:n};if(!(e instanceof gr.Metadata&&n instanceof Object&&Nc(r)))throw new Error("Incorrect arguments passed");return{metadata:e,options:n,callback:r}}makeUnaryRequest(e,n,r,i,s,o,a){var l,c;let h=this.checkOptionalUnaryResponseArguments(s,o,a),d={path:e,requestStream:!1,responseStream:!1,requestSerialize:n,responseDeserialize:r},f={argument:i,metadata:h.metadata,call:new At.ClientUnaryCallImpl,channel:this[ft],methodDefinition:d,callOptions:h.options,callback:h.callback};this[jt]&&(f=this[jt](f));let p=f.call,y={clientInterceptors:this[mr],clientInterceptorProviders:this[yr],callInterceptors:(l=f.callOptions.interceptors)!==null&&l!==void 0?l:[],callInterceptorProviders:(c=f.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},S=(0,fo.getInterceptingCall)(y,f.methodDefinition,f.callOptions,f.channel);p.call=S;let C=null,_=!1,T=new Error;return S.start(f.metadata,{onReceiveMetadata:N=>{p.emit("metadata",N)},onReceiveMessage(N){C!==null&&S.cancelWithStatus(hn.Status.INTERNAL,"Too many responses received"),C=N},onReceiveStatus(N){if(!_){if(_=!0,N.code===hn.Status.OK)if(C===null){let A=vr(T);f.callback((0,At.callErrorFromStatus)({code:hn.Status.INTERNAL,details:"No message received",metadata:N.metadata},A))}else f.callback(null,C);else{let A=vr(T);f.callback((0,At.callErrorFromStatus)(N,A))}T=null,p.emit("status",N)}}}),S.sendMessage(i),S.halfClose(),p}makeClientStreamRequest(e,n,r,i,s,o){var a,l;let c=this.checkOptionalUnaryResponseArguments(i,s,o),h={path:e,requestStream:!0,responseStream:!1,requestSerialize:n,responseDeserialize:r},d={metadata:c.metadata,call:new At.ClientWritableStreamImpl(n),channel:this[ft],methodDefinition:h,callOptions:c.options,callback:c.callback};this[jt]&&(d=this[jt](d));let f=d.call,p={clientInterceptors:this[mr],clientInterceptorProviders:this[yr],callInterceptors:(a=d.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(l=d.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},y=(0,fo.getInterceptingCall)(p,d.methodDefinition,d.callOptions,d.channel);f.call=y;let S=null,C=!1,_=new Error;return y.start(d.metadata,{onReceiveMetadata:T=>{f.emit("metadata",T)},onReceiveMessage(T){S!==null&&y.cancelWithStatus(hn.Status.INTERNAL,"Too many responses received"),S=T},onReceiveStatus(T){if(!C){if(C=!0,T.code===hn.Status.OK)if(S===null){let N=vr(_);d.callback((0,At.callErrorFromStatus)({code:hn.Status.INTERNAL,details:"No message received",metadata:T.metadata},N))}else d.callback(null,S);else{let N=vr(_);d.callback((0,At.callErrorFromStatus)(T,N))}_=null,f.emit("status",T)}}}),f}checkMetadataAndOptions(e,n){let r,i;return e instanceof gr.Metadata?(r=e,n?i=n:i={}):(e?i=e:i={},r=new gr.Metadata),{metadata:r,options:i}}makeServerStreamRequest(e,n,r,i,s,o){var a,l;let c=this.checkMetadataAndOptions(s,o),h={path:e,requestStream:!1,responseStream:!0,requestSerialize:n,responseDeserialize:r},d={argument:i,metadata:c.metadata,call:new At.ClientReadableStreamImpl(r),channel:this[ft],methodDefinition:h,callOptions:c.options};this[jt]&&(d=this[jt](d));let f=d.call,p={clientInterceptors:this[mr],clientInterceptorProviders:this[yr],callInterceptors:(a=d.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(l=d.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},y=(0,fo.getInterceptingCall)(p,d.methodDefinition,d.callOptions,d.channel);f.call=y;let S=!1,C=new Error;return y.start(d.metadata,{onReceiveMetadata(_){f.emit("metadata",_)},onReceiveMessage(_){f.push(_)},onReceiveStatus(_){if(!S){if(S=!0,f.push(null),_.code!==hn.Status.OK){let T=vr(C);f.emit("error",(0,At.callErrorFromStatus)(_,T))}C=null,f.emit("status",_)}}}),y.sendMessage(i),y.halfClose(),f}makeBidiStreamRequest(e,n,r,i,s){var o,a;let l=this.checkMetadataAndOptions(i,s),c={path:e,requestStream:!0,responseStream:!0,requestSerialize:n,responseDeserialize:r},h={metadata:l.metadata,call:new At.ClientDuplexStreamImpl(n,r),channel:this[ft],methodDefinition:c,callOptions:l.options};this[jt]&&(h=this[jt](h));let d=h.call,f={clientInterceptors:this[mr],clientInterceptorProviders:this[yr],callInterceptors:(o=h.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(a=h.callOptions.interceptor_providers)!==null&&a!==void 0?a:[]},p=(0,fo.getInterceptingCall)(f,h.methodDefinition,h.callOptions,h.channel);d.call=p;let y=!1,S=new Error;return p.start(h.metadata,{onReceiveMetadata(C){d.emit("metadata",C)},onReceiveMessage(C){d.push(C)},onReceiveStatus(C){if(!y){if(y=!0,d.push(null),C.code!==hn.Status.OK){let _=vr(S);d.emit("error",(0,At.callErrorFromStatus)(C,_))}S=null,d.emit("status",C)}}}),d}};po.Client=kc});var Pc=g(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Sr.loadPackageDefinition=Sr.makeClientConstructor=void 0;var Ii=Oc(),Vw={unary:Ii.Client.prototype.makeUnaryRequest,server_stream:Ii.Client.prototype.makeServerStreamRequest,client_stream:Ii.Client.prototype.makeClientStreamRequest,bidi:Ii.Client.prototype.makeBidiStreamRequest};function Mc(t){return["__proto__","prototype","constructor"].includes(t)}function cg(t,e,n){n||(n={});class r extends Ii.Client{}return Object.keys(t).forEach(i=>{if(Mc(i))return;let s=t[i],o;if(typeof i=="string"&&i.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?o="bidi":o="client_stream":s.responseStream?o="server_stream":o="unary";let a=s.requestSerialize,l=s.responseDeserialize,c=zw(Vw[o],s.path,a,l);r.prototype[i]=c,Object.assign(r.prototype[i],s),s.originalName&&!Mc(s.originalName)&&(r.prototype[s.originalName]=r.prototype[i])}),r.service=t,r.serviceName=e,r}Sr.makeClientConstructor=cg;function zw(t,e,n,r){return function(...i){return t.call(this,e,n,r,...i)}}function Gw(t){return"format"in t}function jw(t){let e={};for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)){let r=t[n],i=n.split(".");if(i.some(a=>Mc(a)))continue;let s=i[i.length-1],o=e;for(let a of i.slice(0,-1))o[a]||(o[a]={}),o=o[a];Gw(r)?o[s]=r:o[s]=cg(r,s,{})}return e}Sr.loadPackageDefinition=jw});var Mg=g((BN,xg)=>{"use strict";var $w=1/0,Ww="[object Symbol]",Kw=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Hw=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,mo="\\ud800-\\udfff",yg="\\u0300-\\u036f\\ufe20-\\ufe23",vg="\\u20d0-\\u20f0",Sg="\\u2700-\\u27bf",Tg="a-z\\xdf-\\xf6\\xf8-\\xff",Qw="\\xac\\xb1\\xd7\\xf7",Yw="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Xw="\\u2000-\\u206f",Jw=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Eg="A-Z\\xc0-\\xd6\\xd8-\\xde",wg="\\ufe0e\\ufe0f",Cg=Qw+Yw+Xw+Jw,Fc="['\u2019]",Zw="["+mo+"]",ug="["+Cg+"]",go="["+yg+vg+"]",_g="\\d+",e0="["+Sg+"]",bg="["+Tg+"]",Ig="[^"+mo+Cg+_g+Sg+Tg+Eg+"]",Lc="\\ud83c[\\udffb-\\udfff]",t0="(?:"+go+"|"+Lc+")",Ag="[^"+mo+"]",Bc="(?:\\ud83c[\\udde6-\\uddff]){2}",qc="[\\ud800-\\udbff][\\udc00-\\udfff]",Tr="["+Eg+"]",Rg="\\u200d",hg="(?:"+bg+"|"+Ig+")",n0="(?:"+Tr+"|"+Ig+")",dg="(?:"+Fc+"(?:d|ll|m|re|s|t|ve))?",fg="(?:"+Fc+"(?:D|LL|M|RE|S|T|VE))?",Dg=t0+"?",Ng="["+wg+"]?",r0="(?:"+Rg+"(?:"+[Ag,Bc,qc].join("|")+")"+Ng+Dg+")*",kg=Ng+Dg+r0,i0="(?:"+[e0,Bc,qc].join("|")+")"+kg,s0="(?:"+[Ag+go+"?",go,Bc,qc,Zw].join("|")+")",o0=RegExp(Fc,"g"),a0=RegExp(go,"g"),l0=RegExp(Lc+"(?="+Lc+")|"+s0+kg,"g"),c0=RegExp([Tr+"?"+bg+"+"+dg+"(?="+[ug,Tr,"$"].join("|")+")",n0+"+"+fg+"(?="+[ug,Tr+hg,"$"].join("|")+")",Tr+"?"+hg+"+"+dg,Tr+"+"+fg,_g,i0].join("|"),"g"),u0=RegExp("["+Rg+mo+yg+vg+wg+"]"),h0=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,d0={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},f0=typeof global=="object"&&global&&global.Object===Object&&global,p0=typeof self=="object"&&self&&self.Object===Object&&self,g0=f0||p0||Function("return this")();function m0(t,e,n,r){var i=-1,s=t?t.length:0;for(r&&s&&(n=t[++i]);++i<s;)n=e(n,t[i],i,t);return n}function y0(t){return t.split("")}function v0(t){return t.match(Kw)||[]}function S0(t){return function(e){return t?.[e]}}var T0=S0(d0);function Og(t){return u0.test(t)}function E0(t){return h0.test(t)}function w0(t){return Og(t)?C0(t):y0(t)}function C0(t){return t.match(l0)||[]}function _0(t){return t.match(c0)||[]}var b0=Object.prototype,I0=b0.toString,pg=g0.Symbol,gg=pg?pg.prototype:void 0,mg=gg?gg.toString:void 0;function A0(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=t[r+e];return s}function R0(t){if(typeof t=="string")return t;if(x0(t))return mg?mg.call(t):"";var e=t+"";return e=="0"&&1/t==-$w?"-0":e}function D0(t,e,n){var r=t.length;return n=n===void 0?r:n,!e&&n>=r?t:A0(t,e,n)}function N0(t){return function(e){e=yo(e);var n=Og(e)?w0(e):void 0,r=n?n[0]:e.charAt(0),i=n?D0(n,1).join(""):e.slice(1);return r[t]()+i}}function k0(t){return function(e){return m0(B0(L0(e).replace(o0,"")),t,"")}}function O0(t){return!!t&&typeof t=="object"}function x0(t){return typeof t=="symbol"||O0(t)&&I0.call(t)==Ww}function yo(t){return t==null?"":R0(t)}var M0=k0(function(t,e,n){return e=e.toLowerCase(),t+(n?P0(e):e)});function P0(t){return F0(yo(t).toLowerCase())}function L0(t){return t=yo(t),t&&t.replace(Hw,T0).replace(a0,"")}var F0=N0("toUpperCase");function B0(t,e,n){return t=yo(t),e=n?void 0:e,e===void 0?E0(t)?_0(t):v0(t):t.match(e)||[]}xg.exports=M0});var Uc=g((qN,Pg)=>{"use strict";Pg.exports=q0;function q0(t,e){for(var n=new Array(arguments.length-1),r=0,i=2,s=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise(function(a,l){n[r]=function(h){if(s)if(s=!1,h)l(h);else{for(var d=new Array(arguments.length-1),f=0;f<d.length;)d[f++]=arguments[f];a.apply(null,d)}};try{t.apply(e||null,n)}catch(c){s&&(s=!1,l(c))}})}});var qg=g(Bg=>{"use strict";var vo=Bg;vo.length=function(e){var n=e.length;if(!n)return 0;for(var r=0;--n%4>1&&e.charAt(n)==="=";)++r;return Math.ceil(e.length*3)/4-r};var Er=new Array(64),Fg=new Array(123);for(pt=0;pt<64;)Fg[Er[pt]=pt<26?pt+65:pt<52?pt+71:pt<62?pt-4:pt-59|43]=pt++;var pt;vo.encode=function(e,n,r){for(var i=null,s=[],o=0,a=0,l;n<r;){var c=e[n++];switch(a){case 0:s[o++]=Er[c>>2],l=(c&3)<<4,a=1;break;case 1:s[o++]=Er[l|c>>4],l=(c&15)<<2,a=2;break;case 2:s[o++]=Er[l|c>>6],s[o++]=Er[c&63],a=0;break}o>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=Er[l],s[o++]=61,a===1&&(s[o++]=61)),i?(o&&i.push(String.fromCharCode.apply(String,s.slice(0,o))),i.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Lg="invalid encoding";vo.decode=function(e,n,r){for(var i=r,s=0,o,a=0;a<e.length;){var l=e.charCodeAt(a++);if(l===61&&s>1)break;if((l=Fg[l])===void 0)throw Error(Lg);switch(s){case 0:o=l,s=1;break;case 1:n[r++]=o<<2|(l&48)>>4,o=l,s=2;break;case 2:n[r++]=(o&15)<<4|(l&60)>>2,o=l,s=3;break;case 3:n[r++]=(o&3)<<6|l,s=0;break}}if(s===1)throw Error(Lg);return r-i};vo.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Vg=g((VN,Ug)=>{"use strict";Ug.exports=So;function So(){this._listeners={}}So.prototype.on=function(e,n,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:n,ctx:r||this}),this};So.prototype.off=function(e,n){if(e===void 0)this._listeners={};else if(n===void 0)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===n?r.splice(i,1):++i;return this};So.prototype.emit=function(e){var n=this._listeners[e];if(n){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<n.length;)n[i].fn.apply(n[i++].ctx,r)}return this}});var Hg=g((zN,Kg)=>{"use strict";Kg.exports=zg(zg);function zg(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),n=new Uint8Array(e.buffer),r=n[3]===128;function i(l,c,h){e[0]=l,c[h]=n[0],c[h+1]=n[1],c[h+2]=n[2],c[h+3]=n[3]}function s(l,c,h){e[0]=l,c[h]=n[3],c[h+1]=n[2],c[h+2]=n[1],c[h+3]=n[0]}t.writeFloatLE=r?i:s,t.writeFloatBE=r?s:i;function o(l,c){return n[0]=l[c],n[1]=l[c+1],n[2]=l[c+2],n[3]=l[c+3],e[0]}function a(l,c){return n[3]=l[c],n[2]=l[c+1],n[1]=l[c+2],n[0]=l[c+3],e[0]}t.readFloatLE=r?o:a,t.readFloatBE=r?a:o}():function(){function e(r,i,s,o){var a=i<0?1:0;if(a&&(i=-i),i===0)r(1/i>0?0:2147483648,s,o);else if(isNaN(i))r(2143289344,s,o);else if(i>34028234663852886e22)r((a<<31|2139095040)>>>0,s,o);else if(i<11754943508222875e-54)r((a<<31|Math.round(i/1401298464324817e-60))>>>0,s,o);else{var l=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-l)*8388608)&8388607;r((a<<31|l+127<<23|c)>>>0,s,o)}}t.writeFloatLE=e.bind(null,Gg),t.writeFloatBE=e.bind(null,jg);function n(r,i,s){var o=r(i,s),a=(o>>31)*2+1,l=o>>>23&255,c=o&8388607;return l===255?c?NaN:a*(1/0):l===0?a*1401298464324817e-60*c:a*Math.pow(2,l-150)*(c+8388608)}t.readFloatLE=n.bind(null,$g),t.readFloatBE=n.bind(null,Wg)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),n=new Uint8Array(e.buffer),r=n[7]===128;function i(l,c,h){e[0]=l,c[h]=n[0],c[h+1]=n[1],c[h+2]=n[2],c[h+3]=n[3],c[h+4]=n[4],c[h+5]=n[5],c[h+6]=n[6],c[h+7]=n[7]}function s(l,c,h){e[0]=l,c[h]=n[7],c[h+1]=n[6],c[h+2]=n[5],c[h+3]=n[4],c[h+4]=n[3],c[h+5]=n[2],c[h+6]=n[1],c[h+7]=n[0]}t.writeDoubleLE=r?i:s,t.writeDoubleBE=r?s:i;function o(l,c){return n[0]=l[c],n[1]=l[c+1],n[2]=l[c+2],n[3]=l[c+3],n[4]=l[c+4],n[5]=l[c+5],n[6]=l[c+6],n[7]=l[c+7],e[0]}function a(l,c){return n[7]=l[c],n[6]=l[c+1],n[5]=l[c+2],n[4]=l[c+3],n[3]=l[c+4],n[2]=l[c+5],n[1]=l[c+6],n[0]=l[c+7],e[0]}t.readDoubleLE=r?o:a,t.readDoubleBE=r?a:o}():function(){function e(r,i,s,o,a,l){var c=o<0?1:0;if(c&&(o=-o),o===0)r(0,a,l+i),r(1/o>0?0:2147483648,a,l+s);else if(isNaN(o))r(0,a,l+i),r(2146959360,a,l+s);else if(o>17976931348623157e292)r(0,a,l+i),r((c<<31|2146435072)>>>0,a,l+s);else{var h;if(o<22250738585072014e-324)h=o/5e-324,r(h>>>0,a,l+i),r((c<<31|h/4294967296)>>>0,a,l+s);else{var d=Math.floor(Math.log(o)/Math.LN2);d===1024&&(d=1023),h=o*Math.pow(2,-d),r(h*4503599627370496>>>0,a,l+i),r((c<<31|d+1023<<20|h*1048576&1048575)>>>0,a,l+s)}}}t.writeDoubleLE=e.bind(null,Gg,0,4),t.writeDoubleBE=e.bind(null,jg,4,0);function n(r,i,s,o,a){var l=r(o,a+i),c=r(o,a+s),h=(c>>31)*2+1,d=c>>>20&2047,f=4294967296*(c&1048575)+l;return d===2047?f?NaN:h*(1/0):d===0?h*5e-324*f:h*Math.pow(2,d-1075)*(f+4503599627370496)}t.readDoubleLE=n.bind(null,$g,0,4),t.readDoubleBE=n.bind(null,Wg,4,0)}(),t}function Gg(t,e,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}function jg(t,e,n){e[n]=t>>>24,e[n+1]=t>>>16&255,e[n+2]=t>>>8&255,e[n+3]=t&255}function $g(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Wg(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Vc=g((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Yg=g(Qg=>{"use strict";var zc=Qg;zc.length=function(e){for(var n=0,r=0,i=0;i<e.length;++i)r=e.charCodeAt(i),r<128?n+=1:r<2048?n+=2:(r&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,n+=4):n+=3;return n};zc.read=function(e,n,r){var i=r-n;if(i<1)return"";for(var s=null,o=[],a=0,l;n<r;)l=e[n++],l<128?o[a++]=l:l>191&&l<224?o[a++]=(l&31)<<6|e[n++]&63:l>239&&l<365?(l=((l&7)<<18|(e[n++]&63)<<12|(e[n++]&63)<<6|e[n++]&63)-65536,o[a++]=55296+(l>>10),o[a++]=56320+(l&1023)):o[a++]=(l&15)<<12|(e[n++]&63)<<6|e[n++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};zc.write=function(e,n,r){for(var i=r,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?n[r++]=s:s<2048?(n[r++]=s>>6|192,n[r++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,n[r++]=s>>18|240,n[r++]=s>>12&63|128,n[r++]=s>>6&63|128,n[r++]=s&63|128):(n[r++]=s>>12|224,n[r++]=s>>6&63|128,n[r++]=s&63|128);return r-i}});var Jg=g((jN,Xg)=>{"use strict";Xg.exports=U0;function U0(t,e,n){var r=n||8192,i=r>>>1,s=null,o=r;return function(l){if(l<1||l>i)return t(l);o+l>r&&(s=t(r),o=0);var c=e.call(s,o,o+=l);return o&7&&(o=(o|7)+1),c}}});var em=g(($N,Zg)=>{"use strict";Zg.exports=Se;var Ai=Rt();function Se(t,e){this.lo=t>>>0,this.hi=e>>>0}var qn=Se.zero=new Se(0,0);qn.toNumber=function(){return 0};qn.zzEncode=qn.zzDecode=function(){return this};qn.length=function(){return 1};var V0=Se.zeroHash="\0\0\0\0\0\0\0\0";Se.fromNumber=function(e){if(e===0)return qn;var n=e<0;n&&(e=-e);var r=e>>>0,i=(e-r)/4294967296>>>0;return n&&(i=~i>>>0,r=~r>>>0,++r>4294967295&&(r=0,++i>4294967295&&(i=0))),new Se(r,i)};Se.from=function(e){if(typeof e=="number")return Se.fromNumber(e);if(Ai.isString(e))if(Ai.Long)e=Ai.Long.fromString(e);else return Se.fromNumber(parseInt(e,10));return e.low||e.high?new Se(e.low>>>0,e.high>>>0):qn};Se.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var n=~this.lo+1>>>0,r=~this.hi>>>0;return n||(r=r+1>>>0),-(n+r*4294967296)}return this.lo+this.hi*4294967296};Se.prototype.toLong=function(e){return Ai.Long?new Ai.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var dn=String.prototype.charCodeAt;Se.fromHash=function(e){return e===V0?qn:new Se((dn.call(e,0)|dn.call(e,1)<<8|dn.call(e,2)<<16|dn.call(e,3)<<24)>>>0,(dn.call(e,4)|dn.call(e,5)<<8|dn.call(e,6)<<16|dn.call(e,7)<<24)>>>0)};Se.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};Se.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};Se.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};Se.prototype.length=function(){var e=this.lo,n=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return r===0?n===0?e<16384?e<128?1:2:e<2097152?3:4:n<16384?n<128?5:6:n<2097152?7:8:r<128?9:10}});var Rt=g(Gc=>{"use strict";var k=Gc;k.asPromise=Uc();k.base64=qg();k.EventEmitter=Vg();k.float=Hg();k.inquire=Vc();k.utf8=Yg();k.pool=Jg();k.LongBits=em();k.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);k.global=k.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||Gc;k.emptyArray=Object.freeze?Object.freeze([]):[];k.emptyObject=Object.freeze?Object.freeze({}):{};k.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};k.isString=function(e){return typeof e=="string"||e instanceof String};k.isObject=function(e){return e&&typeof e=="object"};k.isset=k.isSet=function(e,n){var r=e[n];return r!=null&&e.hasOwnProperty(n)?typeof r!="object"||(Array.isArray(r)?r.length:Object.keys(r).length)>0:!1};k.Buffer=function(){try{var t=k.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();k._Buffer_from=null;k._Buffer_allocUnsafe=null;k.newBuffer=function(e){return typeof e=="number"?k.Buffer?k._Buffer_allocUnsafe(e):new k.Array(e):k.Buffer?k._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};k.Array=typeof Uint8Array<"u"?Uint8Array:Array;k.Long=k.global.dcodeIO&&k.global.dcodeIO.Long||k.global.Long||k.inquire("long");k.key2Re=/^true|false|0|1$/;k.key32Re=/^-?(?:0|[1-9][0-9]*)$/;k.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;k.longToHash=function(e){return e?k.LongBits.from(e).toHash():k.LongBits.zeroHash};k.longFromHash=function(e,n){var r=k.LongBits.fromHash(e);return k.Long?k.Long.fromBits(r.lo,r.hi,n):r.toNumber(!!n)};function tm(t,e,n){for(var r=Object.keys(e),i=0;i<r.length;++i)(t[r[i]]===void 0||!n)&&(t[r[i]]=e[r[i]]);return t}k.merge=tm;k.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function nm(t){function e(n,r){if(!(this instanceof e))return new e(n,r);Object.defineProperty(this,"message",{get:function(){return n}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),r&&tm(this,r)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}k.newError=nm;k.ProtocolError=nm("ProtocolError");k.oneOfGetter=function(e){for(var n={},r=0;r<e.length;++r)n[e[r]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(n[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};k.oneOfSetter=function(e){return function(n){for(var r=0;r<e.length;++r)e[r]!==n&&delete this[e[r]]}};k.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};k._configure=function(){var t=k.Buffer;if(!t){k._Buffer_from=k._Buffer_allocUnsafe=null;return}k._Buffer_from=t.from!==Uint8Array.from&&t.from||function(n,r){return new t(n,r)},k._Buffer_allocUnsafe=t.allocUnsafe||function(n){return new t(n)}}});var Eo=g((KN,om)=>{"use strict";om.exports=j;var it=Rt(),jc,To=it.LongBits,rm=it.base64,im=it.utf8;function Ri(t,e,n){this.fn=t,this.len=e,this.next=void 0,this.val=n}function Wc(){}function z0(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function j(){this.len=0,this.head=new Ri(Wc,0,0),this.tail=this.head,this.states=null}var sm=function(){return it.Buffer?function(){return(j.create=function(){return new jc})()}:function(){return new j}};j.create=sm();j.alloc=function(e){return new it.Array(e)};it.Array!==Array&&(j.alloc=it.pool(j.alloc,it.Array.prototype.subarray));j.prototype._push=function(e,n,r){return this.tail=this.tail.next=new Ri(e,n,r),this.len+=n,this};function Kc(t,e,n){e[n]=t&255}function G0(t,e,n){for(;t>127;)e[n++]=t&127|128,t>>>=7;e[n]=t}function Hc(t,e){this.len=t,this.next=void 0,this.val=e}Hc.prototype=Object.create(Ri.prototype);Hc.prototype.fn=G0;j.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Hc((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};j.prototype.int32=function(e){return e<0?this._push(Qc,10,To.fromNumber(e)):this.uint32(e)};j.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Qc(t,e,n){for(;t.hi;)e[n++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[n++]=t.lo&127|128,t.lo=t.lo>>>7;e[n++]=t.lo}j.prototype.uint64=function(e){var n=To.from(e);return this._push(Qc,n.length(),n)};j.prototype.int64=j.prototype.uint64;j.prototype.sint64=function(e){var n=To.from(e).zzEncode();return this._push(Qc,n.length(),n)};j.prototype.bool=function(e){return this._push(Kc,1,e?1:0)};function $c(t,e,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24}j.prototype.fixed32=function(e){return this._push($c,4,e>>>0)};j.prototype.sfixed32=j.prototype.fixed32;j.prototype.fixed64=function(e){var n=To.from(e);return this._push($c,4,n.lo)._push($c,4,n.hi)};j.prototype.sfixed64=j.prototype.fixed64;j.prototype.float=function(e){return this._push(it.float.writeFloatLE,4,e)};j.prototype.double=function(e){return this._push(it.float.writeDoubleLE,8,e)};var j0=it.Array.prototype.set?function(e,n,r){n.set(e,r)}:function(e,n,r){for(var i=0;i<e.length;++i)n[r+i]=e[i]};j.prototype.bytes=function(e){var n=e.length>>>0;if(!n)return this._push(Kc,1,0);if(it.isString(e)){var r=j.alloc(n=rm.length(e));rm.decode(e,r,0),e=r}return this.uint32(n)._push(j0,n,e)};j.prototype.string=function(e){var n=im.length(e);return n?this.uint32(n)._push(im.write,n,e):this._push(Kc,1,0)};j.prototype.fork=function(){return this.states=new z0(this),this.head=this.tail=new Ri(Wc,0,0),this.len=0,this};j.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Ri(Wc,0,0),this.len=0),this};j.prototype.ldelim=function(){var e=this.head,n=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=n,this.len+=r),this};j.prototype.finish=function(){for(var e=this.head.next,n=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,n,r),r+=e.len,e=e.next;return n};j._configure=function(t){jc=t,j.create=sm(),jc._configure()}});var cm=g((HN,lm)=>{"use strict";lm.exports=Dt;var am=Eo();(Dt.prototype=Object.create(am.prototype)).constructor=Dt;var fn=Rt();function Dt(){am.call(this)}Dt._configure=function(){Dt.alloc=fn._Buffer_allocUnsafe,Dt.writeBytesBuffer=fn.Buffer&&fn.Buffer.prototype instanceof Uint8Array&&fn.Buffer.prototype.set.name==="set"?function(e,n,r){n.set(e,r)}:function(e,n,r){if(e.copy)e.copy(n,r,0,e.length);else for(var i=0;i<e.length;)n[r++]=e[i++]}};Dt.prototype.bytes=function(e){fn.isString(e)&&(e=fn._Buffer_from(e,"base64"));var n=e.length>>>0;return this.uint32(n),n&&this._push(Dt.writeBytesBuffer,n,e),this};function $0(t,e,n){t.length<40?fn.utf8.write(t,e,n):e.utf8Write?e.utf8Write(t,n):e.write(t,n)}Dt.prototype.string=function(e){var n=fn.Buffer.byteLength(e);return this.uint32(n),n&&this._push($0,n,e),this};Dt._configure()});var Co=g((QN,pm)=>{"use strict";pm.exports=ue;var gt=Rt(),Xc,dm=gt.LongBits,W0=gt.utf8;function mt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function ue(t){this.buf=t,this.pos=0,this.len=t.length}var um=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new ue(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new ue(e);throw Error("illegal buffer")},fm=function(){return gt.Buffer?function(n){return(ue.create=function(i){return gt.Buffer.isBuffer(i)?new Xc(i):um(i)})(n)}:um};ue.create=fm();ue.prototype._slice=gt.Array.prototype.subarray||gt.Array.prototype.slice;ue.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,mt(this,10);return e}}();ue.prototype.int32=function(){return this.uint32()|0};ue.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Yc(){var t=new dm(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw mt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw mt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}ue.prototype.bool=function(){return this.uint32()!==0};function wo(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}ue.prototype.fixed32=function(){if(this.pos+4>this.len)throw mt(this,4);return wo(this.buf,this.pos+=4)};ue.prototype.sfixed32=function(){if(this.pos+4>this.len)throw mt(this,4);return wo(this.buf,this.pos+=4)|0};function hm(){if(this.pos+8>this.len)throw mt(this,8);return new dm(wo(this.buf,this.pos+=4),wo(this.buf,this.pos+=4))}ue.prototype.float=function(){if(this.pos+4>this.len)throw mt(this,4);var e=gt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};ue.prototype.double=function(){if(this.pos+8>this.len)throw mt(this,4);var e=gt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};ue.prototype.bytes=function(){var e=this.uint32(),n=this.pos,r=this.pos+e;if(r>this.len)throw mt(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(n,r);if(n===r){var i=gt.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,n,r)};ue.prototype.string=function(){var e=this.bytes();return W0.read(e,0,e.length)};ue.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw mt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw mt(this);while(this.buf[this.pos++]&128);return this};ue.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};ue._configure=function(t){Xc=t,ue.create=fm(),Xc._configure();var e=gt.Long?"toLong":"toNumber";gt.merge(ue.prototype,{int64:function(){return Yc.call(this)[e](!1)},uint64:function(){return Yc.call(this)[e](!0)},sint64:function(){return Yc.call(this).zzDecode()[e](!1)},fixed64:function(){return hm.call(this)[e](!0)},sfixed64:function(){return hm.call(this)[e](!1)}})}});var vm=g((YN,ym)=>{"use strict";ym.exports=Un;var mm=Co();(Un.prototype=Object.create(mm.prototype)).constructor=Un;var gm=Rt();function Un(t){mm.call(this,t)}Un._configure=function(){gm.Buffer&&(Un.prototype._slice=gm.Buffer.prototype.slice)};Un.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Un._configure()});var Tm=g((XN,Sm)=>{"use strict";Sm.exports=Di;var Jc=Rt();(Di.prototype=Object.create(Jc.EventEmitter.prototype)).constructor=Di;function Di(t,e,n){if(typeof t!="function")throw TypeError("rpcImpl must be a function");Jc.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!e,this.responseDelimited=!!n}Di.prototype.rpcCall=function t(e,n,r,i,s){if(!i)throw TypeError("request must be specified");var o=this;if(!s)return Jc.asPromise(t,o,e,n,r,i);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,n[o.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(l,c){if(l)return o.emit("error",l,e),s(l);if(c===null){o.end(!0);return}if(!(c instanceof r))try{c=r[o.responseDelimited?"decodeDelimited":"decode"](c)}catch(h){return o.emit("error",h,e),s(h)}return o.emit("data",c,e),s(null,c)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};Di.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var Zc=g(Em=>{"use strict";var K0=Em;K0.Service=Tm()});var eu=g((ZN,wm)=>{"use strict";wm.exports={}});var bm=g(_m=>{"use strict";var je=_m;je.build="minimal";je.Writer=Eo();je.BufferWriter=cm();je.Reader=Co();je.BufferReader=vm();je.util=Rt();je.rpc=Zc();je.roots=eu();je.configure=Cm;function Cm(){je.util._configure(),je.Writer._configure(je.BufferWriter),je.Reader._configure(je.BufferReader)}Cm()});var Am=g((tk,Im)=>{"use strict";Im.exports=tu;function tu(t,e){typeof t=="string"&&(e=t,t=void 0);var n=[];function r(s){if(typeof s!="string"){var o=i();if(tu.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),l=new Array(a.length+1),c=new Array(a.length),h=0;h<a.length;)l[h]=a[h],c[h]=s[a[h++]];return l[h]=o,Function.apply(null,l).apply(null,c)}return Function(o)()}for(var d=new Array(arguments.length-1),f=0;f<d.length;)d[f]=arguments[++f];if(f=0,s=s.replace(/%([%dfijs])/g,function(y,S){var C=d[f++];switch(S){case"d":case"f":return String(Number(C));case"i":return String(Math.floor(C));case"j":return JSON.stringify(C);case"s":return String(C)}return"%"}),f!==d.length)throw Error("parameter count mismatch");return n.push(s),r}function i(s){return"function "+(s||e||"")+"("+(t&&t.join(",")||"")+`){
  `+n.join(`
  `)+`
}`}return r.toString=i,r}tu.verbose=!1});var Dm=g((nk,Rm)=>{"use strict";Rm.exports=Ni;var H0=Uc(),Q0=Vc(),nu=Q0("fs");function Ni(t,e,n){return typeof e=="function"?(n=e,e={}):e||(e={}),n?!e.xhr&&nu&&nu.readFile?nu.readFile(t,function(i,s){return i&&typeof XMLHttpRequest<"u"?Ni.xhr(t,e,n):i?n(i):n(null,e.binary?s:s.toString("utf8"))}):Ni.xhr(t,e,n):H0(Ni,this,t,e)}Ni.xhr=function(e,n,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===4){if(i.status!==0&&i.status!==200)return r(Error("status "+i.status));if(n.binary){var o=i.response;if(!o){o=[];for(var a=0;a<i.responseText.length;++a)o.push(i.responseText.charCodeAt(a)&255)}return r(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return r(null,i.responseText)}},n.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}});var Om=g(km=>{"use strict";var iu=km,Nm=iu.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},ru=iu.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var n=e.split("/"),r=Nm(e),i="";r&&(i=n.shift()+"/");for(var s=0;s<n.length;)n[s]===".."?s>0&&n[s-1]!==".."?n.splice(--s,2):r?n.splice(s,1):++s:n[s]==="."?n.splice(s,1):++s;return i+n.join("/")};iu.resolve=function(e,n,r){return r||(n=ru(n)),Nm(n)?n:(r||(e=ru(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?ru(e+"/"+n):n)}});var Vn=g(xm=>{"use strict";var ki=xm,Y0=Te(),X0=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function Oi(t,e){var n=0,r={};for(e|=0;n<t.length;)r[X0[n+e]]=t[n++];return r}ki.basic=Oi([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);ki.defaults=Oi([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",Y0.emptyArray,null]);ki.long=Oi([0,0,0,1,1],7);ki.mapKey=Oi([0,0,0,5,5,0,0,0,1,1,0,2],2);ki.packed=Oi([1,5,0,0,0,5,5,0,0,0,1,1,0])});var pn=g((sk,Lm)=>{"use strict";Lm.exports=st;var _o=zn();((st.prototype=Object.create(_o.prototype)).constructor=st).className="Field";var Mm=yt(),Pm=Vn(),pe=Te(),su,J0=/^required|optional|repeated$/;st.fromJSON=function(e,n){return new st(e,n.id,n.type,n.rule,n.extend,n.options,n.comment)};function st(t,e,n,r,i,s,o){if(pe.isObject(r)?(o=i,s=r,r=i=void 0):pe.isObject(i)&&(o=s,s=i,i=void 0),_o.call(this,t,s),!pe.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!pe.isString(n))throw TypeError("type must be a string");if(r!==void 0&&!J0.test(r=r.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(i!==void 0&&!pe.isString(i))throw TypeError("extend must be a string");r==="proto3_optional"&&(r="optional"),this.rule=r&&r!=="optional"?r:void 0,this.type=n,this.id=e,this.extend=i||void 0,this.required=r==="required",this.optional=!this.required,this.repeated=r==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=pe.Long?Pm.long[n]!==void 0:!1,this.bytes=n==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(st.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});st.prototype.setOption=function(e,n,r){return e==="packed"&&(this._packed=null),_o.prototype.setOption.call(this,e,n,r)};st.prototype.toJSON=function(e){var n=e?!!e.keepComments:!1;return pe.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",n?this.comment:void 0])};st.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=Pm.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof su?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof Mm&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof Mm))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=pe.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;pe.base64.test(this.typeDefault)?pe.base64.decode(this.typeDefault,e=pe.newBuffer(pe.base64.length(this.typeDefault)),0):pe.utf8.write(this.typeDefault,e=pe.newBuffer(pe.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=pe.emptyObject:this.repeated?this.defaultValue=pe.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof su&&(this.parent.ctor.prototype[this.name]=this.defaultValue),_o.prototype.resolve.call(this)};st.d=function(e,n,r,i){return typeof n=="function"?n=pe.decorateType(n).name:n&&typeof n=="object"&&(n=pe.decorateEnum(n).name),function(o,a){pe.decorateType(o.constructor).add(new st(a,e,n,r,{default:i}))}};st._configure=function(e){su=e}});var wr=g((ok,qm)=>{"use strict";qm.exports=ot;var Io=zn();((ot.prototype=Object.create(Io.prototype)).constructor=ot).className="OneOf";var Fm=pn(),bo=Te();function ot(t,e,n,r){if(Array.isArray(e)||(n=e,e=void 0),Io.call(this,t,n),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=r}ot.fromJSON=function(e,n){return new ot(e,n.oneof,n.options,n.comment)};ot.prototype.toJSON=function(e){var n=e?!!e.keepComments:!1;return bo.toObject(["options",this.options,"oneof",this.oneof,"comment",n?this.comment:void 0])};function Bm(t){if(t.parent)for(var e=0;e<t.fieldsArray.length;++e)t.fieldsArray[e].parent||t.parent.add(t.fieldsArray[e])}ot.prototype.add=function(e){if(!(e instanceof Fm))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,Bm(this),this};ot.prototype.remove=function(e){if(!(e instanceof Fm))throw TypeError("field must be a Field");var n=this.fieldsArray.indexOf(e);if(n<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(n,1),n=this.oneof.indexOf(e.name),n>-1&&this.oneof.splice(n,1),e.partOf=null,this};ot.prototype.onAdd=function(e){Io.prototype.onAdd.call(this,e);for(var n=this,r=0;r<this.oneof.length;++r){var i=e.get(this.oneof[r]);i&&!i.partOf&&(i.partOf=n,n.fieldsArray.push(i))}Bm(this)};ot.prototype.onRemove=function(e){for(var n=0,r;n<this.fieldsArray.length;++n)(r=this.fieldsArray[n]).parent&&r.parent.remove(r);Io.prototype.onRemove.call(this,e)};ot.d=function(){for(var e=new Array(arguments.length),n=0;n<arguments.length;)e[n]=arguments[n++];return function(i,s){bo.decorateType(i.constructor).add(new ot(s,e)),Object.defineProperty(i,s,{get:bo.oneOfGetter(e),set:bo.oneOfSetter(e)})}}});var br=g((ak,Gm)=>{"use strict";Gm.exports=W;var ou=zn();((W.prototype=Object.create(ou.prototype)).constructor=W).className="Namespace";var Um=pn(),Ao=Te(),Z0=wr(),Cr,xi,_r;W.fromJSON=function(e,n){return new W(e,n.options).addJSON(n.nested)};function Vm(t,e){if(t&&t.length){for(var n={},r=0;r<t.length;++r)n[t[r].name]=t[r].toJSON(e);return n}}W.arrayToJSON=Vm;W.isReservedId=function(e,n){if(e){for(var r=0;r<e.length;++r)if(typeof e[r]!="string"&&e[r][0]<=n&&e[r][1]>n)return!0}return!1};W.isReservedName=function(e,n){if(e){for(var r=0;r<e.length;++r)if(e[r]===n)return!0}return!1};function W(t,e){ou.call(this,t,e),this.nested=void 0,this._nestedArray=null}function zm(t){return t._nestedArray=null,t}Object.defineProperty(W.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=Ao.toArray(this.nested))}});W.prototype.toJSON=function(e){return Ao.toObject(["options",this.options,"nested",Vm(this.nestedArray,e)])};W.prototype.addJSON=function(e){var n=this;if(e)for(var r=Object.keys(e),i=0,s;i<r.length;++i)s=e[r[i]],n.add((s.fields!==void 0?Cr.fromJSON:s.values!==void 0?_r.fromJSON:s.methods!==void 0?xi.fromJSON:s.id!==void 0?Um.fromJSON:W.fromJSON)(r[i],s));return this};W.prototype.get=function(e){return this.nested&&this.nested[e]||null};W.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof _r)return this.nested[e].values;throw Error("no such enum: "+e)};W.prototype.add=function(e){if(!(e instanceof Um&&e.extend!==void 0||e instanceof Cr||e instanceof Z0||e instanceof _r||e instanceof xi||e instanceof W))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var n=this.get(e.name);if(n)if(n instanceof W&&e instanceof W&&!(n instanceof Cr||n instanceof xi)){for(var r=n.nestedArray,i=0;i<r.length;++i)e.add(r[i]);this.remove(n),this.nested||(this.nested={}),e.setOptions(n.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),zm(this)};W.prototype.remove=function(e){if(!(e instanceof ou))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),zm(this)};W.prototype.define=function(e,n){if(Ao.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var r=this;e.length>0;){var i=e.shift();if(r.nested&&r.nested[i]){if(r=r.nested[i],!(r instanceof W))throw Error("path conflicts with non-namespace objects")}else r.add(r=new W(i))}return n&&r.addJSON(n),r};W.prototype.resolveAll=function(){for(var e=this.nestedArray,n=0;n<e.length;)e[n]instanceof W?e[n++].resolveAll():e[n++].resolve();return this.resolve()};W.prototype.lookup=function(e,n,r){if(typeof n=="boolean"?(r=n,n=void 0):n&&!Array.isArray(n)&&(n=[n]),Ao.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),n);var i=this.get(e[0]);if(i){if(e.length===1){if(!n||n.indexOf(i.constructor)>-1)return i}else if(i instanceof W&&(i=i.lookup(e.slice(1),n,!0)))return i}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof W&&(i=this._nestedArray[s].lookup(e,n,!0)))return i;return this.parent===null||r?null:this.parent.lookup(e,n)};W.prototype.lookupType=function(e){var n=this.lookup(e,[Cr]);if(!n)throw Error("no such type: "+e);return n};W.prototype.lookupEnum=function(e){var n=this.lookup(e,[_r]);if(!n)throw Error("no such Enum '"+e+"' in "+this);return n};W.prototype.lookupTypeOrEnum=function(e){var n=this.lookup(e,[Cr,_r]);if(!n)throw Error("no such Type or Enum '"+e+"' in "+this);return n};W.prototype.lookupService=function(e){var n=this.lookup(e,[xi]);if(!n)throw Error("no such Service '"+e+"' in "+this);return n};W._configure=function(t,e,n){Cr=t,xi=e,_r=n}});var Ro=g((lk,jm)=>{"use strict";jm.exports=$t;var au=pn();(($t.prototype=Object.create(au.prototype)).constructor=$t).className="MapField";var eC=Vn(),Mi=Te();function $t(t,e,n,r,i,s){if(au.call(this,t,e,r,void 0,void 0,i,s),!Mi.isString(n))throw TypeError("keyType must be a string");this.keyType=n,this.resolvedKeyType=null,this.map=!0}$t.fromJSON=function(e,n){return new $t(e,n.id,n.keyType,n.type,n.options,n.comment)};$t.prototype.toJSON=function(e){var n=e?!!e.keepComments:!1;return Mi.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",n?this.comment:void 0])};$t.prototype.resolve=function(){if(this.resolved)return this;if(eC.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return au.prototype.resolve.call(this)};$t.d=function(e,n,r){return typeof r=="function"?r=Mi.decorateType(r).name:r&&typeof r=="object"&&(r=Mi.decorateEnum(r).name),function(s,o){Mi.decorateType(s.constructor).add(new $t(o,e,n,r))}}});var Do=g((ck,$m)=>{"use strict";$m.exports=Gn;var lu=zn();((Gn.prototype=Object.create(lu.prototype)).constructor=Gn).className="Method";var Ir=Te();function Gn(t,e,n,r,i,s,o,a,l){if(Ir.isObject(i)?(o=i,i=s=void 0):Ir.isObject(s)&&(o=s,s=void 0),!(e===void 0||Ir.isString(e)))throw TypeError("type must be a string");if(!Ir.isString(n))throw TypeError("requestType must be a string");if(!Ir.isString(r))throw TypeError("responseType must be a string");lu.call(this,t,o),this.type=e||"rpc",this.requestType=n,this.requestStream=i?!0:void 0,this.responseType=r,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=l}Gn.fromJSON=function(e,n){return new Gn(e,n.type,n.requestType,n.responseType,n.requestStream,n.responseStream,n.options,n.comment,n.parsedOptions)};Gn.prototype.toJSON=function(e){var n=e?!!e.keepComments:!1;return Ir.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",n?this.comment:void 0,"parsedOptions",this.parsedOptions])};Gn.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),lu.prototype.resolve.call(this))}});var No=g((uk,Km)=>{"use strict";Km.exports=at;var gn=br();((at.prototype=Object.create(gn.prototype)).constructor=at).className="Service";var cu=Do(),Pi=Te(),tC=Zc();function at(t,e){gn.call(this,t,e),this.methods={},this._methodsArray=null}at.fromJSON=function(e,n){var r=new at(e,n.options);if(n.methods)for(var i=Object.keys(n.methods),s=0;s<i.length;++s)r.add(cu.fromJSON(i[s],n.methods[i[s]]));return n.nested&&r.addJSON(n.nested),r.comment=n.comment,r};at.prototype.toJSON=function(e){var n=gn.prototype.toJSON.call(this,e),r=e?!!e.keepComments:!1;return Pi.toObject(["options",n&&n.options||void 0,"methods",gn.arrayToJSON(this.methodsArray,e)||{},"nested",n&&n.nested||void 0,"comment",r?this.comment:void 0])};Object.defineProperty(at.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=Pi.toArray(this.methods))}});function Wm(t){return t._methodsArray=null,t}at.prototype.get=function(e){return this.methods[e]||gn.prototype.get.call(this,e)};at.prototype.resolveAll=function(){for(var e=this.methodsArray,n=0;n<e.length;++n)e[n].resolve();return gn.prototype.resolve.call(this)};at.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof cu?(this.methods[e.name]=e,e.parent=this,Wm(this)):gn.prototype.add.call(this,e)};at.prototype.remove=function(e){if(e instanceof cu){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,Wm(this)}return gn.prototype.remove.call(this,e)};at.prototype.create=function(e,n,r){for(var i=new tC.Service(e,n,r),s=0,o;s<this.methodsArray.length;++s){var a=Pi.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");i[a]=Pi.codegen(["r","c"],Pi.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return i}});var ko=g((hk,Hm)=>{"use strict";Hm.exports=Nt;var nC=Rt();function Nt(t){if(t)for(var e=Object.keys(t),n=0;n<e.length;++n)this[e[n]]=t[e[n]]}Nt.create=function(e){return this.$type.create(e)};Nt.encode=function(e,n){return this.$type.encode(e,n)};Nt.encodeDelimited=function(e,n){return this.$type.encodeDelimited(e,n)};Nt.decode=function(e){return this.$type.decode(e)};Nt.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};Nt.verify=function(e){return this.$type.verify(e)};Nt.fromObject=function(e){return this.$type.fromObject(e)};Nt.toObject=function(e,n){return this.$type.toObject(e,n)};Nt.prototype.toJSON=function(){return this.$type.toObject(this,nC.toJSONOptions)}});var uu=g((dk,Ym)=>{"use strict";Ym.exports=sC;var rC=yt(),Wt=Vn(),Qm=Te();function iC(t){return"missing required '"+t.name+"'"}function sC(t){var e=Qm.codegen(["r","l"],t.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(t.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");t.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var n=0;n<t.fieldsArray.length;++n){var r=t._fieldsArray[n].resolve(),i=r.resolvedType instanceof rC?"int32":r.type,s="m"+Qm.safeProp(r.name);e("case %i: {",r.id),r.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),Wt.defaults[r.keyType]!==void 0?e("k=%j",Wt.defaults[r.keyType]):e("k=null"),Wt.defaults[i]!==void 0?e("value=%j",Wt.defaults[i]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",r.keyType)("case 2:"),Wt.basic[i]===void 0?e("value=types[%i].decode(r,r.uint32())",n):e("value=r.%s()",i),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),Wt.long[r.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):r.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),Wt.packed[i]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,i)("}else"),Wt.basic[i]===void 0?e(r.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,n):e("%s.push(r.%s())",s,i)):Wt.basic[i]===void 0?e(r.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,n):e("%s=r.%s()",s,i),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),n=0;n<t._fieldsArray.length;++n){var o=t._fieldsArray[n];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",iC(o))}return e("return m")}});var fu=g((fk,Xm)=>{"use strict";Xm.exports=lC;var oC=yt(),hu=Te();function lt(t,e){return t.name+": "+e+(t.repeated&&e!=="array"?"[]":t.map&&e!=="object"?"{k:"+t.keyType+"}":"")+" expected"}function du(t,e,n,r){if(e.resolvedType)if(e.resolvedType instanceof oC){t("switch(%s){",r)("default:")("return%j",lt(e,"enum value"));for(var i=Object.keys(e.resolvedType.values),s=0;s<i.length;++s)t("case %i:",e.resolvedType.values[i[s]]);t("break")("}")}else t("{")("var e=types[%i].verify(%s);",n,r)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.isInteger(%s))",r)("return%j",lt(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",r,r,r,r)("return%j",lt(e,"integer|Long"));break;case"float":case"double":t('if(typeof %s!=="number")',r)("return%j",lt(e,"number"));break;case"bool":t('if(typeof %s!=="boolean")',r)("return%j",lt(e,"boolean"));break;case"string":t("if(!util.isString(%s))",r)("return%j",lt(e,"string"));break;case"bytes":t('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',r,r,r)("return%j",lt(e,"buffer"));break}return t}function aC(t,e,n){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.key32Re.test(%s))",n)("return%j",lt(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.key64Re.test(%s))",n)("return%j",lt(e,"integer|Long key"));break;case"bool":t("if(!util.key2Re.test(%s))",n)("return%j",lt(e,"boolean key"));break}return t}function lC(t){var e=hu.codegen(["m"],t.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),n=t.oneofsArray,r={};n.length&&e("var p={}");for(var i=0;i<t.fieldsArray.length;++i){var s=t._fieldsArray[i].resolve(),o="m"+hu.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",lt(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),aC(e,s,"k[i]"),du(e,s,i,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",lt(s,"array"))("for(var i=0;i<%s.length;++i){",o),du(e,s,i,o+"[i]")("}");else{if(s.partOf){var a=hu.safeProp(s.partOf.name);r[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),r[s.partOf.name]=1,e("p%s=1",a)}du(e,s,i,o)}s.optional&&e("}")}return e("return null")}});var mu=g(Zm=>{"use strict";var Jm=Zm,Li=yt(),kt=Te();function pu(t,e,n,r){var i=!1;if(e.resolvedType)if(e.resolvedType instanceof Li){t("switch(d%s){",r);for(var s=e.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===e.typeDefault&&!i&&(t("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',r,r,r),e.repeated||t("break"),i=!0),t("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",r,s[o[a]])("break");t("}")}else t('if(typeof d%s!=="object")',r)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",r,n,r);else{var l=!1;switch(e.type){case"double":case"float":t("m%s=Number(d%s)",r,r);break;case"uint32":case"fixed32":t("m%s=d%s>>>0",r,r);break;case"int32":case"sint32":case"sfixed32":t("m%s=d%s|0",r,r);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",r,r,l)('else if(typeof d%s==="string")',r)("m%s=parseInt(d%s,10)",r,r)('else if(typeof d%s==="number")',r)("m%s=d%s",r,r)('else if(typeof d%s==="object")',r)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",r,r,r,l?"true":"");break;case"bytes":t('if(typeof d%s==="string")',r)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",r,r,r)("else if(d%s.length >= 0)",r)("m%s=d%s",r,r);break;case"string":t("m%s=String(d%s)",r,r);break;case"bool":t("m%s=Boolean(d%s)",r,r);break}}return t}Jm.fromObject=function(e){var n=e.fieldsArray,r=kt.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!n.length)return r("return new this.ctor");r("var m=new this.ctor");for(var i=0;i<n.length;++i){var s=n[i].resolve(),o=kt.safeProp(s.name);s.map?(r("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),pu(r,s,i,o+"[ks[i]]")("}")("}")):s.repeated?(r("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),pu(r,s,i,o+"[i]")("}")("}")):(s.resolvedType instanceof Li||r("if(d%s!=null){",o),pu(r,s,i,o),s.resolvedType instanceof Li||r("}"))}return r("return m")};function gu(t,e,n,r){if(e.resolvedType)e.resolvedType instanceof Li?t("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",r,n,r,r,n,r,r):t("d%s=types[%i].toObject(m%s,o)",r,n,r);else{var i=!1;switch(e.type){case"double":case"float":t("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",r,r,r,r);break;case"uint64":i=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t('if(typeof m%s==="number")',r)("d%s=o.longs===String?String(m%s):m%s",r,r,r)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",r,r,r,r,i?"true":"",r);break;case"bytes":t("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",r,r,r,r,r);break;default:t("d%s=m%s",r,r);break}}return t}Jm.toObject=function(e){var n=e.fieldsArray.slice().sort(kt.compareFieldsById);if(!n.length)return kt.codegen()("return {}");for(var r=kt.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],s=[],o=[],a=0;a<n.length;++a)n[a].partOf||(n[a].resolve().repeated?i:n[a].map?s:o).push(n[a]);if(i.length){for(r("if(o.arrays||o.defaults){"),a=0;a<i.length;++a)r("d%s=[]",kt.safeProp(i[a].name));r("}")}if(s.length){for(r("if(o.objects||o.defaults){"),a=0;a<s.length;++a)r("d%s={}",kt.safeProp(s[a].name));r("}")}if(o.length){for(r("if(o.defaults){"),a=0;a<o.length;++a){var l=o[a],c=kt.safeProp(l.name);if(l.resolvedType instanceof Li)r("d%s=o.enums===String?%j:%j",c,l.resolvedType.valuesById[l.typeDefault],l.typeDefault);else if(l.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",l.typeDefault.low,l.typeDefault.high,l.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,l.typeDefault.toString(),l.typeDefault.toNumber());else if(l.bytes){var h="["+Array.prototype.slice.call(l.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,l.typeDefault))("else{")("d%s=%s",c,h)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")}else r("d%s=%j",c,l.typeDefault)}r("}")}var d=!1;for(a=0;a<n.length;++a){var l=n[a],f=e._fieldsArray.indexOf(l),c=kt.safeProp(l.name);l.map?(d||(d=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),gu(r,l,f,c+"[ks2[j]]")("}")):l.repeated?(r("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),gu(r,l,f,c+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",c,l.name),gu(r,l,f,c),l.partOf&&r("if(o.oneofs)")("d%s=%j",kt.safeProp(l.partOf.name),l.name)),r("}")}return r("return d")}});var yu=g(ey=>{"use strict";var cC=ey,uC=ko();cC[".google.protobuf.Any"]={fromObject:function(t){if(t&&t["@type"]){var e=t["@type"].substring(t["@type"].lastIndexOf("/")+1),n=this.lookup(e);if(n){var r=t["@type"].charAt(0)==="."?t["@type"].slice(1):t["@type"];return r.indexOf("/")===-1&&(r="/"+r),this.create({type_url:r,value:n.encode(n.fromObject(t)).finish()})}}return this.fromObject(t)},toObject:function(t,e){var n="type.googleapis.com/",r="",i="";if(e&&e.json&&t.type_url&&t.value){i=t.type_url.substring(t.type_url.lastIndexOf("/")+1),r=t.type_url.substring(0,t.type_url.lastIndexOf("/")+1);var s=this.lookup(i);s&&(t=s.decode(t.value))}if(!(t instanceof this.ctor)&&t instanceof uC){var o=t.$type.toObject(t,e),a=t.$type.fullName[0]==="."?t.$type.fullName.slice(1):t.$type.fullName;return r===""&&(r=n),i=r+a,o["@type"]=i,o}return this.toObject(t,e)}}});var Mo=g((mk,ny)=>{"use strict";ny.exports=J;var vt=br();((J.prototype=Object.create(vt.prototype)).constructor=J).className="Type";var hC=yt(),Tu=wr(),Oo=pn(),dC=Ro(),fC=No(),vu=ko(),Su=Co(),pC=Eo(),xe=Te(),gC=Eu(),mC=uu(),yC=fu(),ty=mu(),vC=yu();function J(t,e){vt.call(this,t,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(J.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var t=Object.keys(this.fields),e=0;e<t.length;++e){var n=this.fields[t[e]],r=n.id;if(this._fieldsById[r])throw Error("duplicate id "+r+" in "+this);this._fieldsById[r]=n}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=xe.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=xe.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=J.generateConstructor(this)())},set:function(t){var e=t.prototype;e instanceof vu||((t.prototype=new vu).constructor=t,xe.merge(t.prototype,e)),t.$type=t.prototype.$type=this,xe.merge(t,vu,!0),this._ctor=t;for(var n=0;n<this.fieldsArray.length;++n)this._fieldsArray[n].resolve();var r={};for(n=0;n<this.oneofsArray.length;++n)r[this._oneofsArray[n].resolve().name]={get:xe.oneOfGetter(this._oneofsArray[n].oneof),set:xe.oneOfSetter(this._oneofsArray[n].oneof)};n&&Object.defineProperties(t.prototype,r)}}});J.generateConstructor=function(e){for(var n=xe.codegen(["p"],e.name),r=0,i;r<e.fieldsArray.length;++r)(i=e._fieldsArray[r]).map?n("this%s={}",xe.safeProp(i.name)):i.repeated&&n("this%s=[]",xe.safeProp(i.name));return n("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function xo(t){return t._fieldsById=t._fieldsArray=t._oneofsArray=null,delete t.encode,delete t.decode,delete t.verify,t}J.fromJSON=function(e,n){var r=new J(e,n.options);r.extensions=n.extensions,r.reserved=n.reserved;for(var i=Object.keys(n.fields),s=0;s<i.length;++s)r.add((typeof n.fields[i[s]].keyType<"u"?dC.fromJSON:Oo.fromJSON)(i[s],n.fields[i[s]]));if(n.oneofs)for(i=Object.keys(n.oneofs),s=0;s<i.length;++s)r.add(Tu.fromJSON(i[s],n.oneofs[i[s]]));if(n.nested)for(i=Object.keys(n.nested),s=0;s<i.length;++s){var o=n.nested[i[s]];r.add((o.id!==void 0?Oo.fromJSON:o.fields!==void 0?J.fromJSON:o.values!==void 0?hC.fromJSON:o.methods!==void 0?fC.fromJSON:vt.fromJSON)(i[s],o))}return n.extensions&&n.extensions.length&&(r.extensions=n.extensions),n.reserved&&n.reserved.length&&(r.reserved=n.reserved),n.group&&(r.group=!0),n.comment&&(r.comment=n.comment),r};J.prototype.toJSON=function(e){var n=vt.prototype.toJSON.call(this,e),r=e?!!e.keepComments:!1;return xe.toObject(["options",n&&n.options||void 0,"oneofs",vt.arrayToJSON(this.oneofsArray,e),"fields",vt.arrayToJSON(this.fieldsArray.filter(function(i){return!i.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",n&&n.nested||void 0,"comment",r?this.comment:void 0])};J.prototype.resolveAll=function(){for(var e=this.fieldsArray,n=0;n<e.length;)e[n++].resolve();var r=this.oneofsArray;for(n=0;n<r.length;)r[n++].resolve();return vt.prototype.resolveAll.call(this)};J.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};J.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof Oo&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),xo(this)}return e instanceof Tu?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),xo(this)):vt.prototype.add.call(this,e)};J.prototype.remove=function(e){if(e instanceof Oo&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),xo(this)}if(e instanceof Tu){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),xo(this)}return vt.prototype.remove.call(this,e)};J.prototype.isReservedId=function(e){return vt.isReservedId(this.reserved,e)};J.prototype.isReservedName=function(e){return vt.isReservedName(this.reserved,e)};J.prototype.create=function(e){return new this.ctor(e)};J.prototype.setup=function(){for(var e=this.fullName,n=[],r=0;r<this.fieldsArray.length;++r)n.push(this._fieldsArray[r].resolve().resolvedType);this.encode=gC(this)({Writer:pC,types:n,util:xe}),this.decode=mC(this)({Reader:Su,types:n,util:xe}),this.verify=yC(this)({types:n,util:xe}),this.fromObject=ty.fromObject(this)({types:n,util:xe}),this.toObject=ty.toObject(this)({types:n,util:xe});var i=vC[e];if(i){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(s),s.toObject=this.toObject,this.toObject=i.toObject.bind(s)}return this};J.prototype.encode=function(e,n){return this.setup().encode(e,n)};J.prototype.encodeDelimited=function(e,n){return this.encode(e,n&&n.len?n.fork():n).ldelim()};J.prototype.decode=function(e,n){return this.setup().decode(e,n)};J.prototype.decodeDelimited=function(e){return e instanceof Su||(e=Su.create(e)),this.decode(e,e.uint32())};J.prototype.verify=function(e){return this.setup().verify(e)};J.prototype.fromObject=function(e){return this.setup().fromObject(e)};J.prototype.toObject=function(e,n){return this.setup().toObject(e,n)};J.d=function(e){return function(r){xe.decorateType(r,e)}}});var Fo=g((yk,ay)=>{"use strict";ay.exports=Ye;var Lo=br();((Ye.prototype=Object.create(Lo.prototype)).constructor=Ye).className="Root";var Cu=pn(),iy=yt(),SC=wr(),mn=Te(),sy,wu,Fi;function Ye(t){Lo.call(this,"",t),this.deferred=[],this.files=[]}Ye.fromJSON=function(e,n){return n||(n=new Ye),e.options&&n.setOptions(e.options),n.addJSON(e.nested)};Ye.prototype.resolvePath=mn.path.resolve;Ye.prototype.fetch=mn.fetch;function oy(){}Ye.prototype.load=function t(e,n,r){typeof n=="function"&&(r=n,n=void 0);var i=this;if(!r)return mn.asPromise(t,i,e,n);var s=r===oy;function o(p,y){if(r){var S=r;if(r=null,s)throw p;S(p,y)}}function a(p){var y=p.lastIndexOf("google/protobuf/");if(y>-1){var S=p.substring(y);if(S in Fi)return S}return null}function l(p,y){try{if(mn.isString(y)&&y.charAt(0)==="{"&&(y=JSON.parse(y)),!mn.isString(y))i.setOptions(y.options).addJSON(y.nested);else{wu.filename=p;var S=wu(y,i,n),C,_=0;if(S.imports)for(;_<S.imports.length;++_)(C=a(S.imports[_])||i.resolvePath(p,S.imports[_]))&&c(C);if(S.weakImports)for(_=0;_<S.weakImports.length;++_)(C=a(S.weakImports[_])||i.resolvePath(p,S.weakImports[_]))&&c(C,!0)}}catch(T){o(T)}!s&&!h&&o(null,i)}function c(p,y){if(p=a(p)||p,!(i.files.indexOf(p)>-1)){if(i.files.push(p),p in Fi){s?l(p,Fi[p]):(++h,setTimeout(function(){--h,l(p,Fi[p])}));return}if(s){var S;try{S=mn.fs.readFileSync(p).toString("utf8")}catch(C){y||o(C);return}l(p,S)}else++h,i.fetch(p,function(C,_){if(--h,!!r){if(C){y?h||o(null,i):o(C);return}l(p,_)}})}}var h=0;mn.isString(e)&&(e=[e]);for(var d=0,f;d<e.length;++d)(f=i.resolvePath("",e[d]))&&c(f);if(s)return i;h||o(null,i)};Ye.prototype.loadSync=function(e,n){if(!mn.isNode)throw Error("not supported");return this.load(e,n,oy)};Ye.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return Lo.prototype.resolveAll.call(this)};var Po=/^[A-Z]/;function ry(t,e){var n=e.parent.lookup(e.extend);if(n){var r=new Cu(e.fullName,e.id,e.type,e.rule,void 0,e.options);return n.get(r.name)||(r.declaringField=e,e.extensionField=r,n.add(r)),!0}return!1}Ye.prototype._handleAdd=function(e){if(e instanceof Cu)e.extend!==void 0&&!e.extensionField&&(ry(this,e)||this.deferred.push(e));else if(e instanceof iy)Po.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof SC)){if(e instanceof sy)for(var n=0;n<this.deferred.length;)ry(this,this.deferred[n])?this.deferred.splice(n,1):++n;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);Po.test(e.name)&&(e.parent[e.name]=e)}};Ye.prototype._handleRemove=function(e){if(e instanceof Cu){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var n=this.deferred.indexOf(e);n>-1&&this.deferred.splice(n,1)}}else if(e instanceof iy)Po.test(e.name)&&delete e.parent[e.name];else if(e instanceof Lo){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);Po.test(e.name)&&delete e.parent[e.name]}};Ye._configure=function(t,e,n){sy=t,wu=e,Fi=n}});var Te=g((vk,cy)=>{"use strict";var he=cy.exports=Rt(),ly=eu(),_u,bu;he.codegen=Am();he.fetch=Dm();he.path=Om();he.fs=he.inquire("fs");he.toArray=function(e){if(e){for(var n=Object.keys(e),r=new Array(n.length),i=0;i<n.length;)r[i]=e[n[i++]];return r}return[]};he.toObject=function(e){for(var n={},r=0;r<e.length;){var i=e[r++],s=e[r++];s!==void 0&&(n[i]=s)}return n};var TC=/\\/g,EC=/"/g;he.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};he.safeProp=function(e){return!/^[$\w_]+$/.test(e)||he.isReserved(e)?'["'+e.replace(TC,"\\\\").replace(EC,'\\"')+'"]':"."+e};he.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var wC=/_([a-z])/g;he.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(wC,function(n,r){return r.toUpperCase()})};he.compareFieldsById=function(e,n){return e.id-n.id};he.decorateType=function(e,n){if(e.$type)return n&&e.$type.name!==n&&(he.decorateRoot.remove(e.$type),e.$type.name=n,he.decorateRoot.add(e.$type)),e.$type;_u||(_u=Mo());var r=new _u(n||e.name);return he.decorateRoot.add(r),r.ctor=e,Object.defineProperty(e,"$type",{value:r,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:r,enumerable:!1}),r};var CC=0;he.decorateEnum=function(e){if(e.$type)return e.$type;bu||(bu=yt());var n=new bu("Enum"+CC++,e);return he.decorateRoot.add(n),Object.defineProperty(e,"$type",{value:n,enumerable:!1}),n};he.setProperty=function(e,n,r){function i(s,o,a){var l=o.shift();if(l==="__proto__"||l==="prototype")return s;if(o.length>0)s[l]=i(s[l]||{},o,a);else{var c=s[l];c&&(a=[].concat(c).concat(a)),s[l]=a}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!n)throw TypeError("path must be specified");return n=n.split("."),i(e,n,r)};Object.defineProperty(he,"decorateRoot",{get:function(){return ly.decorated||(ly.decorated=new(Fo()))}})});var zn=g((Sk,uy)=>{"use strict";uy.exports=Xe;Xe.className="ReflectionObject";var Bo=Te(),qo;function Xe(t,e){if(!Bo.isString(t))throw TypeError("name must be a string");if(e&&!Bo.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=t,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(Xe.prototype,{root:{get:function(){for(var t=this;t.parent!==null;)t=t.parent;return t}},fullName:{get:function(){for(var t=[this.name],e=this.parent;e;)t.unshift(e.name),e=e.parent;return t.join(".")}}});Xe.prototype.toJSON=function(){throw Error()};Xe.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var n=e.root;n instanceof qo&&n._handleAdd(this)};Xe.prototype.onRemove=function(e){var n=e.root;n instanceof qo&&n._handleRemove(this),this.parent=null,this.resolved=!1};Xe.prototype.resolve=function(){return this.resolved?this:(this.root instanceof qo&&(this.resolved=!0),this)};Xe.prototype.getOption=function(e){if(this.options)return this.options[e]};Xe.prototype.setOption=function(e,n,r){return(!r||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=n),this};Xe.prototype.setParsedOption=function(e,n,r){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(r){var s=i.find(function(l){return Object.prototype.hasOwnProperty.call(l,e)});if(s){var o=s[e];Bo.setProperty(o,r,n)}else s={},s[e]=Bo.setProperty({},r,n),i.push(s)}else{var a={};a[e]=n,i.push(a)}return this};Xe.prototype.setOptions=function(e,n){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)this.setOption(r[i],e[r[i]],n);return this};Xe.prototype.toString=function(){var e=this.constructor.className,n=this.fullName;return n.length?e+" "+n:e};Xe._configure=function(t){qo=t}});var yt=g((Tk,fy)=>{"use strict";fy.exports=Ot;var hy=zn();((Ot.prototype=Object.create(hy.prototype)).constructor=Ot).className="Enum";var dy=br(),Uo=Te();function Ot(t,e,n,r,i,s){if(hy.call(this,t,n),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=r,this.comments=i||{},this.valuesOptions=s,this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}Ot.fromJSON=function(e,n){var r=new Ot(e,n.values,n.options,n.comment,n.comments);return r.reserved=n.reserved,r};Ot.prototype.toJSON=function(e){var n=e?!!e.keepComments:!1;return Uo.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",n?this.comment:void 0,"comments",n?this.comments:void 0])};Ot.prototype.add=function(e,n,r,i){if(!Uo.isString(e))throw TypeError("name must be a string");if(!Uo.isInteger(n))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(n))throw Error("id "+n+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[n]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+n+" in "+this);this.values[e]=n}else this.valuesById[this.values[e]=n]=e;return i&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=i||null),this.comments[e]=r||null,this};Ot.prototype.remove=function(e){if(!Uo.isString(e))throw TypeError("name must be a string");var n=this.values[e];if(n==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[n],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};Ot.prototype.isReservedId=function(e){return dy.isReservedId(this.reserved,e)};Ot.prototype.isReservedName=function(e){return dy.isReservedName(this.reserved,e)}});var Eu=g((Ek,gy)=>{"use strict";gy.exports=bC;var _C=yt(),Iu=Vn(),Au=Te();function py(t,e,n,r){return e.resolvedType.group?t("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",n,r,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):t("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",n,r,(e.id<<3|2)>>>0)}function bC(t){for(var e=Au.codegen(["m","w"],t.name+"$encode")("if(!w)")("w=Writer.create()"),n,r,i=t.fieldsArray.slice().sort(Au.compareFieldsById),n=0;n<i.length;++n){var s=i[n].resolve(),o=t._fieldsArray.indexOf(s),a=s.resolvedType instanceof _C?"int32":s.type,l=Iu.basic[a];r="m"+Au.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",r,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",r)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|Iu.mapKey[s.keyType],s.keyType),l===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,r):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|l,a,r),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",r,r),s.packed&&Iu.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",r)("w.%s(%s[i])",a,r)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",r),l===void 0?py(e,s,o,r+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|l)>>>0,a,r)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",r,s.name),l===void 0?py(e,s,o,r):e("w.uint32(%i).%s(%s)",(s.id<<3|l)>>>0,a,r))}return e("return w")}});var yy=g((wk,my)=>{"use strict";var z=my.exports=bm();z.build="light";function IC(t,e,n){return typeof e=="function"?(n=e,e=new z.Root):e||(e=new z.Root),e.load(t,n)}z.load=IC;function AC(t,e){return e||(e=new z.Root),e.loadSync(t)}z.loadSync=AC;z.encoder=Eu();z.decoder=uu();z.verifier=fu();z.converter=mu();z.ReflectionObject=zn();z.Namespace=br();z.Root=Fo();z.Enum=yt();z.Type=Mo();z.Field=pn();z.OneOf=wr();z.MapField=Ro();z.Service=No();z.Method=Do();z.Message=ko();z.wrappers=yu();z.types=Vn();z.util=Te();z.ReflectionObject._configure(z.Root);z.Namespace._configure(z.Type,z.Service,z.Enum);z.Root._configure(z.Type);z.Field._configure(z.Type)});var Du=g((Ck,Ty)=>{"use strict";Ty.exports=Sy;var Ru=/[\s{}=;:[\],'"()<>]/g,RC=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,DC=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,NC=/^ *[*/]+ */,kC=/^\s*\*?\/*/,OC=/\n/g,xC=/\s/,MC=/\\(.?)/g,PC={0:"\0",r:"\r",n:`
`,t:"	"};function vy(t){return t.replace(MC,function(e,n){switch(n){case"\\":case"":return n;default:return PC[n]||""}})}Sy.unescape=vy;function Sy(t,e){t=t.toString();var n=0,r=t.length,i=1,s=0,o={},a=[],l=null;function c(A){return Error("illegal "+A+" (line "+i+")")}function h(){var A=l==="'"?DC:RC;A.lastIndex=n-1;var M=A.exec(t);if(!M)throw c("string");return n=A.lastIndex,C(l),l=null,vy(M[1])}function d(A){return t.charAt(A)}function f(A,M,L){var V={type:t.charAt(A++),lineEmpty:!1,leading:L},ge;e?ge=2:ge=3;var Ae=A-ge,X;do if(--Ae<0||(X=t.charAt(Ae))===`
`){V.lineEmpty=!0;break}while(X===" "||X==="	");for(var m=t.substring(A,M).split(OC),se=0;se<m.length;++se)m[se]=m[se].replace(e?kC:NC,"").trim();V.text=m.join(`
`).trim(),o[i]=V,s=i}function p(A){var M=y(A),L=t.substring(A,M),V=/^\s*\/\//.test(L);return V}function y(A){for(var M=A;M<r&&d(M)!==`
`;)M++;return M}function S(){if(a.length>0)return a.shift();if(l)return h();var A,M,L,V,ge,Ae=n===0;do{if(n===r)return null;for(A=!1;xC.test(L=d(n));)if(L===`
`&&(Ae=!0,++i),++n===r)return null;if(d(n)==="/"){if(++n===r)throw c("comment");if(d(n)==="/")if(e){if(V=n,ge=!1,p(n-1)){ge=!0;do if(n=y(n),n===r||(n++,!Ae))break;while(p(n))}else n=Math.min(r,y(n)+1);ge&&(f(V,n,Ae),Ae=!0),i++,A=!0}else{for(ge=d(V=n+1)==="/";d(++n)!==`
`;)if(n===r)return null;++n,ge&&(f(V,n-1,Ae),Ae=!0),++i,A=!0}else if((L=d(n))==="*"){V=n+1,ge=e||d(V)==="*";do{if(L===`
`&&++i,++n===r)throw c("comment");M=L,L=d(n)}while(M!=="*"||L!=="/");++n,ge&&(f(V,n-2,Ae),Ae=!0),A=!0}else return"/"}}while(A);var X=n;Ru.lastIndex=0;var m=Ru.test(d(X++));if(!m)for(;X<r&&!Ru.test(d(X));)++X;var se=t.substring(n,n=X);return(se==='"'||se==="'")&&(l=se),se}function C(A){a.push(A)}function _(){if(!a.length){var A=S();if(A===null)return null;C(A)}return a[0]}function T(A,M){var L=_(),V=L===A;if(V)return S(),!0;if(!M)throw c("token '"+L+"', '"+A+"' expected");return!1}function N(A){var M=null,L;return A===void 0?(L=o[i-1],delete o[i-1],L&&(e||L.type==="*"||L.lineEmpty)&&(M=L.leading?L.text:null)):(s<A&&_(),L=o[A],delete o[A],L&&!L.lineEmpty&&(e||L.type==="/")&&(M=L.leading?null:L.text)),M}return Object.defineProperty({next:S,peek:_,push:C,skip:T,cmnt:N},"line",{get:function(){return i}})}});var Iy=g((_k,by)=>{"use strict";by.exports=Kt;Kt.filename=null;Kt.defaults={keepCase:!1};var LC=Du(),Ey=Fo(),wy=Mo(),Cy=pn(),FC=Ro(),_y=wr(),BC=yt(),qC=No(),UC=Do(),Nu=Vn(),ku=Te(),VC=/^[1-9][0-9]*$/,zC=/^-?[1-9][0-9]*$/,GC=/^0[x][0-9a-fA-F]+$/,jC=/^-?0[x][0-9a-fA-F]+$/,$C=/^0[0-7]+$/,WC=/^-?0[0-7]+$/,KC=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,xt=/^[a-zA-Z_][a-zA-Z_0-9]*$/,Mt=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,HC=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function Kt(t,e,n){e instanceof Ey||(n=e,e=new Ey),n||(n=Kt.defaults);var r=n.preferTrailingComment||!1,i=LC(t,n.alternateCommentMode||!1),s=i.next,o=i.push,a=i.peek,l=i.skip,c=i.cmnt,h=!0,d,f,p,y,S=!1,C=e,_=n.keepCase?function(E){return E}:ku.camelCase;function T(E,w,b){var x=Kt.filename;return b||(Kt.filename=null),Error("illegal "+(w||"token")+" '"+E+"' ("+(x?x+", ":"")+"line "+i.line+")")}function N(){var E=[],w;do{if((w=s())!=='"'&&w!=="'")throw T(w);E.push(s()),l(w),w=a()}while(w==='"'||w==="'");return E.join("")}function A(E){var w=s();switch(w){case"'":case'"':return o(w),N();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return L(w,!0)}catch{if(E&&Mt.test(w))return w;throw T(w,"value")}}function M(E,w){var b,x;do w&&((b=a())==='"'||b==="'")?E.push(N()):E.push([x=V(s()),l("to",!0)?V(s()):x]);while(l(",",!0));l(";")}function L(E,w){var b=1;switch(E.charAt(0)==="-"&&(b=-1,E=E.substring(1)),E){case"inf":case"INF":case"Inf":return b*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(VC.test(E))return b*parseInt(E,10);if(GC.test(E))return b*parseInt(E,16);if($C.test(E))return b*parseInt(E,8);if(KC.test(E))return b*parseFloat(E);throw T(E,"number",w)}function V(E,w){switch(E){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!w&&E.charAt(0)==="-")throw T(E,"id");if(zC.test(E))return parseInt(E,10);if(jC.test(E))return parseInt(E,16);if(WC.test(E))return parseInt(E,8);throw T(E,"id")}function ge(){if(d!==void 0)throw T("package");if(d=s(),!Mt.test(d))throw T(d,"name");C=C.define(d),l(";")}function Ae(){var E=a(),w;switch(E){case"weak":w=p||(p=[]),s();break;case"public":s();default:w=f||(f=[]);break}E=N(),l(";"),w.push(E)}function X(){if(l("="),y=N(),S=y==="proto3",!S&&y!=="proto2")throw T(y,"syntax");l(";")}function m(E,w){switch(w){case"option":return ee(E,w),l(";"),!0;case"message":return v(E,w),!0;case"enum":return Q(E,w),!0;case"service":return fe(E,w),!0;case"extend":return Qn(E,w),!0}return!1}function se(E,w,b){var x=i.line;if(E&&(typeof E.comment!="string"&&(E.comment=c()),E.filename=Kt.filename),l("{",!0)){for(var O;(O=s())!=="}";)w(O);l(";",!0)}else b&&b(),l(";"),E&&(typeof E.comment!="string"||r)&&(E.comment=c(x)||E.comment)}function v(E,w){if(!xt.test(w=s()))throw T(w,"type name");var b=new wy(w);se(b,function(O){if(!m(b,O))switch(O){case"map":G(b,O);break;case"required":case"repeated":u(b,O);break;case"optional":S?u(b,"proto3_optional"):u(b,"optional");break;case"oneof":ne(b,O);break;case"extensions":M(b.extensions||(b.extensions=[]));break;case"reserved":M(b.reserved||(b.reserved=[]),!0);break;default:if(!S||!Mt.test(O))throw T(O);o(O),u(b,"optional");break}}),E.add(b)}function u(E,w,b){var x=s();if(x==="group"){R(E,w);return}for(;x.endsWith(".")||a().startsWith(".");)x+=s();if(!Mt.test(x))throw T(x,"type");var O=s();if(!xt.test(O))throw T(O,"name");O=_(O),l("=");var q=new Cy(O,V(s()),x,w,b);if(se(q,function(Ke){if(Ke==="option")ee(q,Ke),l(";");else throw T(Ke)},function(){Re(q)}),w==="proto3_optional"){var Ce=new _y("_"+O);q.setOption("proto3_optional",!0),Ce.add(q),E.add(Ce)}else E.add(q);!S&&q.repeated&&(Nu.packed[x]!==void 0||Nu.basic[x]===void 0)&&q.setOption("packed",!1,!0)}function R(E,w){var b=s();if(!xt.test(b))throw T(b,"name");var x=ku.lcFirst(b);b===x&&(b=ku.ucFirst(b)),l("=");var O=V(s()),q=new wy(b);q.group=!0;var Ce=new Cy(x,O,b,w);Ce.filename=Kt.filename,se(q,function(Ke){switch(Ke){case"option":ee(q,Ke),l(";");break;case"required":case"repeated":u(q,Ke);break;case"optional":S?u(q,"proto3_optional"):u(q,"optional");break;case"message":v(q,Ke);break;case"enum":Q(q,Ke);break;default:throw T(Ke)}}),E.add(q).add(Ce)}function G(E){l("<");var w=s();if(Nu.mapKey[w]===void 0)throw T(w,"type");l(",");var b=s();if(!Mt.test(b))throw T(b,"type");l(">");var x=s();if(!xt.test(x))throw T(x,"name");l("=");var O=new FC(_(x),V(s()),w,b);se(O,function(Ce){if(Ce==="option")ee(O,Ce),l(";");else throw T(Ce)},function(){Re(O)}),E.add(O)}function ne(E,w){if(!xt.test(w=s()))throw T(w,"name");var b=new _y(_(w));se(b,function(O){O==="option"?(ee(b,O),l(";")):(o(O),u(b,"optional"))}),E.add(b)}function Q(E,w){if(!xt.test(w=s()))throw T(w,"name");var b=new BC(w);se(b,function(O){switch(O){case"option":ee(b,O),l(";");break;case"reserved":M(b.reserved||(b.reserved=[]),!0);break;default:ce(b,O)}}),E.add(b)}function ce(E,w){if(!xt.test(w))throw T(w,"name");l("=");var b=V(s(),!0),x={options:void 0};x.setOption=function(O,q){this.options===void 0&&(this.options={}),this.options[O]=q},se(x,function(q){if(q==="option")ee(x,q),l(";");else throw T(q)},function(){Re(x)}),E.add(w,b,x.comment,x.options)}function ee(E,w){var b=l("(",!0);if(!Mt.test(w=s()))throw T(w,"name");var x=w,O=x,q;b&&(l(")"),x="("+x+")",O=x,w=a(),HC.test(w)&&(q=w.slice(1),x+=w,s())),l("=");var Ce=Fe(E,x);oe(E,O,Ce,q)}function Fe(E,w){if(l("{",!0)){for(var b={};!l("}",!0);){if(!xt.test(De=s()))throw T(De,"name");if(De===null)throw T(De,"end of input");var x,O=De;if(l(":",!0),a()==="{")x=Fe(E,w+"."+De);else if(a()==="["){x=[];var q;if(l("[",!0)){do q=A(!0),x.push(q);while(l(",",!0));l("]"),typeof q<"u"&&de(E,w+"."+De,q)}}else x=A(!0),de(E,w+"."+De,x);var Ce=b[O];Ce&&(x=[].concat(Ce).concat(x)),b[O]=x,l(",",!0),l(";",!0)}return b}var Zt=A(!0);return de(E,w,Zt),Zt}function de(E,w,b){E.setOption&&E.setOption(w,b)}function oe(E,w,b,x){E.setParsedOption&&E.setParsedOption(w,b,x)}function Re(E){if(l("[",!0)){do ee(E,"option");while(l(",",!0));l("]")}return E}function fe(E,w){if(!xt.test(w=s()))throw T(w,"service name");var b=new qC(w);se(b,function(O){if(!m(b,O))if(O==="rpc")Be(b,O);else throw T(O)}),E.add(b)}function Be(E,w){var b=c(),x=w;if(!xt.test(w=s()))throw T(w,"name");var O=w,q,Ce,Zt,Ke;if(l("("),l("stream",!0)&&(Ce=!0),!Mt.test(w=s())||(q=w,l(")"),l("returns"),l("("),l("stream",!0)&&(Ke=!0),!Mt.test(w=s())))throw T(w);Zt=w,l(")");var is=new UC(O,x,q,Zt,Ce,Ke);is.comment=b,se(is,function(Ja){if(Ja==="option")ee(is,Ja),l(";");else throw T(Ja)}),E.add(is)}function Qn(E,w){if(!Mt.test(w=s()))throw T(w,"reference");var b=w;se(null,function(O){switch(O){case"required":case"repeated":u(E,O,b);break;case"optional":S?u(E,"proto3_optional",b):u(E,"optional",b);break;default:if(!S||!Mt.test(O))throw T(O);o(O),u(E,"optional",b);break}})}for(var De;(De=s())!==null;)switch(De){case"package":if(!h)throw T(De);ge();break;case"import":if(!h)throw T(De);Ae();break;case"syntax":if(!h)throw T(De);X();break;case"option":ee(C,De),l(";");break;default:if(m(C,De)){h=!1;continue}throw T(De)}return Kt.filename=null,{package:d,imports:f,weakImports:p,syntax:y,root:e}}});var Dy=g((bk,Ry)=>{"use strict";Ry.exports=St;var QC=/\/|\./;function St(t,e){QC.test(t)||(t="google/protobuf/"+t+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),St[t]=e}St("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var Ay;St("duration",{Duration:Ay={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});St("timestamp",{Timestamp:Ay});St("empty",{Empty:{fields:{}}});St("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});St("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});St("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});St.get=function(e){return St[e]||null}});var ky=g((Ik,Ny)=>{"use strict";var yn=Ny.exports=yy();yn.build="full";yn.tokenize=Du();yn.parse=Iy();yn.common=Dy();yn.Root._configure(yn.Type,yn.parse,yn.common)});var Vo=g((Ak,Oy)=>{"use strict";Oy.exports=ky()});var Ou=g((Rk,YC)=>{YC.exports={nested:{google:{nested:{protobuf:{nested:{FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}}}}}}}}});var Fy=g((B,Ly)=>{"use strict";var ze=Vo();Ly.exports=B=ze.descriptor=ze.Root.fromJSON(Ou()).lookup(".google.protobuf");var xy=ze.Namespace,Bi=ze.Root,Ht=ze.Enum,vn=ze.Type,Sn=ze.Field,XC=ze.MapField,zo=ze.OneOf,qi=ze.Service,Go=ze.Method;Bi.fromDescriptor=function(e){typeof e.length=="number"&&(e=B.FileDescriptorSet.decode(e));var n=new Bi;if(e.file)for(var r,i,s=0,o;s<e.file.length;++s){if(i=n,(r=e.file[s]).package&&r.package.length&&(i=n.define(r.package)),r.name&&r.name.length&&n.files.push(i.filename=r.name),r.messageType)for(o=0;o<r.messageType.length;++o)i.add(vn.fromDescriptor(r.messageType[o],r.syntax));if(r.enumType)for(o=0;o<r.enumType.length;++o)i.add(Ht.fromDescriptor(r.enumType[o]));if(r.extension)for(o=0;o<r.extension.length;++o)i.add(Sn.fromDescriptor(r.extension[o]));if(r.service)for(o=0;o<r.service.length;++o)i.add(qi.fromDescriptor(r.service[o]));var a=Ar(r.options,B.FileOptions);if(a){var l=Object.keys(a);for(o=0;o<l.length;++o)i.setOption(l[o],a[l[o]])}}return n};Bi.prototype.toDescriptor=function(e){var n=B.FileDescriptorSet.create();return My(this,n.file,e),n};function My(t,e,n){var r=B.FileDescriptorProto.create({name:t.filename||(t.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});n&&(r.syntax=n),t instanceof Bi||(r.package=t.fullName.substring(1));for(var i=0,s;i<t.nestedArray.length;++i)(s=t._nestedArray[i])instanceof vn?r.messageType.push(s.toDescriptor(n)):s instanceof Ht?r.enumType.push(s.toDescriptor()):s instanceof Sn?r.extension.push(s.toDescriptor(n)):s instanceof qi?r.service.push(s.toDescriptor()):s instanceof xy&&My(s,e,n);r.options=Rr(t.options,B.FileOptions),r.messageType.length+r.enumType.length+r.extension.length+r.service.length&&e.push(r)}var JC=0;vn.fromDescriptor=function(e,n){typeof e.length=="number"&&(e=B.DescriptorProto.decode(e));var r=new vn(e.name.length?e.name:"Type"+JC++,Ar(e.options,B.MessageOptions)),i;if(e.oneofDecl)for(i=0;i<e.oneofDecl.length;++i)r.add(zo.fromDescriptor(e.oneofDecl[i]));if(e.field)for(i=0;i<e.field.length;++i){var s=Sn.fromDescriptor(e.field[i],n);r.add(s),e.field[i].hasOwnProperty("oneofIndex")&&r.oneofsArray[e.field[i].oneofIndex].add(s)}if(e.extension)for(i=0;i<e.extension.length;++i)r.add(Sn.fromDescriptor(e.extension[i],n));if(e.nestedType)for(i=0;i<e.nestedType.length;++i)r.add(vn.fromDescriptor(e.nestedType[i],n)),e.nestedType[i].options&&e.nestedType[i].options.mapEntry&&r.setOption("map_entry",!0);if(e.enumType)for(i=0;i<e.enumType.length;++i)r.add(Ht.fromDescriptor(e.enumType[i]));if(e.extensionRange&&e.extensionRange.length)for(r.extensions=[],i=0;i<e.extensionRange.length;++i)r.extensions.push([e.extensionRange[i].start,e.extensionRange[i].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(r.reserved=[],e.reservedRange)for(i=0;i<e.reservedRange.length;++i)r.reserved.push([e.reservedRange[i].start,e.reservedRange[i].end]);if(e.reservedName)for(i=0;i<e.reservedName.length;++i)r.reserved.push(e.reservedName[i])}return r};vn.prototype.toDescriptor=function(e){var n=B.DescriptorProto.create({name:this.name}),r;for(r=0;r<this.fieldsArray.length;++r){var i;if(n.field.push(i=this._fieldsArray[r].toDescriptor(e)),this._fieldsArray[r]instanceof XC){var s=xu(this._fieldsArray[r].keyType,this._fieldsArray[r].resolvedKeyType),o=xu(this._fieldsArray[r].type,this._fieldsArray[r].resolvedType),a=o===11||o===14?this._fieldsArray[r].resolvedType&&Py(this.parent,this._fieldsArray[r].resolvedType)||this._fieldsArray[r].type:void 0;n.nestedType.push(B.DescriptorProto.create({name:i.typeName,field:[B.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),B.FieldDescriptorProto.create({name:"value",number:2,label:1,type:o,typeName:a})],options:B.MessageOptions.create({mapEntry:!0})}))}}for(r=0;r<this.oneofsArray.length;++r)n.oneofDecl.push(this._oneofsArray[r].toDescriptor());for(r=0;r<this.nestedArray.length;++r)this._nestedArray[r]instanceof Sn?n.field.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof vn?n.nestedType.push(this._nestedArray[r].toDescriptor(e)):this._nestedArray[r]instanceof Ht&&n.enumType.push(this._nestedArray[r].toDescriptor());if(this.extensions)for(r=0;r<this.extensions.length;++r)n.extensionRange.push(B.DescriptorProto.ExtensionRange.create({start:this.extensions[r][0],end:this.extensions[r][1]}));if(this.reserved)for(r=0;r<this.reserved.length;++r)typeof this.reserved[r]=="string"?n.reservedName.push(this.reserved[r]):n.reservedRange.push(B.DescriptorProto.ReservedRange.create({start:this.reserved[r][0],end:this.reserved[r][1]}));return n.options=Rr(this.options,B.MessageOptions),n};var ZC=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;Sn.fromDescriptor=function(e,n){if(typeof e.length=="number"&&(e=B.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var r;e.typeName&&e.typeName.length?r=e.typeName:r=i_(e.type);var i;switch(e.label){case 1:i=void 0;break;case 2:i="required";break;case 3:i="repeated";break;default:throw Error("illegal label: "+e.label)}var s=e.extendee;e.extendee!==void 0&&(s=s.length?s:void 0);var o=new Sn(e.name.length?e.name:"field"+e.number,e.number,r,i,s);if(o.options=Ar(e.options,B.FieldOptions),e.defaultValue&&e.defaultValue.length){var a=e.defaultValue;switch(a){case"true":case"TRUE":a=!0;break;case"false":case"FALSE":a=!1;break;default:var l=ZC.exec(a);l&&(a=parseInt(a));break}o.setOption("default",a)}return s_(e.type)&&(n==="proto3"?e.options&&!e.options.packed&&o.setOption("packed",!1):e.options&&e.options.packed||o.setOption("packed",!1)),o};Sn.prototype.toDescriptor=function(e){var n=B.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)n.type=11,n.typeName=ze.util.ucFirst(this.name),n.label=3;else{switch(n.type=xu(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:n.typeName=this.resolvedType?Py(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":n.label=3;break;case"required":n.label=2;break;default:n.label=1;break}}if(n.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(n.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(n.options=Rr(this.options,B.FieldOptions),this.options.default!=null&&(n.defaultValue=String(this.options.default))),e==="proto3"?this.packed||((n.options||(n.options=B.FieldOptions.create())).packed=!1):this.packed&&((n.options||(n.options=B.FieldOptions.create())).packed=!0),n};var e_=0;Ht.fromDescriptor=function(e){typeof e.length=="number"&&(e=B.EnumDescriptorProto.decode(e));var n={};if(e.value)for(var r=0;r<e.value.length;++r){var i=e.value[r].name,s=e.value[r].number||0;n[i&&i.length?i:"NAME"+s]=s}return new Ht(e.name&&e.name.length?e.name:"Enum"+e_++,n,Ar(e.options,B.EnumOptions))};Ht.prototype.toDescriptor=function(){for(var e=[],n=0,r=Object.keys(this.values);n<r.length;++n)e.push(B.EnumValueDescriptorProto.create({name:r[n],number:this.values[r[n]]}));return B.EnumDescriptorProto.create({name:this.name,value:e,options:Rr(this.options,B.EnumOptions)})};var t_=0;zo.fromDescriptor=function(e){return typeof e.length=="number"&&(e=B.OneofDescriptorProto.decode(e)),new zo(e.name&&e.name.length?e.name:"oneof"+t_++)};zo.prototype.toDescriptor=function(){return B.OneofDescriptorProto.create({name:this.name})};var n_=0;qi.fromDescriptor=function(e){typeof e.length=="number"&&(e=B.ServiceDescriptorProto.decode(e));var n=new qi(e.name&&e.name.length?e.name:"Service"+n_++,Ar(e.options,B.ServiceOptions));if(e.method)for(var r=0;r<e.method.length;++r)n.add(Go.fromDescriptor(e.method[r]));return n};qi.prototype.toDescriptor=function(){for(var e=[],n=0;n<this.methodsArray.length;++n)e.push(this._methodsArray[n].toDescriptor());return B.ServiceDescriptorProto.create({name:this.name,method:e,options:Rr(this.options,B.ServiceOptions)})};var r_=0;Go.fromDescriptor=function(e){return typeof e.length=="number"&&(e=B.MethodDescriptorProto.decode(e)),new Go(e.name&&e.name.length?e.name:"Method"+r_++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,Ar(e.options,B.MethodOptions))};Go.prototype.toDescriptor=function(){return B.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:Rr(this.options,B.MethodOptions)})};function i_(t){switch(t){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+t)}function s_(t){switch(t){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function xu(t,e){switch(t){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof Ht)return 14;if(e instanceof vn)return e.group?10:11;throw Error("illegal type: "+t)}function Ar(t,e){if(t){for(var n=[],r=0,i,s,o;r<e.fieldsArray.length;++r)(s=(i=e._fieldsArray[r]).name)!=="uninterpretedOption"&&t.hasOwnProperty(s)&&(o=t[s],i.resolvedType instanceof Ht&&typeof o=="number"&&i.resolvedType.valuesById[o]!==void 0&&(o=i.resolvedType.valuesById[o]),n.push(o_(s),o));return n.length?ze.util.toObject(n):void 0}}function Rr(t,e){if(t){for(var n=[],r=0,i=Object.keys(t),s,o;r<i.length;++r)if(o=t[s=i[r]],s!=="default"){var a=e.fields[s];!a&&!(a=e.fields[s=ze.util.camelCase(s)])||n.push(s,o)}return n.length?e.fromObject(ze.util.toObject(n)):void 0}}function Py(t,e){var n=t.fullName.split("."),r=e.fullName.split("."),i=0,s=0,o=r.length-1;if(!(t instanceof Bi)&&e instanceof xy)for(;i<n.length&&s<o&&n[i]===r[s];){var a=e.lookup(n[i++],!0);if(a!==null&&a!==e)break;++s}else for(;i<n.length&&s<o&&n[i]===r[s];++i,++s);return r.slice(s).join(".")}function o_(t){return t.substring(0,1)+t.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,n){return"_"+n.toLowerCase()})}});var By=g((Dk,a_)=>{a_.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var qy=g((Nk,l_)=>{l_.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var Uy=g((kk,c_)=>{c_.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var jy=g(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});Tn.addCommonProtos=Tn.loadProtosWithOptionsSync=Tn.loadProtosWithOptions=void 0;var Vy=K("fs"),zy=K("path"),Dr=Vo();function Gy(t,e){let n=t.resolvePath;t.resolvePath=(r,i)=>{if(zy.isAbsolute(i))return i;for(let s of e){let o=zy.join(s,i);try{return Vy.accessSync(o,Vy.constants.R_OK),o}catch{continue}}return process.emitWarning(`${i} not found in any of the include paths ${e}`),n(r,i)}}function u_(t,e){return U(this,null,function*(){let n=new Dr.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));Gy(n,e.includeDirs)}let r=yield n.load(t,e);return r.resolveAll(),r})}Tn.loadProtosWithOptions=u_;function h_(t,e){let n=new Dr.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");Gy(n,e.includeDirs)}let r=n.loadSync(t,e);return r.resolveAll(),r}Tn.loadProtosWithOptionsSync=h_;function d_(){let t=By(),e=Ou(),n=qy(),r=Uy();Dr.common("api",t.nested.google.nested.protobuf.nested),Dr.common("descriptor",e.nested.google.nested.protobuf.nested),Dr.common("source_context",n.nested.google.nested.protobuf.nested),Dr.common("type",r.nested.google.nested.protobuf.nested)}Tn.addCommonProtos=d_});var Ky=g((Wy,Mu)=>{"use strict";var $y=function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function n(v,u,R){this.low=v|0,this.high=u|0,this.unsigned=!!R}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0});function r(v){return(v&&v.__isLong__)===!0}function i(v){var u=Math.clz32(v&-v);return v?31-u:u}n.isLong=r;var s={},o={};function a(v,u){var R,G,ne;return u?(v>>>=0,(ne=0<=v&&v<256)&&(G=o[v],G)?G:(R=c(v,0,!0),ne&&(o[v]=R),R)):(v|=0,(ne=-128<=v&&v<128)&&(G=s[v],G)?G:(R=c(v,v<0?-1:0,!1),ne&&(s[v]=R),R))}n.fromInt=a;function l(v,u){if(isNaN(v))return u?A:N;if(u){if(v<0)return A;if(v>=C)return Ae}else{if(v<=-_)return X;if(v+1>=_)return ge}return v<0?l(-v,u).neg():c(v%S|0,v/S|0,u)}n.fromNumber=l;function c(v,u,R){return new n(v,u,R)}n.fromBits=c;var h=Math.pow;function d(v,u,R){if(v.length===0)throw Error("empty string");if(typeof u=="number"?(R=u,u=!1):u=!!u,v==="NaN"||v==="Infinity"||v==="+Infinity"||v==="-Infinity")return u?A:N;if(R=R||10,R<2||36<R)throw RangeError("radix");var G;if((G=v.indexOf("-"))>0)throw Error("interior hyphen");if(G===0)return d(v.substring(1),u,R).neg();for(var ne=l(h(R,8)),Q=N,ce=0;ce<v.length;ce+=8){var ee=Math.min(8,v.length-ce),Fe=parseInt(v.substring(ce,ce+ee),R);if(ee<8){var de=l(h(R,ee));Q=Q.mul(de).add(l(Fe))}else Q=Q.mul(ne),Q=Q.add(l(Fe))}return Q.unsigned=u,Q}n.fromString=d;function f(v,u){return typeof v=="number"?l(v,u):typeof v=="string"?d(v,u):c(v.low,v.high,typeof u=="boolean"?u:v.unsigned)}n.fromValue=f;var p=65536,y=1<<24,S=p*p,C=S*S,_=C/2,T=a(y),N=a(0);n.ZERO=N;var A=a(0,!0);n.UZERO=A;var M=a(1);n.ONE=M;var L=a(1,!0);n.UONE=L;var V=a(-1);n.NEG_ONE=V;var ge=c(-1,2147483647,!1);n.MAX_VALUE=ge;var Ae=c(-1,-1,!0);n.MAX_UNSIGNED_VALUE=Ae;var X=c(0,-2147483648,!1);n.MIN_VALUE=X;var m=n.prototype;m.toInt=function(){return this.unsigned?this.low>>>0:this.low},m.toNumber=function(){return this.unsigned?(this.high>>>0)*S+(this.low>>>0):this.high*S+(this.low>>>0)},m.toString=function(u){if(u=u||10,u<2||36<u)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(X)){var R=l(u),G=this.div(R),ne=G.mul(R).sub(this);return G.toString(u)+ne.toInt().toString(u)}else return"-"+this.neg().toString(u);for(var Q=l(h(u,6),this.unsigned),ce=this,ee="";;){var Fe=ce.div(Q),de=ce.sub(Fe.mul(Q)).toInt()>>>0,oe=de.toString(u);if(ce=Fe,ce.isZero())return oe+ee;for(;oe.length<6;)oe="0"+oe;ee=""+oe+ee}},m.getHighBits=function(){return this.high},m.getHighBitsUnsigned=function(){return this.high>>>0},m.getLowBits=function(){return this.low},m.getLowBitsUnsigned=function(){return this.low>>>0},m.getNumBitsAbs=function(){if(this.isNegative())return this.eq(X)?64:this.neg().getNumBitsAbs();for(var u=this.high!=0?this.high:this.low,R=31;R>0&&!(u&1<<R);R--);return this.high!=0?R+33:R+1},m.isZero=function(){return this.high===0&&this.low===0},m.eqz=m.isZero,m.isNegative=function(){return!this.unsigned&&this.high<0},m.isPositive=function(){return this.unsigned||this.high>=0},m.isOdd=function(){return(this.low&1)===1},m.isEven=function(){return(this.low&1)===0},m.equals=function(u){return r(u)||(u=f(u)),this.unsigned!==u.unsigned&&this.high>>>31===1&&u.high>>>31===1?!1:this.high===u.high&&this.low===u.low},m.eq=m.equals,m.notEquals=function(u){return!this.eq(u)},m.neq=m.notEquals,m.ne=m.notEquals,m.lessThan=function(u){return this.comp(u)<0},m.lt=m.lessThan,m.lessThanOrEqual=function(u){return this.comp(u)<=0},m.lte=m.lessThanOrEqual,m.le=m.lessThanOrEqual,m.greaterThan=function(u){return this.comp(u)>0},m.gt=m.greaterThan,m.greaterThanOrEqual=function(u){return this.comp(u)>=0},m.gte=m.greaterThanOrEqual,m.ge=m.greaterThanOrEqual,m.compare=function(u){if(r(u)||(u=f(u)),this.eq(u))return 0;var R=this.isNegative(),G=u.isNegative();return R&&!G?-1:!R&&G?1:this.unsigned?u.high>>>0>this.high>>>0||u.high===this.high&&u.low>>>0>this.low>>>0?-1:1:this.sub(u).isNegative()?-1:1},m.comp=m.compare,m.negate=function(){return!this.unsigned&&this.eq(X)?X:this.not().add(M)},m.neg=m.negate,m.add=function(u){r(u)||(u=f(u));var R=this.high>>>16,G=this.high&65535,ne=this.low>>>16,Q=this.low&65535,ce=u.high>>>16,ee=u.high&65535,Fe=u.low>>>16,de=u.low&65535,oe=0,Re=0,fe=0,Be=0;return Be+=Q+de,fe+=Be>>>16,Be&=65535,fe+=ne+Fe,Re+=fe>>>16,fe&=65535,Re+=G+ee,oe+=Re>>>16,Re&=65535,oe+=R+ce,oe&=65535,c(fe<<16|Be,oe<<16|Re,this.unsigned)},m.subtract=function(u){return r(u)||(u=f(u)),this.add(u.neg())},m.sub=m.subtract,m.multiply=function(u){if(this.isZero())return this;if(r(u)||(u=f(u)),e){var R=e.mul(this.low,this.high,u.low,u.high);return c(R,e.get_high(),this.unsigned)}if(u.isZero())return this.unsigned?A:N;if(this.eq(X))return u.isOdd()?X:N;if(u.eq(X))return this.isOdd()?X:N;if(this.isNegative())return u.isNegative()?this.neg().mul(u.neg()):this.neg().mul(u).neg();if(u.isNegative())return this.mul(u.neg()).neg();if(this.lt(T)&&u.lt(T))return l(this.toNumber()*u.toNumber(),this.unsigned);var G=this.high>>>16,ne=this.high&65535,Q=this.low>>>16,ce=this.low&65535,ee=u.high>>>16,Fe=u.high&65535,de=u.low>>>16,oe=u.low&65535,Re=0,fe=0,Be=0,Qn=0;return Qn+=ce*oe,Be+=Qn>>>16,Qn&=65535,Be+=Q*oe,fe+=Be>>>16,Be&=65535,Be+=ce*de,fe+=Be>>>16,Be&=65535,fe+=ne*oe,Re+=fe>>>16,fe&=65535,fe+=Q*de,Re+=fe>>>16,fe&=65535,fe+=ce*Fe,Re+=fe>>>16,fe&=65535,Re+=G*oe+ne*de+Q*Fe+ce*ee,Re&=65535,c(Be<<16|Qn,Re<<16|fe,this.unsigned)},m.mul=m.multiply,m.divide=function(u){if(r(u)||(u=f(u)),u.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&u.low===-1&&u.high===-1)return this;var R=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,u.low,u.high);return c(R,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?A:N;var G,ne,Q;if(this.unsigned){if(u.unsigned||(u=u.toUnsigned()),u.gt(this))return A;if(u.gt(this.shru(1)))return L;Q=A}else{if(this.eq(X)){if(u.eq(M)||u.eq(V))return X;if(u.eq(X))return M;var ce=this.shr(1);return G=ce.div(u).shl(1),G.eq(N)?u.isNegative()?M:V:(ne=this.sub(u.mul(G)),Q=G.add(ne.div(u)),Q)}else if(u.eq(X))return this.unsigned?A:N;if(this.isNegative())return u.isNegative()?this.neg().div(u.neg()):this.neg().div(u).neg();if(u.isNegative())return this.div(u.neg()).neg();Q=N}for(ne=this;ne.gte(u);){G=Math.max(1,Math.floor(ne.toNumber()/u.toNumber()));for(var ee=Math.ceil(Math.log(G)/Math.LN2),Fe=ee<=48?1:h(2,ee-48),de=l(G),oe=de.mul(u);oe.isNegative()||oe.gt(ne);)G-=Fe,de=l(G,this.unsigned),oe=de.mul(u);de.isZero()&&(de=M),Q=Q.add(de),ne=ne.sub(oe)}return Q},m.div=m.divide,m.modulo=function(u){if(r(u)||(u=f(u)),e){var R=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,u.low,u.high);return c(R,e.get_high(),this.unsigned)}return this.sub(this.div(u).mul(u))},m.mod=m.modulo,m.rem=m.modulo,m.not=function(){return c(~this.low,~this.high,this.unsigned)},m.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},m.clz=m.countLeadingZeros,m.countTrailingZeros=function(){return this.low?i(this.low):i(this.high)+32},m.ctz=m.countTrailingZeros,m.and=function(u){return r(u)||(u=f(u)),c(this.low&u.low,this.high&u.high,this.unsigned)},m.or=function(u){return r(u)||(u=f(u)),c(this.low|u.low,this.high|u.high,this.unsigned)},m.xor=function(u){return r(u)||(u=f(u)),c(this.low^u.low,this.high^u.high,this.unsigned)},m.shiftLeft=function(u){return r(u)&&(u=u.toInt()),(u&=63)===0?this:u<32?c(this.low<<u,this.high<<u|this.low>>>32-u,this.unsigned):c(0,this.low<<u-32,this.unsigned)},m.shl=m.shiftLeft,m.shiftRight=function(u){return r(u)&&(u=u.toInt()),(u&=63)===0?this:u<32?c(this.low>>>u|this.high<<32-u,this.high>>u,this.unsigned):c(this.high>>u-32,this.high>=0?0:-1,this.unsigned)},m.shr=m.shiftRight,m.shiftRightUnsigned=function(u){return r(u)&&(u=u.toInt()),(u&=63)===0?this:u<32?c(this.low>>>u|this.high<<32-u,this.high>>>u,this.unsigned):u===32?c(this.high,0,this.unsigned):c(this.high>>>u-32,0,this.unsigned)},m.shru=m.shiftRightUnsigned,m.shr_u=m.shiftRightUnsigned,m.rotateLeft=function(u){var R;return r(u)&&(u=u.toInt()),(u&=63)===0?this:u===32?c(this.high,this.low,this.unsigned):u<32?(R=32-u,c(this.low<<u|this.high>>>R,this.high<<u|this.low>>>R,this.unsigned)):(u-=32,R=32-u,c(this.high<<u|this.low>>>R,this.low<<u|this.high>>>R,this.unsigned))},m.rotl=m.rotateLeft,m.rotateRight=function(u){var R;return r(u)&&(u=u.toInt()),(u&=63)===0?this:u===32?c(this.high,this.low,this.unsigned):u<32?(R=32-u,c(this.high<<R|this.low>>>u,this.low<<R|this.high>>>u,this.unsigned)):(u-=32,R=32-u,c(this.low<<R|this.high>>>u,this.high<<R|this.low>>>u,this.unsigned))},m.rotr=m.rotateRight,m.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},m.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},m.toBytes=function(u){return u?this.toBytesLE():this.toBytesBE()},m.toBytesLE=function(){var u=this.high,R=this.low;return[R&255,R>>>8&255,R>>>16&255,R>>>24,u&255,u>>>8&255,u>>>16&255,u>>>24]},m.toBytesBE=function(){var u=this.high,R=this.low;return[u>>>24,u>>>16&255,u>>>8&255,u&255,R>>>24,R>>>16&255,R>>>8&255,R&255]},n.fromBytes=function(u,R,G){return G?n.fromBytesLE(u,R):n.fromBytesBE(u,R)},n.fromBytesLE=function(u,R){return new n(u[0]|u[1]<<8|u[2]<<16|u[3]<<24,u[4]|u[5]<<8|u[6]<<16|u[7]<<24,R)},n.fromBytesBE=function(u,R){return new n(u[4]<<24|u[5]<<16|u[6]<<8|u[7],u[0]<<24|u[1]<<16|u[2]<<8|u[3],R)};var se=n;return t.default=se,"default"in t?t.default:t}({});typeof define=="function"&&define.amd?define([],function(){return $y}):typeof Mu=="object"&&typeof Wy=="object"&&(Mu.exports=$y)});var Bu=g(Me=>{"use strict";Object.defineProperty(Me,"__esModule",{value:!0});Me.loadFileDescriptorSetFromObject=Me.loadFileDescriptorSetFromBuffer=Me.fromJSON=Me.loadSync=Me.load=Me.isAnyExtension=Me.Long=void 0;var f_=Mg(),Pt=Vo(),Lu=Fy(),Fu=jy(),p_=Ky();Me.Long=p_;function g_(t){return"@type"in t&&typeof t["@type"]=="string"}Me.isAnyExtension=g_;var Yy={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function m_(t,e){return t===""?e:t+"."+e}function y_(t){return t instanceof Pt.Service||t instanceof Pt.Type||t instanceof Pt.Enum}function v_(t){return t instanceof Pt.Namespace||t instanceof Pt.Root}function Xy(t,e){let n=m_(e,t.name);return y_(t)?[[n,t]]:v_(t)&&typeof t.nested<"u"?Object.keys(t.nested).map(r=>Xy(t.nested[r],n)).reduce((r,i)=>r.concat(i),[]):[]}function Hy(t,e){return function(r){return t.toObject(t.decode(r),e)}}function Qy(t){return function(n){if(Array.isArray(n))throw new Error(`Failed to serialize message: expected object with ${t.name} structure, got array instead`);let r=t.fromObject(n);return t.encode(r).finish()}}function S_(t,e,n,r){let i=t.resolvedRequestType,s=t.resolvedResponseType;return{path:"/"+e+"/"+t.name,requestStream:!!t.requestStream,responseStream:!!t.responseStream,requestSerialize:Qy(i),requestDeserialize:Hy(i,n),responseSerialize:Qy(s),responseDeserialize:Hy(s,n),originalName:f_(t.name),requestType:Pu(i,r),responseType:Pu(s,r)}}function T_(t,e,n,r){let i={};for(let s of t.methodsArray)i[s.name]=S_(s,e,n,r);return i}function Pu(t,e){let n=t.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:n.$type.toObject(n,Yy),fileDescriptorProtos:e}}function E_(t,e){let n=t.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:n.$type.toObject(n,Yy),fileDescriptorProtos:e}}function w_(t,e,n,r){if(t instanceof Pt.Service)return T_(t,e,n,r);if(t instanceof Pt.Type)return Pu(t,r);if(t instanceof Pt.Enum)return E_(t,r);throw new Error("Type mismatch in reflection object handling")}function jo(t,e){let n={};t.resolveAll();let i=t.toDescriptor("proto3").file.map(s=>Buffer.from(Lu.FileDescriptorProto.encode(s).finish()));for(let[s,o]of Xy(t,""))n[s]=w_(o,s,e,i);return n}function Jy(t,e){e=e||{};let n=Pt.Root.fromDescriptor(t);return n.resolveAll(),jo(n,e)}function C_(t,e){return(0,Fu.loadProtosWithOptions)(t,e).then(n=>jo(n,e))}Me.load=C_;function __(t,e){let n=(0,Fu.loadProtosWithOptionsSync)(t,e);return jo(n,e)}Me.loadSync=__;function b_(t,e){e=e||{};let n=Pt.Root.fromJSON(t);return n.resolveAll(),jo(n,e)}Me.fromJSON=b_;function I_(t,e){let n=Lu.FileDescriptorSet.decode(t);return Jy(n,e)}Me.loadFileDescriptorSetFromBuffer=I_;function A_(t,e){let n=Lu.FileDescriptorSet.fromObject(t);return Jy(n,e)}Me.loadFileDescriptorSetFromObject=A_;(0,Fu.addCommonProtos)()});var jn=g(re=>{"use strict";Object.defineProperty(re,"__esModule",{value:!0});re.setup=re.getChannelzServiceDefinition=re.getChannelzHandlers=re.unregisterChannelzRef=re.registerChannelzSocket=re.registerChannelzServer=re.registerChannelzSubchannel=re.registerChannelzChannel=re.ChannelzCallTracker=re.ChannelzChildrenTracker=re.ChannelzTrace=void 0;var Zy=K("net"),Ui=et(),zi=$(),R_=It(),D_=uo(),N_=Pc();function qu(t){return{channel_id:t.id,name:t.name}}function Gu(t){return{subchannel_id:t.id,name:t.name}}function k_(t){return{server_id:t.id}}function Wo(t){return{socket_id:t.id,name:t.name}}var ev=32,Uu=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,n,r){let i=new Date;this.events.push({description:n,severity:e,timestamp:i,childChannel:r?.kind==="channel"?r:void 0,childSubchannel:r?.kind==="subchannel"?r:void 0}),this.events.length>=ev*2&&(this.events=this.events.slice(ev)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:Qt(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:Qt(e.timestamp),channel_ref:e.childChannel?qu(e.childChannel):null,subchannel_ref:e.childSubchannel?Gu(e.childSubchannel):null}))}}};re.ChannelzTrace=Uu;var Vu=class{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var n,r,i;switch(e.kind){case"channel":{let s=(n=this.channelChildren.get(e.id))!==null&&n!==void 0?n:{ref:e,count:0};s.count+=1,this.channelChildren.set(e.id,s);break}case"subchannel":{let s=(r=this.subchannelChildren.get(e.id))!==null&&r!==void 0?r:{ref:e,count:0};s.count+=1,this.subchannelChildren.set(e.id,s);break}case"socket":{let s=(i=this.socketChildren.get(e.id))!==null&&i!==void 0?i:{ref:e,count:0};s.count+=1,this.socketChildren.set(e.id,s);break}}}unrefChild(e){switch(e.kind){case"channel":{let n=this.channelChildren.get(e.id);n!==void 0&&(n.count-=1,n.count===0?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,n));break}case"subchannel":{let n=this.subchannelChildren.get(e.id);n!==void 0&&(n.count-=1,n.count===0?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,n));break}case"socket":{let n=this.socketChildren.get(e.id);n!==void 0&&(n.count-=1,n.count===0?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,n));break}}}getChildLists(){let e=[];for(let{ref:i}of this.channelChildren.values())e.push(i);let n=[];for(let{ref:i}of this.subchannelChildren.values())n.push(i);let r=[];for(let{ref:i}of this.socketChildren.values())r.push(i);return{channels:e,subchannels:n,sockets:r}}};re.ChannelzChildrenTracker=Vu;var zu=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};re.ChannelzCallTracker=zu;var O_=1;function Ko(){return O_++}var Vi=[],ju=[],En=[],$u=[];function x_(t,e,n){let r=Ko(),i={id:r,name:t,kind:"channel"};return n&&(Vi[r]={ref:i,getInfo:e}),i}re.registerChannelzChannel=x_;function M_(t,e,n){let r=Ko(),i={id:r,name:t,kind:"subchannel"};return n&&(ju[r]={ref:i,getInfo:e}),i}re.registerChannelzSubchannel=M_;function P_(t,e){let n=Ko(),r={id:n,kind:"server"};return e&&(En[n]={ref:r,getInfo:t}),r}re.registerChannelzServer=P_;function L_(t,e,n){let r=Ko(),i={id:r,name:t,kind:"socket"};return n&&($u[r]={ref:i,getInfo:e}),i}re.registerChannelzSocket=L_;function F_(t){switch(t.kind){case"channel":delete Vi[t.id];return;case"subchannel":delete ju[t.id];return;case"server":delete En[t.id];return;case"socket":delete $u[t.id];return}}re.unregisterChannelzRef=F_;function B_(t){let e=Number.parseInt(t,16);return[e/256|0,e%256]}function tv(t){if(t==="")return[];let e=t.split(":").map(r=>B_(r));return[].concat(...e)}function q_(t){if((0,Zy.isIPv4)(t))return Buffer.from(Uint8Array.from(t.split(".").map(e=>Number.parseInt(e))));if((0,Zy.isIPv6)(t)){let e,n,r=t.indexOf("::");r===-1?(e=t,n=""):(e=t.substring(0,r),n=t.substring(r+2));let i=Buffer.from(tv(e)),s=Buffer.from(tv(n)),o=Buffer.alloc(16-i.length-s.length,0);return Buffer.concat([i,o,s])}else return null}function rv(t){switch(t){case Ui.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case Ui.ConnectivityState.IDLE:return{state:"IDLE"};case Ui.ConnectivityState.READY:return{state:"READY"};case Ui.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case Ui.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function Qt(t){if(!t)return null;let e=t.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function iv(t){let e=t.getInfo();return{ref:qu(t.ref),data:{target:e.target,state:rv(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Qt(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:e.children.channels.map(n=>qu(n)),subchannel_ref:e.children.subchannels.map(n=>Gu(n))}}function U_(t,e){let n=Number.parseInt(t.request.channel_id),r=Vi[n];if(r===void 0){e({code:zi.Status.NOT_FOUND,details:"No channel data found for id "+n});return}e(null,{channel:iv(r)})}function V_(t,e){let n=Number.parseInt(t.request.max_results),r=[],i=Number.parseInt(t.request.start_channel_id);for(;i<Vi.length;i++){let s=Vi[i];if(s!==void 0&&(r.push(iv(s)),r.length>=n))break}e(null,{channel:r,end:i>=En.length})}function sv(t){let e=t.getInfo();return{ref:k_(t.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:Qt(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:e.listenerChildren.sockets.map(n=>Wo(n))}}function z_(t,e){let n=Number.parseInt(t.request.server_id),r=En[n];if(r===void 0){e({code:zi.Status.NOT_FOUND,details:"No server data found for id "+n});return}e(null,{server:sv(r)})}function G_(t,e){let n=Number.parseInt(t.request.max_results),r=[],i=Number.parseInt(t.request.start_server_id);for(;i<En.length;i++){let s=En[i];if(s!==void 0&&(r.push(sv(s)),r.length>=n))break}e(null,{server:r,end:i>=En.length})}function j_(t,e){let n=Number.parseInt(t.request.subchannel_id),r=ju[n];if(r===void 0){e({code:zi.Status.NOT_FOUND,details:"No subchannel data found for id "+n});return}let i=r.getInfo(),s={ref:Gu(r.ref),data:{target:i.target,state:rv(i.state),calls_started:i.callTracker.callsStarted,calls_succeeded:i.callTracker.callsSucceeded,calls_failed:i.callTracker.callsFailed,last_call_started_timestamp:Qt(i.callTracker.lastCallStartedTimestamp),trace:i.trace.getTraceMessage()},socket_ref:i.children.sockets.map(o=>Wo(o))};e(null,{subchannel:s})}function nv(t){var e;return(0,R_.isTcpSubchannelAddress)(t)?{address:"tcpip_address",tcpip_address:{ip_address:(e=q_(t.host))!==null&&e!==void 0?e:void 0,port:t.port}}:{address:"uds_address",uds_address:{filename:t.path}}}function $_(t,e){var n,r,i,s,o;let a=Number.parseInt(t.request.socket_id),l=$u[a];if(l===void 0){e({code:zi.Status.NOT_FOUND,details:"No socket data found for id "+a});return}let c=l.getInfo(),h=c.security?{model:"tls",tls:{cipher_suite:c.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(n=c.security.cipherSuiteStandardName)!==null&&n!==void 0?n:void 0,other_name:(r=c.security.cipherSuiteOtherName)!==null&&r!==void 0?r:void 0,local_certificate:(i=c.security.localCertificate)!==null&&i!==void 0?i:void 0,remote_certificate:(s=c.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,d={ref:Wo(l.ref),local:c.localAddress?nv(c.localAddress):null,remote:c.remoteAddress?nv(c.remoteAddress):null,remote_name:(o=c.remoteName)!==null&&o!==void 0?o:void 0,security:h,data:{keep_alives_sent:c.keepAlivesSent,streams_started:c.streamsStarted,streams_succeeded:c.streamsSucceeded,streams_failed:c.streamsFailed,last_local_stream_created_timestamp:Qt(c.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:Qt(c.lastRemoteStreamCreatedTimestamp),messages_received:c.messagesReceived,messages_sent:c.messagesSent,last_message_received_timestamp:Qt(c.lastMessageReceivedTimestamp),last_message_sent_timestamp:Qt(c.lastMessageSentTimestamp),local_flow_control_window:c.localFlowControlWindow?{value:c.localFlowControlWindow}:null,remote_flow_control_window:c.remoteFlowControlWindow?{value:c.remoteFlowControlWindow}:null}};e(null,{socket:d})}function W_(t,e){let n=Number.parseInt(t.request.server_id),r=En[n];if(r===void 0){e({code:zi.Status.NOT_FOUND,details:"No server data found for id "+n});return}let i=Number.parseInt(t.request.start_socket_id),s=Number.parseInt(t.request.max_results),a=r.getInfo().sessionChildren.sockets.sort((h,d)=>h.id-d.id),l=[],c=0;for(;c<a.length&&!(a[c].id>=i&&(l.push(Wo(a[c])),l.length>=s));c++);e(null,{socket_ref:l,end:c>=a.length})}function ov(){return{GetChannel:U_,GetTopChannels:V_,GetServer:z_,GetServers:G_,GetSubchannel:j_,GetSocket:$_,GetServerSockets:W_}}re.getChannelzHandlers=ov;var $o=null;function av(){if($o)return $o;let t=Bu().loadSync,e=t("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return $o=(0,N_.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,$o}re.getChannelzServiceDefinition=av;function K_(){(0,D_.registerAdminService)(av,ov)}re.setup=K_});var lv=g(Qo=>{"use strict";Object.defineProperty(Qo,"__esModule",{value:!0});Qo.Subchannel=void 0;var Z=et(),H_=Ei(),Wu=le(),Ho=$(),Q_=Qe(),Y_=It(),Nr=jn(),X_="subchannel",J_=~(1<<31),Ku=class{constructor(e,n,r,i,s){var o;this.channelTarget=e,this.subchannelAddress=n,this.options=r,this.credentials=i,this.connector=s,this.connectivityState=Z.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new Nr.ChannelzCallTracker,this.childrenTracker=new Nr.ChannelzChildrenTracker,this.streamTracker=new Nr.ChannelzCallTracker;let a={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new H_.BackoffTimeout(()=>{this.handleBackoffTimer()},a),this.backoffTimeout.unref(),this.subchannelAddressString=(0,Y_.subchannelAddressToString)(n),this.keepaliveTime=(o=r["grpc.keepalive_time_ms"])!==null&&o!==void 0?o:-1,r["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new Nr.ChannelzTrace,this.channelzRef=(0,Nr.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(r,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){Wu.trace(Ho.LogVerbosity.DEBUG,X_,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){Wu.trace(Ho.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([Z.ConnectivityState.TRANSIENT_FAILURE],Z.ConnectivityState.CONNECTING):this.transitionToState([Z.ConnectivityState.TRANSIENT_FAILURE],Z.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let n=Math.min(this.keepaliveTime,J_);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":n})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(n=>{this.transitionToState([Z.ConnectivityState.CONNECTING],Z.ConnectivityState.READY)&&(this.transport=n,this.channelzEnabled&&this.childrenTracker.refChild(n.getChannelzRef()),n.addDisconnectListener(r=>{this.transitionToState([Z.ConnectivityState.READY],Z.ConnectivityState.IDLE),r&&this.keepaliveTime>0&&(this.keepaliveTime*=2,Wu.log(Ho.LogVerbosity.ERROR,`Connection to ${(0,Q_.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))}))},n=>{this.transitionToState([Z.ConnectivityState.CONNECTING],Z.ConnectivityState.TRANSIENT_FAILURE,`${n}`)})}transitionToState(e,n,r){var i,s;if(e.indexOf(this.connectivityState)===-1)return!1;this.trace(Z.ConnectivityState[this.connectivityState]+" -> "+Z.ConnectivityState[n]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Z.ConnectivityState[n]);let o=this.connectivityState;switch(this.connectivityState=n,n){case Z.ConnectivityState.READY:this.stopBackoff();break;case Z.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case Z.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(i=this.transport)===null||i===void 0||i.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case Z.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(s=this.transport)===null||s===void 0||s.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${n}`)}for(let a of this.stateListeners)a(this,o,n,this.keepaliveTime,r);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,Nr.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([Z.ConnectivityState.CONNECTING,Z.ConnectivityState.READY],Z.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,n,r,i){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let s;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),s={onCallEnd:o=>{o.code===Ho.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):s={},this.transport.createCall(e,n,r,i,s)}startConnecting(){process.nextTick(()=>{this.transitionToState([Z.ConnectivityState.IDLE],Z.ConnectivityState.CONNECTING)||this.connectivityState===Z.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([Z.ConnectivityState.TRANSIENT_FAILURE],Z.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}};Qo.Subchannel=Ku});var Xu=g(_n=>{"use strict";Object.defineProperty(_n,"__esModule",{value:!0});_n.setup=_n.DEFAULT_PORT=void 0;var cv=_t(),hv=K("dns"),dv=K("util"),Z_=lc(),Hu=$(),Qu=Ve(),eb=le(),tb=$(),wn=Qe(),uv=K("net"),nb=Ei(),rb="dns_resolver";function Cn(t){eb.trace(tb.LogVerbosity.DEBUG,rb,t)}_n.DEFAULT_PORT=443;var ib=3e4,sb=dv.promisify(hv.resolveTxt),ob=dv.promisify(hv.lookup);function ab(...t){let e=[];for(let n=0;n<Math.max.apply(null,t.map(r=>r.length));n++)for(let r of t)n<r.length&&e.push(r[n]);return e}var Yu=class{constructor(e,n,r){var i,s,o;this.target=e,this.listener=n,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,Cn("Resolver constructed for target "+(0,wn.uriToString)(e));let a=(0,wn.splitHostPort)(e.path);a===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,uv.isIPv4)(a.host)||(0,uv.isIPv6)(a.host)?(this.ipResult=[{host:a.host,port:(i=a.port)!==null&&i!==void 0?i:_n.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=a.host,this.port=(s=a.port)!==null&&s!==void 0?s:_n.DEFAULT_PORT),this.percentage=Math.random()*100,r["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:Hu.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,wn.uriToString)(this.target)}`,metadata:new Qu.Metadata};let l={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoff=new nb.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},l),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(o=r["grpc.dns_min_time_between_resolutions_ms"])!==null&&o!==void 0?o:ib,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(Cn("Returning IP address for target "+(0,wn.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)Cn("Failed to parse DNS address "+(0,wn.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:Hu.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,wn.uriToString)(this.target)}`,metadata:new Qu.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;Cn("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=ob(e,{all:!0}),this.pendingLookupPromise.then(n=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let r=n.filter(o=>o.family===4),i=n.filter(o=>o.family===6);this.latestLookupResult=ab(i,r).map(o=>({host:o.address,port:+this.port}));let s="["+this.latestLookupResult.map(o=>o.host+":"+o.port).join(",")+"]";if(Cn("Resolved addresses for target "+(0,wn.uriToString)(this.target)+": "+s),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},n=>{this.pendingLookupPromise!==null&&(Cn("Resolution error for target "+(0,wn.uriToString)(this.target)+": "+n.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=sb(e),this.pendingTxtPromise.then(n=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,Z_.extractAndSelectServiceConfig)(n,this.percentage)}catch(r){this.latestServiceConfigError={code:Hu.Status.UNAVAILABLE,details:`Parsing service config failed with error ${r.message}`,metadata:new Qu.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},n=>{}))}}startNextResolutionTimer(){var e,n;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=(n=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)===null||n===void 0?void 0:n.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?Cn('resolution update delayed by "min time between resolutions" rate limit'):Cn("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function lb(){(0,cv.registerResolver)("dns",Yu),(0,cv.registerDefaultScheme)("dns")}_n.setup=lb});var Ju=g(xr=>{"use strict";Object.defineProperty(xr,"__esModule",{value:!0});xr.getProxiedConnection=xr.mapProxyName=void 0;var Gi=le(),kr=$(),cb=_t(),ub=K("http"),hb=K("tls"),db=le(),fv=It(),Or=Qe(),fb=K("url"),pb=Xu(),gb="proxy";function bn(t){db.trace(kr.LogVerbosity.DEBUG,gb,t)}function mb(){let t="",e="";if(process.env.grpc_proxy)e="grpc_proxy",t=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",t=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",t=process.env.http_proxy;else return{};let n;try{n=new fb.URL(t)}catch{return(0,Gi.log)(kr.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(n.protocol!=="http:")return(0,Gi.log)(kr.LogVerbosity.ERROR,`"${n.protocol}" scheme not supported in proxy URI`),{};let r=null;n.username&&(n.password?((0,Gi.log)(kr.LogVerbosity.INFO,"userinfo found in proxy URI"),r=`${n.username}:${n.password}`):r=n.username);let i=n.hostname,s=n.port;s===""&&(s="80");let o={address:`${i}:${s}`};return r&&(o.creds=r),bn("Proxy server "+o.address+" set by environment variable "+e),o}function yb(){let t=process.env.no_grpc_proxy,e="no_grpc_proxy";return t||(t=process.env.no_proxy,e="no_proxy"),t?(bn("No proxy server list set by environment variable "+e),t.split(",")):[]}function vb(t,e){var n;let r={target:t,extraOptions:{}};if(((n=e["grpc.enable_http_proxy"])!==null&&n!==void 0?n:1)===0||t.scheme==="unix")return r;let i=mb();if(!i.address)return r;let s=(0,Or.splitHostPort)(t.path);if(!s)return r;let o=s.host;for(let l of yb())if(l===o)return bn("Not using proxy for target in no_proxy list: "+(0,Or.uriToString)(t)),r;let a={"grpc.http_connect_target":(0,Or.uriToString)(t)};return i.creds&&(a["grpc.http_connect_creds"]=i.creds),{target:{scheme:"dns",path:i.address},extraOptions:a}}xr.mapProxyName=vb;function Sb(t,e,n){var r;if(!("grpc.http_connect_target"in e))return Promise.resolve({});let i=e["grpc.http_connect_target"],s=(0,Or.parseUri)(i);if(s===null)return Promise.resolve({});let o=(0,Or.splitHostPort)(s.path);if(o===null)return Promise.resolve({});let a=`${o.host}:${(r=o.port)!==null&&r!==void 0?r:pb.DEFAULT_PORT}`,l={method:"CONNECT",path:a},c={Host:a};(0,fv.isTcpSubchannelAddress)(t)?(l.host=t.host,l.port=t.port):l.socketPath=t.path,"grpc.http_connect_creds"in e&&(c["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),l.headers=c;let h=(0,fv.subchannelAddressToString)(t);return bn("Using proxy "+h+" to connect to "+l.path),new Promise((d,f)=>{let p=ub.request(l);p.once("connect",(y,S,C)=>{var _;if(p.removeAllListeners(),S.removeAllListeners(),y.statusCode===200)if(bn("Successfully connected to "+l.path+" through proxy "+h),"secureContext"in n){let T=(0,cb.getDefaultAuthority)(s),N=(0,Or.splitHostPort)(T),A=(_=N?.host)!==null&&_!==void 0?_:T,M=hb.connect(Object.assign({host:A,servername:A,socket:S},n),()=>{bn("Successfully established a TLS connection to "+l.path+" through proxy "+h),d({socket:M,realTarget:s})});M.on("error",L=>{bn("Failed to establish a TLS connection to "+l.path+" through proxy "+h+" with error "+L.message),f()})}else bn("Successfully established a plaintext connection to "+l.path+" through proxy "+h),d({socket:S,realTarget:s});else(0,Gi.log)(kr.LogVerbosity.ERROR,"Failed to connect to "+l.path+" through proxy "+h+" with status "+y.statusCode),f()}),p.once("error",y=>{p.removeAllListeners(),(0,Gi.log)(kr.LogVerbosity.ERROR,"Failed to connect to proxy "+h+" with error "+y.message),f()}),p.end()})}xr.getProxiedConnection=Sb});var eh=g(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.StreamDecoder=void 0;var Yt=function(t){return t[t.NO_DATA=0]="NO_DATA",t[t.READING_SIZE=1]="READING_SIZE",t[t.READING_MESSAGE=2]="READING_MESSAGE",t}(Yt||{}),Zu=class{constructor(){this.readState=Yt.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let n=0,r,i=[];for(;n<e.length;)switch(this.readState){case Yt.NO_DATA:this.readCompressFlag=e.slice(n,n+1),n+=1,this.readState=Yt.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case Yt.READING_SIZE:if(r=Math.min(e.length-n,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,n,n+r),this.readSizeRemaining-=r,n+=r,this.readSizeRemaining===0)if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=Yt.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=Yt.NO_DATA,i.push(s)}break;case Yt.READING_MESSAGE:if(r=Math.min(e.length-n,this.readMessageRemaining),this.readPartialMessage.push(e.slice(n,n+r)),this.readMessageRemaining-=r,n+=r,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),o=Buffer.concat(s,this.readMessageSize+5);this.readState=Yt.NO_DATA,i.push(o)}break;default:throw new Error("Unexpected read state")}return i}};Yo.StreamDecoder=Zu});var pv=g(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});Xo.Http2SubchannelCall=void 0;var Xt=K("http2"),Tb=K("os"),Y=$(),In=Ve(),Eb=eh(),wb=le(),Cb=$(),_b="subchannel_call";function bb(t){for(let[e,n]of Object.entries(Tb.constants.errno))if(n===t)return e;return"Unknown system error "+t}var th=class{constructor(e,n,r,i,s){this.http2Stream=e,this.callEventTracker=n,this.listener=r,this.transport=i,this.callId=s,this.decoder=new Eb.StreamDecoder,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=Y.Status.UNKNOWN,this.finalStatus=null,this.internalError=null,e.on("response",(o,a)=>{let l="";for(let c of Object.keys(o))l+="		"+c+": "+o[c]+`
`;switch(this.trace(`Received server headers:
`+l),o[":status"]){case 400:this.mappedStatusCode=Y.Status.INTERNAL;break;case 401:this.mappedStatusCode=Y.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=Y.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=Y.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=Y.Status.UNAVAILABLE;break;default:this.mappedStatusCode=Y.Status.UNKNOWN}if(a&Xt.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(o);else{let c;try{c=In.Metadata.fromHttp2Headers(o)}catch(h){this.endCall({code:Y.Status.UNKNOWN,details:h.message,metadata:new In.Metadata});return}this.listener.onReceiveMetadata(c)}}),e.on("trailers",o=>{this.handleTrailers(o)}),e.on("data",o=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+o.length);let a=this.decoder.write(o);for(let l of a)this.trace("parsed message of length "+l.length),this.callEventTracker.addMessageReceived(),this.tryPush(l)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var o;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((o=this.finalStatus)===null||o===void 0?void 0:o.code)===Y.Status.OK)return;let a,l="";switch(e.rstCode){case Xt.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;a=Y.Status.INTERNAL,l=`Received RST_STREAM with code ${e.rstCode}`;break;case Xt.constants.NGHTTP2_REFUSED_STREAM:a=Y.Status.UNAVAILABLE,l="Stream refused by server";break;case Xt.constants.NGHTTP2_CANCEL:a=Y.Status.CANCELLED,l="Call cancelled";break;case Xt.constants.NGHTTP2_ENHANCE_YOUR_CALM:a=Y.Status.RESOURCE_EXHAUSTED,l="Bandwidth exhausted or memory limit exceeded";break;case Xt.constants.NGHTTP2_INADEQUATE_SECURITY:a=Y.Status.PERMISSION_DENIED,l="Protocol not secure enough";break;case Xt.constants.NGHTTP2_INTERNAL_ERROR:a=Y.Status.INTERNAL,this.internalError===null?l=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(a=Y.Status.UNAVAILABLE,l=this.internalError.message):l=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:a=Y.Status.INTERNAL,l=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:a,details:l,metadata:new In.Metadata,rstCode:e.rstCode})})}),e.on("error",o=>{o.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+o.message+" code="+o.code+" errno="+bb(o.errno)+" syscall="+o.syscall),this.internalError=o),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:Y.Status.UNAVAILABLE,details:"Connection dropped",metadata:new In.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){wb.trace(Cb.LogVerbosity.DEBUG,_b,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===Y.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==Y.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.callEventTracker.onStreamEnd(!0);let n="";for(let l of Object.keys(e))n+="		"+l+": "+e[l]+`
`;this.trace(`Received server trailers:
`+n);let r;try{r=In.Metadata.fromHttp2Headers(e)}catch{r=new In.Metadata}let i=r.getMap(),s=this.mappedStatusCode;if(s===Y.Status.UNKNOWN&&typeof i["grpc-status"]=="string"){let l=Number(i["grpc-status"]);l in Y.Status&&(s=l,this.trace("received status code "+l+" from server")),r.remove("grpc-status")}let o="";if(typeof i["grpc-message"]=="string"){try{o=decodeURI(i["grpc-message"])}catch{o=i["grpc-message"]}r.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}let a={code:s,details:o,metadata:r};this.endCall(a)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let n;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===Y.Status.OK?n=Xt.constants.NGHTTP2_NO_ERROR:n=Xt.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+n),this.http2Stream.close(n)}}cancelWithStatus(e,n){this.trace("cancelWithStatus code: "+e+' details: "'+n+'"'),this.endCall({code:e,details:n,metadata:new In.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==Y.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,n){this.trace("write() called with message of length "+n.length);let r=i=>{process.nextTick(()=>{var s;let o=Y.Status.UNAVAILABLE;i?.code==="ERR_STREAM_WRITE_AFTER_END"&&(o=Y.Status.INTERNAL),i&&this.cancelWithStatus(o,`Write error: ${i.message}`),(s=e.callback)===null||s===void 0||s.call(e)})};this.trace("sending data chunk of length "+n.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(n,r)}catch(i){this.endCall({code:Y.Status.UNAVAILABLE,details:`Write failed with error ${i.message}`,metadata:new In.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};Xo.Http2SubchannelCall=th});var nh=g(Jo=>{"use strict";Object.defineProperty(Jo,"__esModule",{value:!0});Jo.getNextCallNumber=void 0;var Ib=0;function Ab(){return Ib++}Jo.getNextCallNumber=Ab});var yv=g(ea=>{"use strict";Object.defineProperty(ea,"__esModule",{value:!0});ea.Http2SubchannelConnector=void 0;var ah=K("http2"),gv=K("tls"),rh=jn(),ji=$(),Rb=Ju(),Pr=le(),mv=_t(),Zo=It(),Mr=Qe(),Db=K("net"),Nb=pv(),kb=nh(),ih="transport",Ob="transport_flowctrl",xb=jl().version,{HTTP2_HEADER_AUTHORITY:Mb,HTTP2_HEADER_CONTENT_TYPE:Pb,HTTP2_HEADER_METHOD:Lb,HTTP2_HEADER_PATH:Fb,HTTP2_HEADER_TE:Bb,HTTP2_HEADER_USER_AGENT:qb}=ah.constants,Ub=2e4,Vb=Buffer.from("too_many_pings","ascii"),sh=class{constructor(e,n,r,i){this.session=e,this.remoteName=i,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=Ub,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new rh.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,Zo.subchannelAddressToString)(n),r["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,rh.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[r["grpc.primary_user_agent"],`grpc-node-js/${xb}`,r["grpc.secondary_user_agent"]].filter(s=>s).join(" "),"grpc.keepalive_time_ms"in r&&(this.keepaliveTimeMs=r["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in r&&(this.keepaliveTimeoutMs=r["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in r?this.keepaliveWithoutCalls=r["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(s,o,a)=>{let l=!1;s===ah.constants.NGHTTP2_ENHANCE_YOUR_CALM&&a&&a.equals(Vb)&&(l=!0),this.trace("connection closed by GOAWAY with code "+s+" and data "+a?.toString()),this.reportDisconnectToOwner(l)}),e.once("error",s=>{this.trace("connection closed with error "+s.message)}),Pr.isTracerEnabled(ih)&&(e.on("remoteSettings",s=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))}),e.on("localSettings",s=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,n,r;let i=this.session.socket,s=i.remoteAddress?(0,Zo.stringToSubchannelAddress)(i.remoteAddress,i.remotePort):null,o=i.localAddress?(0,Zo.stringToSubchannelAddress)(i.localAddress,i.localPort):null,a;if(this.session.encrypted){let c=i,h=c.getCipher(),d=c.getCertificate(),f=c.getPeerCertificate();a={cipherSuiteStandardName:(e=h.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:h.standardName?null:h.name,localCertificate:d&&"raw"in d?d.raw:null,remoteCertificate:f&&"raw"in f?f.raw:null}}else a=null;return{remoteAddress:s,localAddress:o,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(n=this.session.state.localWindowSize)!==null&&n!==void 0?n:null,remoteFlowControlWindow:(r=this.session.state.remoteWindowSize)!==null&&r!==void 0?r:null}}trace(e){Pr.trace(ji.LogVerbosity.DEBUG,ih,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){Pr.trace(ji.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){Pr.trace(ji.LogVerbosity.DEBUG,Ob,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){Pr.trace(ji.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(n=>n(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,n;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(n=(e=this.keepaliveTimeoutId).unref)===null||n===void 0||n.call(e));try{this.session.ping((r,i,s)=>{r&&(this.keepaliveTrace("Ping failed with error "+r.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch{this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,n;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):!this.keepaliveTimerId&&!this.keepaliveTimeoutId&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=(n=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)===null||n===void 0?void 0:n.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,n,r,i,s){let o=e.toHttp2Headers();o[Mb]=n,o[qb]=this.userAgent,o[Pb]="application/grpc",o[Lb]="POST",o[Fb]=r,o[Bb]="trailers";let a;try{a=this.session.request(o)}catch(h){throw this.handleDisconnect(),h}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let l,c;return this.channelzEnabled?(this.streamTracker.addCallStarted(),l={addMessageSent:()=>{var h;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(h=s.addMessageSent)===null||h===void 0||h.call(s)},addMessageReceived:()=>{var h;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(h=s.addMessageReceived)===null||h===void 0||h.call(s)},onCallEnd:h=>{var d;(d=s.onCallEnd)===null||d===void 0||d.call(s,h),this.removeActiveCall(c)},onStreamEnd:h=>{var d;h?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(d=s.onStreamEnd)===null||d===void 0||d.call(s,h)}}):l={addMessageSent:()=>{var h;(h=s.addMessageSent)===null||h===void 0||h.call(s)},addMessageReceived:()=>{var h;(h=s.addMessageReceived)===null||h===void 0||h.call(s)},onCallEnd:h=>{var d;(d=s.onCallEnd)===null||d===void 0||d.call(s,h),this.removeActiveCall(c)},onStreamEnd:h=>{var d;(d=s.onStreamEnd)===null||d===void 0||d.call(s,h)}},c=new Nb.Http2SubchannelCall(a,l,i,this,(0,kb.getNextCallNumber)()),this.addActiveCall(c),c}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}shutdown(){this.session.close(),(0,rh.unregisterChannelzRef)(this.channelzRef)}},oh=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){Pr.trace(ji.LogVerbosity.DEBUG,ih,(0,Mr.uriToString)(this.channelTarget)+" "+e)}createSession(e,n,r,i){return this.isShutdown?Promise.reject():new Promise((s,o)=>{var a,l,c;let h;i.realTarget?(h=(0,Mr.uriToString)(i.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,Mr.uriToString)(i.realTarget))):(h=null,this.trace("creating HTTP/2 session to "+(0,Zo.subchannelAddressToString)(e)));let d=(0,mv.getDefaultAuthority)((a=i.realTarget)!==null&&a!==void 0?a:this.channelTarget),f=n._getConnectionOptions()||{};f.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in r?f.maxSessionMemory=r["grpc-node.max_session_memory"]:f.maxSessionMemory=Number.MAX_SAFE_INTEGER;let p="http://";if("secureContext"in f){if(p="https://",r["grpc.ssl_target_name_override"]){let C=r["grpc.ssl_target_name_override"];f.checkServerIdentity=(_,T)=>(0,gv.checkServerIdentity)(C,T),f.servername=C}else{let C=(c=(l=(0,Mr.splitHostPort)(d))===null||l===void 0?void 0:l.host)!==null&&c!==void 0?c:"localhost";f.servername=C}i.socket&&(f.createConnection=(C,_)=>i.socket)}else f.createConnection=(C,_)=>i.socket?i.socket:Db.connect(e);f=Object.assign(Object.assign(Object.assign({},f),e),{enableTrace:r["grpc-node.tls_enable_trace"]===1});let y=ah.connect(p+d,f);this.session=y;let S="Failed to connect";y.unref(),y.once("connect",()=>{y.removeAllListeners(),s(new sh(y,e,r,h)),this.session=null}),y.once("close",()=>{this.session=null,setImmediate(()=>{o(`${S} (${new Date().toISOString()})`)})}),y.once("error",C=>{S=C.message,this.trace("connection failed with error "+S)})})}connect(e,n,r){var i,s;if(this.isShutdown)return Promise.reject();let o=n._getConnectionOptions()||{};if("secureContext"in o){if(o.ALPNProtocols=["h2"],r["grpc.ssl_target_name_override"]){let a=r["grpc.ssl_target_name_override"];o.checkServerIdentity=(l,c)=>(0,gv.checkServerIdentity)(a,c),o.servername=a}else if("grpc.http_connect_target"in r){let a=(0,mv.getDefaultAuthority)((i=(0,Mr.parseUri)(r["grpc.http_connect_target"]))!==null&&i!==void 0?i:{path:"localhost"}),l=(0,Mr.splitHostPort)(a);o.servername=(s=l?.host)!==null&&s!==void 0?s:a}r["grpc-node.tls_enable_trace"]&&(o.enableTrace=!0)}return(0,Rb.getProxiedConnection)(e,r,o).then(a=>this.createSession(e,n,r,a))}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};ea.Http2SubchannelConnector=oh});var vv=g(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.getSubchannelPool=Lr.SubchannelPool=void 0;var zb=ng(),Gb=lv(),jb=It(),$b=Qe(),Wb=yv(),Kb=1e4,$i=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let n in this.pool){let i=this.pool[n].filter(s=>!s.subchannel.unrefIfOneRef());i.length>0&&(e=!1),this.pool[n]=i}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,n;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},Kb),(n=(e=this.cleanupTimer).unref)===null||n===void 0||n.call(e))}getOrCreateSubchannel(e,n,r,i){this.ensureCleanupTask();let s=(0,$b.uriToString)(e);if(s in this.pool){let a=this.pool[s];for(let l of a)if((0,jb.subchannelAddressEqual)(n,l.subchannelAddress)&&(0,zb.channelOptionsEqual)(r,l.channelArguments)&&i._equals(l.channelCredentials))return l.subchannel}let o=new Gb.Subchannel(e,n,r,i,new Wb.Http2SubchannelConnector(e));return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:n,channelArguments:r,channelCredentials:i,subchannel:o}),o.ref(),o}};Lr.SubchannelPool=$i;var Hb=new $i;function Qb(t){return t?Hb:new $i}Lr.getSubchannelPool=Qb});var ch=g(Fr=>{"use strict";Object.defineProperty(Fr,"__esModule",{value:!0});Fr.FilterStackFactory=Fr.FilterStack=void 0;var ta=class{constructor(e){this.filters=e}sendMetadata(e){let n=e;for(let r=0;r<this.filters.length;r++)n=this.filters[r].sendMetadata(n);return n}receiveMetadata(e){let n=e;for(let r=this.filters.length-1;r>=0;r--)n=this.filters[r].receiveMetadata(n);return n}sendMessage(e){let n=e;for(let r=0;r<this.filters.length;r++)n=this.filters[r].sendMessage(n);return n}receiveMessage(e){let n=e;for(let r=this.filters.length-1;r>=0;r--)n=this.filters[r].receiveMessage(n);return n}receiveTrailers(e){let n=e;for(let r=this.filters.length-1;r>=0;r--)n=this.filters[r].receiveTrailers(n);return n}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};Fr.FilterStack=ta;var lh=class t{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new t([...this.factories])}createFilter(){return new ta(this.factories.map(e=>e.createFilter()))}};Fr.FilterStackFactory=lh});var uh=g(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.CompressionAlgorithms=void 0;var Sv=function(t){return t[t.identity=0]="identity",t[t.deflate=1]="deflate",t[t.gzip=2]="gzip",t}(Sv||(na.CompressionAlgorithms=Sv={}))});var ia=g(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.BaseFilter=void 0;var hh=class{sendMetadata(e){return U(this,null,function*(){return e})}receiveMetadata(e){return e}sendMessage(e){return U(this,null,function*(){return e})}receiveMessage(e){return U(this,null,function*(){return e})}receiveTrailers(e){return e}};ra.BaseFilter=hh});var wv=g(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});qr.CompressionFilterFactory=qr.CompressionFilter=void 0;var sa=K("zlib"),Ev=uh(),Yb=$(),Xb=ia(),Jb=le(),Zb=t=>typeof t=="number"&&typeof Ev.CompressionAlgorithms[t]=="string",Br=class{writeMessage(e,n){return U(this,null,function*(){let r=e;n&&(r=yield this.compressMessage(r));let i=Buffer.allocUnsafe(r.length+5);return i.writeUInt8(n?1:0,0),i.writeUInt32BE(r.length,1),r.copy(i,5),i})}readMessage(e){return U(this,null,function*(){let n=e.readUInt8(0)===1,r=e.slice(5);return n&&(r=yield this.decompressMessage(r)),r})}},$n=class extends Br{compressMessage(e){return U(this,null,function*(){return e})}writeMessage(e,n){return U(this,null,function*(){let r=Buffer.allocUnsafe(e.length+5);return r.writeUInt8(0,0),r.writeUInt32BE(e.length,1),e.copy(r,5),r})}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},dh=class extends Br{compressMessage(e){return new Promise((n,r)=>{sa.deflate(e,(i,s)=>{i?r(i):n(s)})})}decompressMessage(e){return new Promise((n,r)=>{sa.inflate(e,(i,s)=>{i?r(i):n(s)})})}},fh=class extends Br{compressMessage(e){return new Promise((n,r)=>{sa.gzip(e,(i,s)=>{i?r(i):n(s)})})}decompressMessage(e){return new Promise((n,r)=>{sa.unzip(e,(i,s)=>{i?r(i):n(s)})})}},ph=class extends Br{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function Tv(t){switch(t){case"identity":return new $n;case"deflate":return new dh;case"gzip":return new fh;default:return new ph(t)}}var oa=class extends Xb.BaseFilter{constructor(e,n){var r;super(),this.sharedFilterConfig=n,this.sendCompression=new $n,this.receiveCompression=new $n,this.currentCompressionAlgorithm="identity";let i=e["grpc.default_compression_algorithm"];if(i!==void 0)if(Zb(i)){let s=Ev.CompressionAlgorithms[i],o=(r=n.serverSupportedEncodingHeader)===null||r===void 0?void 0:r.split(",");(!o||o.includes(s))&&(this.currentCompressionAlgorithm=s,this.sendCompression=Tv(this.currentCompressionAlgorithm))}else Jb.log(Yb.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${i}`)}sendMetadata(e){return U(this,null,function*(){let n=yield e;return n.set("grpc-accept-encoding","identity,deflate,gzip"),n.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?n.remove("grpc-encoding"):n.set("grpc-encoding",this.currentCompressionAlgorithm),n})}receiveMetadata(e){let n=e.get("grpc-encoding");if(n.length>0){let i=n[0];typeof i=="string"&&(this.receiveCompression=Tv(i))}e.remove("grpc-encoding");let r=e.get("grpc-accept-encoding")[0];return r&&(this.sharedFilterConfig.serverSupportedEncodingHeader=r,r.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new $n,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}sendMessage(e){return U(this,null,function*(){var n;let r=yield e,i;return this.sendCompression instanceof $n?i=!1:i=(((n=r.flags)!==null&&n!==void 0?n:0)&2)===0,{message:yield this.sendCompression.writeMessage(r.message,i),flags:r.flags}})}receiveMessage(e){return U(this,null,function*(){return this.receiveCompression.readMessage(yield e)})}};qr.CompressionFilter=oa;var gh=class{constructor(e,n){this.options=n,this.sharedFilterConfig={}}createFilter(){return new oa(this.options,this.sharedFilterConfig)}};qr.CompressionFilterFactory=gh});var _v=g(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.MaxMessageSizeFilterFactory=Ur.MaxMessageSizeFilter=void 0;var eI=ia(),aa=$(),Cv=Ve(),la=class extends eI.BaseFilter{constructor(e){super(),this.maxSendMessageSize=aa.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=aa.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,"grpc.max_send_message_length"in e&&(this.maxSendMessageSize=e["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in e&&(this.maxReceiveMessageSize=e["grpc.max_receive_message_length"])}sendMessage(e){return U(this,null,function*(){if(this.maxSendMessageSize===-1)return e;{let n=yield e;if(n.message.length>this.maxSendMessageSize)throw{code:aa.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${n.message.length} vs. ${this.maxSendMessageSize})`,metadata:new Cv.Metadata};return n}})}receiveMessage(e){return U(this,null,function*(){if(this.maxReceiveMessageSize===-1)return e;{let n=yield e;if(n.length>this.maxReceiveMessageSize)throw{code:aa.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${n.length} vs. ${this.maxReceiveMessageSize})`,metadata:new Cv.Metadata};return n}})}};Ur.MaxMessageSizeFilter=la;var mh=class{constructor(e){this.options=e}createFilter(){return new la(this.options)}};Ur.MaxMessageSizeFilterFactory=mh});var ca=g(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.deadlineToString=Lt.getRelativeTimeout=Lt.getDeadlineTimeoutString=Lt.minDeadline=void 0;function tI(...t){let e=1/0;for(let n of t){let r=n instanceof Date?n.getTime():n;r<e&&(e=r)}return e}Lt.minDeadline=tI;var nI=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function rI(t){let e=new Date().getTime();t instanceof Date&&(t=t.getTime());let n=Math.max(t-e,0);for(let[r,i]of nI){let s=n/i;if(s<1e8)return String(Math.ceil(s))+r}throw new Error("Deadline is too far in the future")}Lt.getDeadlineTimeoutString=rI;var iI=2147483647;function sI(t){let e=t instanceof Date?t.getTime():t,n=new Date().getTime(),r=e-n;return r<0?0:r>iI?1/0:r}Lt.getRelativeTimeout=sI;function oI(t){if(t instanceof Date)return t.toISOString();{let e=new Date(t);return Number.isNaN(e.getTime())?""+t:e.toISOString()}}Lt.deadlineToString=oI});var ha=g(ua=>{"use strict";Object.defineProperty(ua,"__esModule",{value:!0});ua.restrictControlPlaneStatusCode=void 0;var Ft=$(),aI=[Ft.Status.OK,Ft.Status.INVALID_ARGUMENT,Ft.Status.NOT_FOUND,Ft.Status.ALREADY_EXISTS,Ft.Status.FAILED_PRECONDITION,Ft.Status.ABORTED,Ft.Status.OUT_OF_RANGE,Ft.Status.DATA_LOSS];function lI(t,e){return aI.includes(t)?{code:Ft.Status.INTERNAL,details:`Invalid status from control plane: ${t} ${Ft.Status[t]} ${e}`}:{code:t,details:e}}ua.restrictControlPlaneStatusCode=lI});var Iv=g(pa=>{"use strict";Object.defineProperty(pa,"__esModule",{value:!0});pa.LoadBalancingCall=void 0;var bv=et(),da=$(),cI=ca(),fa=Ve(),Wi=un(),uI=Qe(),hI=le(),yh=ha(),dI=K("http2"),fI="load_balancing_call",vh=class{constructor(e,n,r,i,s,o,a){var l,c;this.channel=e,this.callConfig=n,this.methodName=r,this.host=i,this.credentials=s,this.deadline=o,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;let h=this.methodName.split("/"),d="";h.length>=2&&(d=h[1]);let f=(c=(l=(0,uI.splitHostPort)(this.host))===null||l===void 0?void 0:l.host)!==null&&c!==void 0?c:"localhost";this.serviceUrl=`https://${f}/${d}`}trace(e){hI.trace(da.LogVerbosity.DEBUG,fI,"["+this.callNumber+"] "+e)}outputStatus(e,n){var r,i;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let s=Object.assign(Object.assign({},e),{progress:n});(r=this.listener)===null||r===void 0||r.onReceiveStatus(s),(i=this.onCallEnded)===null||i===void 0||i.call(this,s.code)}}doPick(){var e,n;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let r=this.channel.doPick(this.metadata,this.callConfig.pickInformation),i=r.subchannel?"("+r.subchannel.getChannelzRef().id+") "+r.subchannel.getAddress():""+r.subchannel;switch(this.trace("Pick result: "+Wi.PickResultType[r.pickResultType]+" subchannel: "+i+" status: "+((e=r.status)===null||e===void 0?void 0:e.code)+" "+((n=r.status)===null||n===void 0?void 0:n.details)),r.pickResultType){case Wi.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(a=>{var l,c,h;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}let d=this.metadata.clone();if(d.merge(a),d.get("authorization").length>1&&this.outputStatus({code:da.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new fa.Metadata},"PROCESSED"),r.subchannel.getConnectivityState()!==bv.ConnectivityState.READY){this.trace("Picked subchannel "+i+" has state "+bv.ConnectivityState[r.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&d.set("grpc-timeout",(0,cI.getDeadlineTimeoutString)(this.deadline));try{this.child=r.subchannel.getRealSubchannel().createCall(d,this.host,this.methodName,{onReceiveMetadata:f=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(f)},onReceiveMessage:f=>{this.trace("Received message"),this.listener.onReceiveMessage(f)},onReceiveStatus:f=>{this.trace("Received status"),f.rstCode===dI.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(f,"REFUSED"):this.outputStatus(f,"PROCESSED")}})}catch(f){this.trace("Failed to start call on picked subchannel "+i+" with error "+f.message),this.outputStatus({code:da.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+f.message,metadata:new fa.Metadata},"NOT_STARTED");return}(c=(l=this.callConfig).onCommitted)===null||c===void 0||c.call(l),(h=r.onCallStarted)===null||h===void 0||h.call(r),this.onCallEnded=r.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},a=>{let{code:l,details:c}=(0,yh.restrictControlPlaneStatusCode)(typeof a.code=="number"?a.code:da.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${a.message}`);this.outputStatus({code:l,details:c,metadata:new fa.Metadata},"PROCESSED")});break;case Wi.PickResultType.DROP:let{code:s,details:o}=(0,yh.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:s,details:o,metadata:r.status.metadata},"DROP")});break;case Wi.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:a,details:l}=(0,yh.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:a,details:l,metadata:r.status.metadata},"PROCESSED")})}break;case Wi.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,n){var r;this.trace("cancelWithStatus code: "+e+' details: "'+n+'"'),(r=this.child)===null||r===void 0||r.cancelWithStatus(e,n),this.outputStatus({code:e,details:n,metadata:new fa.Metadata},"PROCESSED")}getPeer(){var e,n;return(n=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&n!==void 0?n:this.channel.getTarget()}start(e,n){this.trace("start called"),this.listener=n,this.metadata=e,this.doPick()}sendMessageWithContext(e,n){this.trace("write() called with message of length "+n.length),this.child?this.child.sendMessageWithContext(e,n):this.pendingMessage={context:e,message:n}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};pa.LoadBalancingCall=vh});var Rv=g(ma=>{"use strict";Object.defineProperty(ma,"__esModule",{value:!0});ma.ResolvingCall=void 0;var Vr=$(),ga=ca(),Av=Ve(),pI=le(),gI=ha(),mI="resolving_call",Sh=class{constructor(e,n,r,i,s,o){this.channel=e,this.method=n,this.filterStackFactory=i,this.credentials=s,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=r.deadline,this.host=r.host,r.parentCall&&(r.flags&Vr.Propagate.CANCELLATION&&r.parentCall.on("cancelled",()=>{this.cancelWithStatus(Vr.Status.CANCELLED,"Cancelled by parent call")}),r.flags&Vr.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+r.parentCall.getDeadline()),this.deadline=(0,ga.minDeadline)(this.deadline,r.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){pI.trace(Vr.LogVerbosity.DEBUG,mI,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,ga.deadlineToString)(this.deadline));let e=(0,ga.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let n=()=>{this.cancelWithStatus(Vr.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(n):this.deadlineTimer=setTimeout(n,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let n=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+n.code+' details="'+n.details+'"'),this.statusWatchers.forEach(r=>r(n)),process.nextTick(()=>{var r;(r=this.listener)===null||r===void 0||r.onReceiveStatus(n)})}}sendMessageOnChild(e,n){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let r=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:n,flags:e.flags})).then(i=>{this.writeFilterPending=!1,r.sendMessageWithContext(e,i.message),this.pendingHalfClose&&r.halfClose()},i=>{this.cancelWithStatus(i.code,i.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}let n=e.config;if(n.status!==Vr.Status.OK){let{code:r,details:i}=(0,gI.restrictControlPlaneStatusCode)(n.status,"Failed to route call to method "+this.method);this.outputStatus({code:r,details:i,metadata:new Av.Metadata});return}if(n.methodConfig.timeout){let r=new Date;r.setSeconds(r.getSeconds()+n.methodConfig.timeout.seconds),r.setMilliseconds(r.getMilliseconds()+n.methodConfig.timeout.nanos/1e6),this.deadline=(0,ga.minDeadline)(this.deadline,r),this.runDeadlineTimer()}this.filterStackFactory.push(n.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(r=>{this.child=this.channel.createInnerCall(n,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(r,{onReceiveMetadata:i=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(i))},onReceiveMessage:i=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(i).then(s=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(s),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},s=>{this.cancelWithStatus(s.code,s.details)})},onReceiveStatus:i=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=i:this.outputStatus(i)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},r=>{this.outputStatus(r)})}reportResolverError(e){var n;!((n=this.metadata)===null||n===void 0)&&n.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,n){var r;this.trace("cancelWithStatus code: "+e+' details: "'+n+'"'),(r=this.child)===null||r===void 0||r.cancelWithStatus(e,n),this.outputStatus({code:e,details:n,metadata:new Av.Metadata})}getPeer(){var e,n;return(n=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&n!==void 0?n:this.channel.getTarget()}start(e,n){this.trace("start called"),this.metadata=e.clone(),this.listener=n,this.getConfig()}sendMessageWithContext(e,n){this.trace("write() called with message of length "+n.length),this.child?this.sendMessageOnChild(e,n):this.pendingMessage={context:e,message:n}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};ma.ResolvingCall=Sh});var Dv=g(An=>{"use strict";Object.defineProperty(An,"__esModule",{value:!0});An.RetryingCall=An.MessageBufferTracker=An.RetryThrottler=void 0;var ya=$(),yI=Ve(),vI=le(),SI="retrying_call",Eh=class{constructor(e,n,r){this.maxTokens=e,this.tokenRatio=n,r?this.tokens=r.tokens*(e/r.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};An.RetryThrottler=Eh;var wh=class{constructor(e,n){this.totalLimit=e,this.limitPerCall=n,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,n){var r;let i=(r=this.allocatedPerCall.get(n))!==null&&r!==void 0?r:0;return this.limitPerCall-i<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(n,i+e),this.totalAllocated+=e,!0)}free(e,n){var r;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${n} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let i=(r=this.allocatedPerCall.get(n))!==null&&r!==void 0?r:0;if(i<e)throw new Error(`Invalid buffer allocation state: call ${n} freed ${e} > allocated for call ${i}`);this.allocatedPerCall.set(n,i-e)}freeAll(e){var n;let r=(n=this.allocatedPerCall.get(e))!==null&&n!==void 0?n:0;if(this.totalAllocated<r)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${r} > total allocated ${this.totalAllocated}`);this.totalAllocated-=r,this.allocatedPerCall.delete(e)}};An.MessageBufferTracker=wh;var Th="grpc-previous-rpc-attempts",Ch=class{constructor(e,n,r,i,s,o,a,l,c){if(this.channel=e,this.callConfig=n,this.methodName=r,this.host=i,this.credentials=s,this.deadline=o,this.callNumber=a,this.bufferTracker=l,this.retryThrottler=c,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,n.methodConfig.retryPolicy){this.state="RETRY";let h=n.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(h.initialBackoff.substring(0,h.initialBackoff.length-1))}else n.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){vI.trace(ya.LogVerbosity.DEBUG,SI,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var n;(n=this.listener)===null||n===void 0||n.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,n){this.trace("cancelWithStatus code: "+e+' details: "'+n+'"'),this.reportStatus({code:e,details:n,metadata:new yI.Metadata});for(let{call:r}of this.underlyingCalls)r.cancelWithStatus(e,n)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var n;return(n=this.writeBuffer[e-this.writeBufferOffset])!==null&&n!==void 0?n:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let n=this.writeBufferOffset;n<e;n++){let r=this.getBufferEntry(n);r.allocated&&this.bufferTracker.free(r.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if(this.state!=="COMMITTED"&&this.underlyingCalls[e].state!=="COMPLETED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let n=0;n<this.underlyingCalls.length;n++)n!==e&&this.underlyingCalls[n].state!=="COMPLETED"&&(this.underlyingCalls[n].state="COMPLETED",this.underlyingCalls[n].call.cancelWithStatus(ya.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,n=-1;for(let[r,i]of this.underlyingCalls.entries())i.state==="ACTIVE"&&i.nextMessageToSend>e&&(e=i.nextMessageToSend,n=r);n===-1?this.state="TRANSPARENT_ONLY":this.commitCall(n)}isStatusCodeInList(e,n){return e.some(r=>r===n||r.toString().toLowerCase()===ya.Status[n].toLowerCase())}getNextRetryBackoffMs(){var e;let n=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!n)return 0;let r=Math.random()*this.nextRetryBackoffSec*1e3,i=Number(n.maxBackoff.substring(0,n.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*n.backoffMultiplier,i),r}maybeRetryCall(e,n){if(this.state!=="RETRY"){n(!1);return}let r=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(r.maxAttempts,5)){n(!1);return}let i;if(e===null)i=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",n(!1);return}else i=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var s,o;if(this.state!=="RETRY"){n(!1);return}(!((o=(s=this.retryThrottler)===null||s===void 0?void 0:s.canRetryCall())!==null&&o!==void 0)||o)&&(n(!0),this.attempts+=1,this.startNewAttempt())},i)}countActiveCalls(){let e=0;for(let n of this.underlyingCalls)n?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,n,r){var i,s,o;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(n),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((i=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&i!==void 0?i:[],e.code)){(s=this.retryThrottler)===null||s===void 0||s.addCallFailed();let a;if(r===null)a=0;else if(r<0){this.state="TRANSPARENT_ONLY",this.commitCall(n),this.reportStatus(e);return}else a=r;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(n),this.reportStatus(e))},a)}else this.commitCall(n),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((o=this.retryThrottler)===null||o===void 0||o.addCallFailed(),this.maybeRetryCall(r,a=>{a||(this.commitCall(n),this.reportStatus(e))})):(this.commitCall(n),this.reportStatus(e));break}}getPushback(e){let n=e.get("grpc-retry-pushback-ms");if(n.length===0)return null;try{return parseInt(n[0])}catch{return-1}}handleChildStatus(e,n){var r;if(this.underlyingCalls[n].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[n].call.getCallNumber()+"] in state "+this.underlyingCalls[n].state),this.underlyingCalls[n].state="COMPLETED",e.code===ya.Status.OK){(r=this.retryThrottler)===null||r===void 0||r.addCallSucceeded(),this.commitCall(n),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let i=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,n,i):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(n),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,n,i);break}}maybeStartHedgingAttempt(){if(this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,n,r;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let i=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(i.maxAttempts,5))return;let s=(e=i.hedgingDelay)!==null&&e!==void 0?e:"0s",o=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},o*1e3),(r=(n=this.hedgingTimer).unref)===null||r===void 0||r.call(n)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let n=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let r=this.attempts-1,i=this.initialMetadata.clone();r>0&&i.set(Th,`${r}`);let s=!1;e.start(i,{onReceiveMetadata:o=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(n),s=!0,r>0&&o.set(Th,`${r}`),this.underlyingCalls[n].state==="ACTIVE"&&this.listener.onReceiveMetadata(o)},onReceiveMessage:o=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(n),this.underlyingCalls[n].state==="ACTIVE"&&this.listener.onReceiveMessage(o)},onReceiveStatus:o=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&r>0&&o.metadata.set(Th,`${r}`),this.handleChildStatus(o,n)}}),this.sendNextChildMessage(n),this.readStarted&&e.startRead()}start(e,n){this.trace("start called"),this.listener=n,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var n,r;let i=this.underlyingCalls[e],s=i.nextMessageToSend;(r=(n=this.getBufferEntry(s)).callback)===null||r===void 0||r.call(n),this.clearSentMessages(),i.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let n=this.underlyingCalls[e];if(n.state!=="COMPLETED"&&this.getBufferEntry(n.nextMessageToSend)){let r=this.getBufferEntry(n.nextMessageToSend);switch(r.entryType){case"MESSAGE":n.call.sendMessageWithContext({callback:i=>{this.handleChildWriteCompleted(e)}},r.message.message);break;case"HALF_CLOSE":n.nextMessageToSend+=1,n.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,n){var r;this.trace("write() called with message of length "+n.length);let i={message:n,flags:e.flags},s=this.getNextBufferIndex(),o={entryType:"MESSAGE",message:i,allocated:this.bufferTracker.allocate(n.length,this.callNumber)};if(this.writeBuffer.push(o),o.allocated){(r=e.callback)===null||r===void 0||r.call(e);for(let[a,l]of this.underlyingCalls.entries())l.state==="ACTIVE"&&l.nextMessageToSend===s&&l.call.sendMessageWithContext({callback:c=>{this.handleChildWriteCompleted(a)}},n)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let a=this.underlyingCalls[this.committedCallIndex];o.callback=e.callback,a.state==="ACTIVE"&&a.nextMessageToSend===s&&a.call.sendMessageWithContext({callback:l=>{this.handleChildWriteCompleted(this.committedCallIndex)}},n)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let n of this.underlyingCalls)n?.state==="ACTIVE"&&n.nextMessageToSend===e&&(n.nextMessageToSend+=1,n.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};An.RetryingCall=Ch});var Sa=g(va=>{"use strict";Object.defineProperty(va,"__esModule",{value:!0});va.BaseSubchannelWrapper=void 0;var _h=class{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}};va.BaseSubchannelWrapper=_h});var Ov=g(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.InternalChannel=void 0;var TI=to(),EI=tg(),wI=vv(),Nv=un(),Ki=$(),CI=ch(),_I=wv(),kv=_t(),bh=le(),bI=_v(),II=Ju(),Ta=Qe(),Bt=et(),Hi=jn(),AI=Iv(),RI=ca(),DI=Rv(),Ih=nh(),NI=ha(),Ah=Dv(),kI=Sa(),OI=2147483647,xI=1e3,MI=30*60*1e3,Ea=new Map,PI=1<<24,LI=1<<20,Rh=class extends kI.BaseSubchannelWrapper{constructor(e,n){super(e),this.channel=n,this.refCount=0,this.subchannelStateListener=(r,i,s,o)=>{n.throttleKeepalive(o)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},Dh=class{constructor(e,n,r){var i,s,o,a,l,c,h,d;if(this.credentials=n,this.options=r,this.connectivityState=Bt.ConnectivityState.IDLE,this.currentPicker=new Nv.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new Hi.ChannelzCallTracker,this.childrenTracker=new Hi.ChannelzChildrenTracker,typeof e!="string")throw new TypeError("Channel target must be a string");if(!(n instanceof TI.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(r&&typeof r!="object")throw new TypeError("Channel options must be an object");this.originalTarget=e;let f=(0,Ta.parseUri)(e);if(f===null)throw new Error(`Could not parse target name "${e}"`);let p=(0,kv.mapUriDefaultScheme)(f);if(p===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},OI),(s=(i=this.callRefTimer).unref)===null||s===void 0||s.call(i),this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzTrace=new Hi.ChannelzTrace,this.channelzRef=(0,Hi.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,kv.getDefaultAuthority)(p);let y=(0,II.mapProxyName)(p,r);this.target=y.target,this.options=Object.assign({},this.options,y.extraOptions),this.subchannelPool=(0,wI.getSubchannelPool)(((o=r["grpc.use_local_subchannel_pool"])!==null&&o!==void 0?o:0)===0),this.retryBufferTracker=new Ah.MessageBufferTracker((a=r["grpc.retry_buffer_size"])!==null&&a!==void 0?a:PI,(l=r["grpc.per_rpc_retry_buffer_size"])!==null&&l!==void 0?l:LI),this.keepaliveTime=(c=r["grpc.keepalive_time_ms"])!==null&&c!==void 0?c:-1,this.idleTimeoutMs=Math.max((h=r["grpc.client_idle_timeout_ms"])!==null&&h!==void 0?h:MI,xI);let S={createSubchannel:(_,T)=>{let N=this.subchannelPool.getOrCreateSubchannel(this.target,_,Object.assign({},this.options,T),this.credentials);N.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",N.getChannelzRef());let A=new Rh(N,this);return this.wrappedSubchannels.add(A),A},updateState:(_,T)=>{this.currentPicker=T;let N=this.pickQueue.slice();this.pickQueue=[],N.length>0&&this.callRefTimerUnref();for(let A of N)A.doPick();this.updateState(_)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:_=>{this.channelzEnabled&&this.childrenTracker.refChild(_)},removeChannelzChild:_=>{this.channelzEnabled&&this.childrenTracker.unrefChild(_)}};this.resolvingLoadBalancer=new EI.ResolvingLoadBalancer(this.target,S,r,(_,T)=>{_.retryThrottling?Ea.set(this.getTarget(),new Ah.RetryThrottler(_.retryThrottling.maxTokens,_.retryThrottling.tokenRatio,Ea.get(this.getTarget()))):Ea.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=T,this.currentResolutionError=null,process.nextTick(()=>{let N=this.configSelectionQueue;this.configSelectionQueue=[],N.length>0&&this.callRefTimerUnref();for(let A of N)A.getConfig()})},_=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+_.code+' and details "'+_.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,NI.restrictControlPlaneStatusCode)(_.code,_.details)),{metadata:_.metadata}));let T=this.configSelectionQueue;this.configSelectionQueue=[],T.length>0&&this.callRefTimerUnref();for(let N of T)N.reportResolverError(_)}),this.filterStackFactory=new CI.FilterStackFactory([new bI.MaxMessageSizeFilterFactory(this.options),new _I.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(r,void 0,2));let C=new Error;(0,bh.trace)(Ki.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((d=C.stack)===null||d===void 0?void 0:d.substring(C.stack.indexOf(`
`)+1)))}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,n){(0,bh.trace)(n??Ki.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,Ta.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,n,r,i;!((n=(e=this.callRefTimer).hasRef)===null||n===void 0)&&n.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(i=(r=this.callRefTimer).ref)===null||i===void 0||i.call(r))}callRefTimerUnref(){var e,n;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(n=(e=this.callRefTimer).unref)===null||n===void 0||n.call(e))}removeConnectivityStateWatcher(e){let n=this.connectivityStateWatchers.findIndex(r=>r===e);n>=0&&this.connectivityStateWatchers.splice(n,1)}updateState(e){(0,bh.trace)(Ki.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,Ta.uriToString)(this.target)+" "+Bt.ConnectivityState[this.connectivityState]+" -> "+Bt.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+Bt.ConnectivityState[e]),this.connectivityState=e;let n=this.connectivityStateWatchers.slice();for(let r of n)e!==r.currentState&&(r.timer&&clearTimeout(r.timer),this.removeConnectivityStateWatcher(r),r.callback());e!==Bt.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let n of this.wrappedSubchannels)n.throttleKeepalive(e)}}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,n){return this.currentPicker.pick({metadata:e,extraPickInfo:n})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,n){return this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector(e,n)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(Bt.ConnectivityState.IDLE),this.currentPicker=new Nv.QueuePicker(this.resolvingLoadBalancer)}maybeStartIdleTimer(){var e,n;this.connectivityState!==Bt.ConnectivityState.SHUTDOWN&&this.callCount===0&&(this.idleTimer=setTimeout(()=>{this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()},this.idleTimeoutMs),(n=(e=this.idleTimer).unref)===null||n===void 0||n.call(e))}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1,this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}onCallEnd(e){this.channelzEnabled&&(e.code===Ki.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.maybeStartIdleTimer()}createLoadBalancingCall(e,n,r,i,s){let o=(0,Ih.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+o+'] method="'+n+'"'),new AI.LoadBalancingCall(this,e,n,r,i,s,o)}createRetryingCall(e,n,r,i,s){let o=(0,Ih.getNextCallNumber)();return this.trace("createRetryingCall ["+o+'] method="'+n+'"'),new Ah.RetryingCall(this,e,n,r,i,s,o,this.retryBufferTracker,Ea.get(this.getTarget()))}createInnerCall(e,n,r,i,s){return this.options["grpc.enable_retries"]===0?this.createLoadBalancingCall(e,n,r,i,s):this.createRetryingCall(e,n,r,i,s)}createResolvingCall(e,n,r,i,s){let o=(0,Ih.getNextCallNumber)();this.trace("createResolvingCall ["+o+'] method="'+e+'", deadline='+(0,RI.deadlineToString)(n));let a={deadline:n,flags:s??Ki.Propagate.DEFAULTS,host:r??this.defaultAuthority,parentCall:i},l=new DI.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),o);return this.onCallStart(),l.addStatusWatcher(c=>{this.onCallEnd(c)}),l}close(){this.resolvingLoadBalancer.destroy(),this.updateState(Bt.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,Hi.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,Ta.uriToString)(this.target)}getConnectivityState(e){let n=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.maybeStartIdleTimer()),n}watchConnectivityState(e,n,r){if(this.connectivityState===Bt.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let i=null;if(n!==1/0){let o=n instanceof Date?n:new Date(n),a=new Date;if(n===-1/0||o<=a){process.nextTick(r,new Error("Deadline passed without connectivity state change"));return}i=setTimeout(()=>{this.removeConnectivityStateWatcher(s),r(new Error("Deadline passed without connectivity state change"))},o.getTime()-a.getTime())}let s={currentState:e,callback:r,timer:i};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,n,r,i,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof n=="number"||n instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===Bt.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,n,r,i,s)}};wa.InternalChannel=Dh});var xc=g(Ca=>{"use strict";Object.defineProperty(Ca,"__esModule",{value:!0});Ca.ChannelImplementation=void 0;var FI=to(),BI=Ov(),Nh=class{constructor(e,n,r){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(n instanceof FI.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(r&&typeof r!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new BI.InternalChannel(e,n,r)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,n,r){this.internalChannel.watchConnectivityState(e,n,r)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,n,r,i,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof n=="number"||n instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,n,r,i,s)}};Ca.ChannelImplementation=Nh});var zv=g(ct=>{"use strict";Object.defineProperty(ct,"__esModule",{value:!0});ct.Http2ServerCallStream=ct.ServerDuplexStreamImpl=ct.ServerWritableStreamImpl=ct.ServerReadableStreamImpl=ct.ServerUnaryCallImpl=void 0;var Fv=K("events"),zr=K("http2"),xh=K("stream"),Bv=K("zlib"),qv=K("util"),ie=$(),Mh=Ve(),qI=eh(),Uv=le(),Yi=Qs(),Vv="server_call",UI=(0,qv.promisify)(Bv.unzip),VI=(0,qv.promisify)(Bv.inflate);function Qi(t){Uv.trace(ie.LogVerbosity.DEBUG,Vv,t)}var zI="grpc-accept-encoding",GI="grpc-encoding",xv="grpc-message",Mv="grpc-status",Pv="grpc-timeout",jI=/(\d{1,8})\s*([HMSmun])/,$I={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},WI={[zI]:"identity,deflate,gzip",[GI]:"identity"},Lv={[zr.constants.HTTP2_HEADER_STATUS]:zr.constants.HTTP_STATUS_OK,[zr.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},KI={waitForTrailers:!0},kh=class extends Fv.EventEmitter{constructor(e,n,r){super(),this.call=e,this.metadata=n,this.request=r,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};ct.ServerUnaryCallImpl=kh;var _a=class extends xh.Readable{constructor(e,n,r,i){super({objectMode:!0}),this.call=e,this.metadata=n,this.deserialize=r,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,i)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}};ct.ServerReadableStreamImpl=_a;var Xi=class extends xh.Writable{constructor(e,n,r,i){super({objectMode:!0}),this.call=e,this.metadata=n,this.serialize=r,this.request=i,this.cancelled=!1,this.trailingMetadata=new Mh.Metadata,this.call.setupSurfaceCall(this),this.on("error",s=>{this.call.sendError(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,n,r){try{let i=this.call.serializeMessage(e);if(!this.call.write(i)){this.call.once("drain",r);return}}catch(i){this.emit("error",{details:(0,Yi.getErrorMessage)(i),code:ie.Status.INTERNAL})}r()}_final(e){this.call.sendStatus({code:ie.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}};ct.ServerWritableStreamImpl=Xi;var Gr=class extends xh.Duplex{constructor(e,n,r,i,s){super({objectMode:!0}),this.call=e,this.metadata=n,this.serialize=r,this.deserialize=i,this.cancelled=!1,this.trailingMetadata=new Mh.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,s),this.on("error",o=>{this.call.sendError(o),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}};ct.ServerDuplexStreamImpl=Gr;Gr.prototype._read=_a.prototype._read;Gr.prototype._write=Xi.prototype._write;Gr.prototype._final=Xi.prototype._final;var Oh=class extends Fv.EventEmitter{constructor(e,n,r){super(),this.stream=e,this.handler=n,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=ie.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=ie.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",i=>{}),this.stream.once("close",()=>{var i;Qi("Request to method "+((i=this.handler)===null||i===void 0?void 0:i.path)+" stream closed with rstCode "+this.stream.rstCode),this.statusSent||(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:ie.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in r&&(this.maxSendMessageSize=r["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in r&&(this.maxReceiveMessageSize=r["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,n){return n==="deflate"?VI(e.subarray(5)):n==="gzip"?UI(e.subarray(5)):n==="identity"?e.subarray(5):Promise.reject({code:ie.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${n}"`})}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let n=e?e.toHttp2Headers():null,r=Object.assign(Object.assign(Object.assign({},Lv),WI),n);this.stream.respond(r,KI)}receiveMetadata(e){let n=Mh.Metadata.fromHttp2Headers(e);Uv.isTracerEnabled(Vv)&&Qi("Request to "+this.handler.path+" received headers "+JSON.stringify(n.toJSON()));let r=n.get(Pv);if(r.length>0){let i=r[0].toString().match(jI);if(i===null){let a=new Error("Invalid deadline");return a.code=ie.Status.OUT_OF_RANGE,this.sendError(a),n}let s=+i[1]*$I[i[2]]|0,o=new Date;this.deadline=o.setMilliseconds(o.getMilliseconds()+s),this.deadlineTimer=setTimeout(HI,s,this),n.remove(Pv)}return n.remove(zr.constants.HTTP2_HEADER_ACCEPT_ENCODING),n.remove(zr.constants.HTTP2_HEADER_TE),n.remove(zr.constants.HTTP2_HEADER_CONTENT_TYPE),n.remove("grpc-accept-encoding"),n}receiveUnaryMessage(e){return new Promise((n,r)=>{let{stream:i}=this,s=0,o=this,a=[],l=this.maxReceiveMessageSize;this.stream.on("data",c),this.stream.on("end",h),this.stream.on("error",h);function c(d){if(s+=d.byteLength,l!==-1&&s>l){i.removeListener("data",c),i.removeListener("end",h),i.removeListener("error",h),r({code:ie.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${s} vs. ${l})`});return}a.push(d)}function h(d){if(i.removeListener("data",c),i.removeListener("end",h),i.removeListener("error",h),d!==void 0){r({code:ie.Status.INTERNAL,details:d.message});return}if(s===0){r({code:ie.Status.INTERNAL,details:"received empty unary message"});return}o.emit("receiveMessage");let f=Buffer.concat(a,s),y=f.readUInt8(0)===1?e:"identity",S=o.getDecompressedMessage(f,y);if(Buffer.isBuffer(S)){n(o.deserializeMessageWithInternalError(S));return}S.then(C=>n(o.deserializeMessageWithInternalError(C)),C=>r(C.code?C:{code:ie.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}})}deserializeMessageWithInternalError(e){return U(this,null,function*(){try{return this.deserializeMessage(e)}catch(n){throw{details:(0,Yi.getErrorMessage)(n),code:ie.Status.INTERNAL}}})}serializeMessage(e){let n=this.handler.serialize(e),r=n.byteLength,i=Buffer.allocUnsafe(r+5);return i.writeUInt8(0,0),i.writeUInt32BE(r,1),n.copy(i,5),i}deserializeMessage(e){return this.handler.deserialize(e)}sendUnaryMessage(e,n,r,i){return U(this,null,function*(){if(!this.checkCancelled()){if(r===void 0&&(r=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&r&&(e.metadata=r),this.sendError(e);return}try{let s=this.serializeMessage(n);this.write(s),this.sendStatus({code:ie.Status.OK,details:"OK",metadata:r})}catch(s){this.sendError({details:(0,Yi.getErrorMessage)(s),code:ie.Status.INTERNAL})}}})}sendStatus(e){var n,r;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===ie.Status.OK),!this.checkCancelled())if(Qi("Request to method "+((n=this.handler)===null||n===void 0?void 0:n.path)+" ended with status code: "+ie.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var i;let s=Object.assign({[Mv]:e.code,[xv]:encodeURI(e.details)},(i=e.metadata)===null||i===void 0?void 0:i.toHttp2Headers());this.stream.sendTrailers(s),this.statusSent=!0}),this.stream.end());else{let i=Object.assign(Object.assign({[Mv]:e.code,[xv]:encodeURI(e.details)},Lv),(r=e.metadata)===null||r===void 0?void 0:r.toHttp2Headers());this.stream.respond(i,{endStream:!0}),this.statusSent=!0}}sendError(e){let n={code:ie.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&e.metadata!==void 0?e.metadata:null};"code"in e&&typeof e.code=="number"&&Number.isInteger(e.code)&&(n.code=e.code,"details"in e&&typeof e.details=="string"&&(n.details=e.details)),this.sendStatus(n)}write(e){if(!this.checkCancelled()){if(this.maxSendMessageSize!==-1&&e.length>this.maxSendMessageSize){this.sendError({code:ie.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`});return}return this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e)}}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",n=>{e.cancelled=!0,e.emit("cancelled",n)}),this.once("callEnd",n=>e.emit("callEnd",n))}setupReadable(e,n){let r=new qI.StreamDecoder,i=!1,s=!1,o=!1,a=()=>U(this,null,function*(){!o&&i&&!s&&(o=!0,yield this.pushOrBufferMessage(e,null))});this.stream.on("data",l=>U(this,null,function*(){let c=r.write(l);s=!0,this.stream.pause();for(let h of c){if(this.maxReceiveMessageSize!==-1&&h.length>this.maxReceiveMessageSize){this.sendError({code:ie.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${h.length} vs. ${this.maxReceiveMessageSize})`});return}this.emit("receiveMessage");let f=h.readUInt8(0)===1?n:"identity",p=yield this.getDecompressedMessage(h,f);if(!p)return;yield this.pushOrBufferMessage(e,p)}s=!1,this.stream.resume(),yield a()})),this.stream.once("end",()=>U(this,null,function*(){i=!0,yield a()}))}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let n=this.messagesToPush.shift(),r=e.push(n);if(n===null||r===!1){this.canPush=!1;break}}return this.canPush}pushOrBufferMessage(e,n){return U(this,null,function*(){this.isPushPending?this.bufferedMessages.push(n):yield this.pushMessage(e,n)})}pushMessage(e,n){return U(this,null,function*(){if(n===null){Qi("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}Qi("Received message of length "+n.length),this.isPushPending=!0;try{let r=yield this.deserializeMessage(n);this.canPush?e.push(r)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(r)}catch(r){this.bufferedMessages.length=0;let i=(0,Yi.getErrorCode)(r);(i===null||i<ie.Status.OK||i>ie.Status.UNAUTHENTICATED)&&(i=ie.Status.INTERNAL),e.emit("error",{details:(0,Yi.getErrorMessage)(r),code:i})}this.isPushPending=!1,this.bufferedMessages.length>0&&(yield this.pushMessage(e,this.bufferedMessages.shift()))})}getPeer(){var e;let n=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return n?.remoteAddress?n.remotePort?`${n.remoteAddress}:${n.remotePort}`:n.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}};ct.Http2ServerCallStream=Oh;function HI(t){let e=new Error("Deadline exceeded");e.code=ie.Status.DEADLINE_EXCEEDED,t.sendError(e),t.cancelled=!0,t.emit("cancelled","deadline")}});var Fh=g(ba=>{"use strict";Object.defineProperty(ba,"__esModule",{value:!0});ba.ServerCredentials=void 0;var Gv=rc(),Ji=class{static createInsecure(){return new Ph}static createSsl(e,n,r=!1){if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(n))throw new TypeError("keyCertPairs must be an array");if(typeof r!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let i=[],s=[];for(let o=0;o<n.length;o++){let a=n[o];if(a===null||typeof a!="object")throw new TypeError(`keyCertPair[${o}] must be an object`);if(!Buffer.isBuffer(a.private_key))throw new TypeError(`keyCertPair[${o}].private_key must be a Buffer`);if(!Buffer.isBuffer(a.cert_chain))throw new TypeError(`keyCertPair[${o}].cert_chain must be a Buffer`);i.push(a.cert_chain),s.push(a.private_key)}return new Lh({ca:e||(0,Gv.getDefaultRootsData)()||void 0,cert:i,key:s,requestCert:r,ciphers:Gv.CIPHER_SUITES})}};ba.ServerCredentials=Ji;var Ph=class extends Ji{_isSecure(){return!1}_getSettings(){return null}},Lh=class extends Ji{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}});var Wv=g(Ra=>{"use strict";Object.defineProperty(Ra,"__esModule",{value:!0});Ra.Server=void 0;var Rn=K("http2"),Jt=$(),Wn=zv(),QI=Fh(),jv=_t(),Ia=le(),Tt=It(),YI=Qe(),$e=jn(),Aa=~(1<<31),XI=~(1<<31),JI=2e4,{HTTP2_HEADER_PATH:$v}=Rn.constants,ZI="server";function eA(){}function Bh(t){return{code:Jt.Status.UNIMPLEMENTED,details:`The server does not implement the method ${t}`}}function tA(t,e){let n=Bh(e);switch(t){case"unary":return(r,i)=>{i(n,null)};case"clientStream":return(r,i)=>{i(n,null)};case"serverStream":return r=>{r.emit("error",n)};case"bidi":return r=>{r.emit("error",n)};default:throw new Error(`Invalid handlerType ${t}`)}}var qh=class{constructor(e){var n,r,i,s;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new $e.ChannelzTrace,this.callTracker=new $e.ChannelzCallTracker,this.listenerChildrenTracker=new $e.ChannelzChildrenTracker,this.sessionChildrenTracker=new $e.ChannelzChildrenTracker,this.options=e??{},this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,$e.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(n=this.options["grpc.max_connection_age_ms"])!==null&&n!==void 0?n:Aa,this.maxConnectionAgeGraceMs=(r=this.options["grpc.max_connection_age_grace_ms"])!==null&&r!==void 0?r:Aa,this.keepaliveTimeMs=(i=this.options["grpc.keepalive_time_ms"])!==null&&i!==void 0?i:XI,this.keepaliveTimeoutMs=(s=this.options["grpc.keepalive_timeout_ms"])!==null&&s!==void 0?s:JI,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var n,r,i;let s=this.sessions.get(e),o=e.socket,a=o.remoteAddress?(0,Tt.stringToSubchannelAddress)(o.remoteAddress,o.remotePort):null,l=o.localAddress?(0,Tt.stringToSubchannelAddress)(o.localAddress,o.localPort):null,c;if(e.encrypted){let d=o,f=d.getCipher(),p=d.getCertificate(),y=d.getPeerCertificate();c={cipherSuiteStandardName:(n=f.standardName)!==null&&n!==void 0?n:null,cipherSuiteOtherName:f.standardName?null:f.name,localCertificate:p&&"raw"in p?p.raw:null,remoteCertificate:y&&"raw"in y?y.raw:null}}else c=null;return{remoteAddress:a,localAddress:l,security:c,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:(r=e.state.localWindowSize)!==null&&r!==void 0?r:null,remoteFlowControlWindow:(i=e.state.remoteWindowSize)!==null&&i!==void 0?i:null}}}trace(e){Ia.trace(Jt.LogVerbosity.DEBUG,ZI,"("+this.channelzRef.id+") "+e)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(e,n){if(e===null||typeof e!="object"||n===null||typeof n!="object")throw new Error("addService() requires two objects as arguments");let r=Object.keys(e);if(r.length===0)throw new Error("Cannot add an empty service to a server");r.forEach(i=>{let s=e[i],o;s.requestStream?s.responseStream?o="bidi":o="clientStream":s.responseStream?o="serverStream":o="unary";let a=n[i],l;if(a===void 0&&typeof s.originalName=="string"&&(a=n[s.originalName]),a!==void 0?l=a.bind(n):l=tA(o,i),this.register(s.path,l,s.responseSerialize,s.requestDeserialize,o)===!1)throw new Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(e===null||typeof e!="object")throw new Error("removeService() requires object as argument");Object.keys(e).forEach(r=>{let i=e[r];this.unregister(i.path)})}bind(e,n){throw new Error("Not implemented. Use bindAsync() instead")}bindAsync(e,n,r){if(this.started===!0)throw new Error("server is already started");if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof e!="string")throw new TypeError("port must be a string");if(n===null||!(n instanceof QI.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof r!="function")throw new TypeError("callback must be a function");let i=(0,YI.parseUri)(e);if(i===null)throw new Error(`Could not parse port "${e}"`);let s=(0,jv.mapUriDefaultScheme)(i);if(s===null)throw new Error(`Could not get a default scheme for port "${e}"`);let o={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?o.maxSessionMemory=this.options["grpc-node.max_session_memory"]:o.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(o.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let a=(p,y)=>{process.nextTick(()=>r(p,y))},l=()=>{let p;if(n._isSecure()){let y=Object.assign(o,n._getSettings());y.enableTrace=this.options["grpc-node.tls_enable_trace"]===1,p=Rn.createSecureServer(y),p.on("secureConnection",S=>{S.on("error",C=>{this.trace("An incoming TLS connection closed with error: "+C.message)})})}else p=Rn.createServer(o);return p.setTimeout(0,eA),this._setupHandlers(p),p},c=(p,y,S)=>p.length===0?Promise.resolve({port:y,count:S}):Promise.all(p.map(C=>{this.trace("Attempting to bind "+(0,Tt.subchannelAddressToString)(C));let _;(0,Tt.isTcpSubchannelAddress)(C)?_={host:C.host,port:y}:_=C;let T=l();return new Promise((N,A)=>{let M=L=>{this.trace("Failed to bind "+(0,Tt.subchannelAddressToString)(C)+" with error "+L.message),N(L)};T.once("error",M),T.listen(_,()=>{if(this.shutdown){T.close(),N(new Error("bindAsync failed because server is shutdown"));return}let L=T.address(),V;typeof L=="string"?V={path:L}:V={host:L.address,port:L.port};let ge=(0,$e.registerChannelzSocket)((0,Tt.subchannelAddressToString)(V),()=>({localAddress:V,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(ge),this.http2ServerList.push({server:T,channelzRef:ge}),this.trace("Successfully bound "+(0,Tt.subchannelAddressToString)(V)),N("port"in V?V.port:y),T.removeListener("error",M)})})})).then(C=>{let _=0;for(let T of C)if(typeof T=="number"&&(_+=1,T!==y))throw new Error("Invalid state: multiple port numbers added from single address");return{port:y,count:_+S}}),h=p=>{if(p.length===0)return Promise.resolve({port:0,count:0});let y=p[0],S=l();return new Promise((C,_)=>{let T=N=>{this.trace("Failed to bind "+(0,Tt.subchannelAddressToString)(y)+" with error "+N.message),C(h(p.slice(1)))};S.once("error",T),S.listen(y,()=>{if(this.shutdown){S.close(),C({port:0,count:0});return}let N=S.address(),A={host:N.address,port:N.port},M=(0,$e.registerChannelzSocket)((0,Tt.subchannelAddressToString)(A),()=>({localAddress:A,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(M),this.http2ServerList.push({server:S,channelzRef:M}),this.trace("Successfully bound "+(0,Tt.subchannelAddressToString)(A)),C(c(p.slice(1),N.port,1)),S.removeListener("error",T)})})},d={onSuccessfulResolution:(p,y,S)=>{if(d.onSuccessfulResolution=()=>{},this.shutdown&&a(new Error("bindAsync failed because server is shutdown"),0),p.length===0){a(new Error(`No addresses resolved for port ${e}`),0);return}let C;(0,Tt.isTcpSubchannelAddress)(p[0])?p[0].port===0?C=h(p):C=c(p,p[0].port,0):C=c(p,1,0),C.then(_=>{if(_.count===0){let T=`No address added out of total ${p.length} resolved`;Ia.log(Jt.LogVerbosity.ERROR,T),a(new Error(T),0)}else _.count<p.length&&Ia.log(Jt.LogVerbosity.INFO,`WARNING Only ${_.count} addresses added out of total ${p.length} resolved`),a(null,_.port)},_=>{let T=`No address added out of total ${p.length} resolved`;Ia.log(Jt.LogVerbosity.ERROR,T),a(new Error(T),0)})},onError:p=>{a(new Error(p.details),0)}};(0,jv.createResolver)(s,d,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:n}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(n),(0,$e.unregisterChannelzRef)(n))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,n)=>{n.destroy(Rn.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,$e.unregisterChannelzRef)(this.channelzRef)}register(e,n,r,i,s){return this.handlers.has(e)?!1:(this.handlers.set(e,{func:n,serialize:r,deserialize:i,type:s,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(this.http2ServerList.length===0||this.http2ServerList.every(({server:e})=>e.listening!==!0))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let n=s=>{this.channelzEnabled&&(0,$e.unregisterChannelzRef)(this.channelzRef),e(s)},r=0;function i(){r--,r===0&&n()}this.started=!1,this.shutdown=!0;for(let{server:s,channelzRef:o}of this.http2ServerList)s.listening&&(r++,s.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(o),(0,$e.unregisterChannelzRef)(o)),i()}));this.sessions.forEach((s,o)=>{o.closed||(r+=1,o.close(i))}),r===0&&n()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,n){let r=n[Rn.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof r!="string"||!r.startsWith("application/grpc")?(e.respond({[Rn.constants.HTTP2_HEADER_STATUS]:Rn.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let n=this.handlers.get(e);return n===void 0?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):n}_respondWithError(e,n,r=null){let i=new Wn.Http2ServerCallStream(n,null,this.options);e.code===void 0&&(e.code=Jt.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed()),i.sendError(e)}_channelzHandler(e,n){let r=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),r?.streamTracker.addCallStarted(),!this._verifyContentType(e,n)){this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed();return}let i=n[$v],s=this._retrieveHandler(i);if(!s){this._respondWithError(Bh(i),e,r);return}let o=new Wn.Http2ServerCallStream(e,s,this.options);o.once("callEnd",a=>{a===Jt.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),r&&(o.once("streamEnd",a=>{a?r.streamTracker.addCallSucceeded():r.streamTracker.addCallFailed()}),o.on("sendMessage",()=>{r.messagesSent+=1,r.lastMessageSentTimestamp=new Date}),o.on("receiveMessage",()=>{r.messagesReceived+=1,r.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(o,s,n)||(this.callTracker.addCallFailed(),r?.streamTracker.addCallFailed(),o.sendError({code:Jt.Status.INTERNAL,details:`Unknown handler type: ${s.type}`}))}_streamHandler(e,n){if(this._verifyContentType(e,n)!==!0)return;let r=n[$v],i=this._retrieveHandler(r);if(!i){this._respondWithError(Bh(r),e,null);return}let s=new Wn.Http2ServerCallStream(e,i,this.options);this._runHandlerForCall(s,i,n)||s.sendError({code:Jt.Status.INTERNAL,details:`Unknown handler type: ${i.type}`})}_runHandlerForCall(e,n,r){var i;let s=e.receiveMetadata(r),o=(i=s.get("grpc-encoding")[0])!==null&&i!==void 0?i:"identity";s.remove("grpc-encoding");let{type:a}=n;if(a==="unary")nA(e,n,s,o);else if(a==="clientStream")rA(e,n,s,o);else if(a==="serverStream")iA(e,n,s,o);else if(a==="bidi")sA(e,n,s,o);else return!1;return!0}_setupHandlers(e){if(e===null)return;let n=e.address(),r="null";n&&(typeof n=="string"?r=n:r=n.address+":"+n.port),this.serverAddressString=r;let i=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",i.bind(this)),e.on("session",s=>{var o,a,l,c,h;if(!this.started){s.destroy();return}let d=(0,$e.registerChannelzSocket)((o=s.socket.remoteAddress)!==null&&o!==void 0?o:"unknown",this.getChannelzSessionInfoGetter(s),this.channelzEnabled),f={ref:d,streamTracker:new $e.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(s,f);let p=s.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+p),this.sessionChildrenTracker.refChild(d));let y=null,S=null,C=!1;if(this.maxConnectionAgeMs!==Aa){let T=this.maxConnectionAgeMs/10,N=Math.random()*T*2-T;y=(l=(a=setTimeout(()=>{var A,M;C=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+p);try{s.goaway(Rn.constants.NGHTTP2_NO_ERROR,~(1<<31),Buffer.from("max_age"))}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==Aa&&(S=(M=(A=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs)).unref)===null||M===void 0?void 0:M.call(A))},this.maxConnectionAgeMs+N)).unref)===null||l===void 0?void 0:l.call(a)}let _=(h=(c=setInterval(()=>{var T,N;let A=(N=(T=setTimeout(()=>{C=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+p),s.close()},this.keepaliveTimeoutMs)).unref)===null||N===void 0?void 0:N.call(T);try{s.ping((M,L,V)=>{clearTimeout(A)})}catch{s.destroy()}},this.keepaliveTimeMs)).unref)===null||h===void 0?void 0:h.call(c);s.on("close",()=>{this.channelzEnabled&&(C||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+p),this.sessionChildrenTracker.unrefChild(d),(0,$e.unregisterChannelzRef)(d)),y&&clearTimeout(y),S&&clearTimeout(S),_&&clearTimeout(_),this.sessions.delete(s)})})}};Ra.Server=qh;function nA(t,e,n,r){return U(this,null,function*(){try{let i=yield t.receiveUnaryMessage(r);if(i===void 0||t.cancelled)return;let s=new Wn.ServerUnaryCallImpl(t,n,i);e.func(s,(o,a,l,c)=>{t.sendUnaryMessage(o,a,l,c)})}catch(i){t.sendError(i)}})}function rA(t,e,n,r){let i=new Wn.ServerReadableStreamImpl(t,n,e.deserialize,r);function s(o,a,l,c){i.destroy(),t.sendUnaryMessage(o,a,l,c)}t.cancelled||(i.on("error",s),e.func(i,s))}function iA(t,e,n,r){return U(this,null,function*(){try{let i=yield t.receiveUnaryMessage(r);if(i===void 0||t.cancelled)return;let s=new Wn.ServerWritableStreamImpl(t,n,e.serialize,i);e.func(s)}catch(i){t.sendError(i)}})}function sA(t,e,n,r){let i=new Wn.ServerDuplexStreamImpl(t,n,e.serialize,e.deserialize,r);t.cancelled||e.func(i)}});var Kv=g(Da=>{"use strict";Object.defineProperty(Da,"__esModule",{value:!0});Da.StatusBuilder=void 0;var Uh=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};Da.StatusBuilder=Uh});var Vh=g(Dn=>{"use strict";Object.defineProperty(Dn,"__esModule",{value:!0});Dn.isDuration=Dn.durationToMs=Dn.msToDuration=void 0;function oA(t){return{seconds:t/1e3|0,nanos:t%1e3*1e6|0}}Dn.msToDuration=oA;function aA(t){return t.seconds*1e3+t.nanos/1e6|0}Dn.durationToMs=aA;function lA(t){return typeof t.seconds=="number"&&typeof t.nanos=="number"}Dn.isDuration=lA});var Qh=g(Nn=>{"use strict";var zh;Object.defineProperty(Nn,"__esModule",{value:!0});Nn.setup=Nn.OutlierDetectionLoadBalancer=Nn.OutlierDetectionLoadBalancingConfig=void 0;var ka=et(),Qv=$(),Kn=Vh(),Yv=Yh(),Xv=on(),cA=lo(),uA=un(),Hv=It(),hA=Sa(),dA=le(),fA="outlier_detection";function Ee(t){dA.trace(Qv.LogVerbosity.DEBUG,fA,t)}var Hh="outlier_detection",pA=((zh=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&zh!==void 0?zh:"true")==="true",gA={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},mA={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function jr(t,e,n,r){if(e in t&&typeof t[e]!==n){let i=r?`${r}.${e}`:e;throw new Error(`outlier detection config ${i} parse error: expected ${n}, got ${typeof t[e]}`)}}function Gh(t,e,n){let r=n?`${n}.${e}`:e;if(e in t){if(!(0,Kn.isDuration)(t[e]))throw new Error(`outlier detection config ${r} parse error: expected Duration, got ${typeof t[e]}`);if(!(t[e].seconds>=0&&t[e].seconds<=315576e6&&t[e].nanos>=0&&t[e].nanos<=999999999))throw new Error(`outlier detection config ${r} parse error: values out of range for non-negative Duaration`)}}function Na(t,e,n){let r=n?`${n}.${e}`:e;if(jr(t,e,"number",n),e in t&&!(t[e]>=0&&t[e]<=100))throw new Error(`outlier detection config ${r} parse error: value out of range for percentage (0-100)`)}var Zi=class t{constructor(e,n,r,i,s,o,a){if(this.childPolicy=a,a.length>0&&a[0].getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=n??3e4,this.maxEjectionTimeMs=r??3e5,this.maxEjectionPercent=i??10,this.successRateEjection=s?Object.assign(Object.assign({},gA),s):null,this.failurePercentageEjection=o?Object.assign(Object.assign({},mA),o):null}getLoadBalancerName(){return Hh}toJsonObject(){return{interval:(0,Kn.msToDuration)(this.intervalMs),base_ejection_time:(0,Kn.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,Kn.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new t(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var n;if(Gh(e,"interval"),Gh(e,"base_ejection_time"),Gh(e,"max_ejection_time"),Na(e,"max_ejection_percent"),"success_rate_ejection"in e){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");jr(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),Na(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),jr(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),jr(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");Na(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),Na(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),jr(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),jr(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new t(e.interval?(0,Kn.durationToMs)(e.interval):null,e.base_ejection_time?(0,Kn.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,Kn.durationToMs)(e.max_ejection_time):null,(n=e.max_ejection_percent)!==null&&n!==void 0?n:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(Xv.validateLoadBalancingConfig))}};Nn.OutlierDetectionLoadBalancingConfig=Zi;var $h=class extends hA.BaseSubchannelWrapper{constructor(e,n){super(e),this.mapEntry=n,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((r,i,s,o)=>{if(this.childSubchannelState=s,!this.ejected)for(let a of this.stateListeners)a(this,i,s,o)})}getConnectivityState(){return this.ejected?ka.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let n=this.stateListeners.indexOf(e);n>-1&&this.stateListeners.splice(n,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.ejected=!0;for(let e of this.stateListeners)e(this,this.childSubchannelState,ka.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){this.ejected=!1;for(let e of this.stateListeners)e(this,ka.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function jh(){return{success:0,failure:0}}var Wh=class{constructor(){this.activeBucket=jh(),this.inactiveBucket=jh()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=jh()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},Kh=class{constructor(e,n){this.wrappedPicker=e,this.countCalls=n}pick(e){let n=this.wrappedPicker.pick(e);if(n.pickResultType===uA.PickResultType.COMPLETE){let r=n.subchannel,i=r.getMapEntry();if(i){let s=n.onCallEnded;return this.countCalls&&(s=o=>{var a;o===Qv.Status.OK?i.counter.addSuccess():i.counter.addFailure(),(a=n.onCallEnded)===null||a===void 0||a.call(n,o)}),Object.assign(Object.assign({},n),{subchannel:r.getWrappedSubchannel(),onCallEnded:s})}else return Object.assign(Object.assign({},n),{subchannel:r.getWrappedSubchannel()})}else return n}},Oa=class{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new cA.ChildLoadBalancerHandler((0,Yv.createChildChannelControlHelper)(e,{createSubchannel:(n,r)=>{let i=e.createSubchannel(n,r),s=this.addressMap.get((0,Hv.subchannelAddressToString)(n)),o=new $h(i,s);return s?.currentEjectionTimestamp!==null&&o.eject(),s?.subchannelWrappers.push(o),o},updateState:(n,r)=>{n===ka.ConnectivityState.READY?e.updateState(n,new Kh(r,this.isCountingEnabled())):e.updateState(n,r)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let n of this.addressMap.values())n.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let n=this.latestConfig.getSuccessRateEjectionConfig();if(!n)return;Ee("Running success rate check");let r=n.request_volume,i=0,s=[];for(let[d,f]of this.addressMap){let p=f.counter.getLastSuccesses(),y=f.counter.getLastFailures();Ee("Stats for "+d+": successes="+p+" failures="+y+" targetRequestVolume="+r),p+y>=r&&(i+=1,s.push(p/(p+y)))}if(Ee("Found "+i+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),i<n.minimum_hosts)return;let o=s.reduce((d,f)=>d+f)/s.length,a=0;for(let d of s){let f=d-o;a+=f*f}let l=a/s.length,c=Math.sqrt(l),h=o-c*(n.stdev_factor/1e3);Ee("stdev="+c+" ejectionThreshold="+h);for(let[d,f]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let p=f.counter.getLastSuccesses(),y=f.counter.getLastFailures();if(p+y<r)continue;let S=p/(p+y);if(Ee("Checking candidate "+d+" successRate="+S),S<h){let C=Math.random()*100;Ee("Candidate "+d+" randomNumber="+C+" enforcement_percentage="+n.enforcement_percentage),C<n.enforcement_percentage&&(Ee("Ejecting candidate "+d),this.eject(f,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let n=this.latestConfig.getFailurePercentageEjectionConfig();if(!n)return;Ee("Running failure percentage check. threshold="+n.threshold+" request volume threshold="+n.request_volume);let r=0;for(let i of this.addressMap.values()){let s=i.counter.getLastSuccesses(),o=i.counter.getLastFailures();s+o>=n.request_volume&&(r+=1)}if(!(r<n.minimum_hosts))for(let[i,s]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let o=s.counter.getLastSuccesses(),a=s.counter.getLastFailures();if(Ee("Candidate successes="+o+" failures="+a),o+a<n.request_volume)continue;if(a*100/(a+o)>n.threshold){let c=Math.random()*100;Ee("Candidate "+i+" randomNumber="+c+" enforcement_percentage="+n.enforcement_percentage),c<n.enforcement_percentage&&(Ee("Ejecting candidate "+i),this.eject(s,e))}}}eject(e,n){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let r of e.subchannelWrappers)r.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let n of e.subchannelWrappers)n.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var n,r;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(r=(n=this.ejectionTimer).unref)===null||r===void 0||r.call(n)}runChecks(){let e=new Date;if(Ee("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[n,r]of this.addressMap.entries())if(r.currentEjectionTimestamp===null)r.ejectionTimeMultiplier>0&&(r.ejectionTimeMultiplier-=1);else{let i=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),o=new Date(r.currentEjectionTimestamp.getTime());o.setMilliseconds(o.getMilliseconds()+Math.min(i*r.ejectionTimeMultiplier,Math.max(i,s))),o<new Date&&(Ee("Unejecting "+n),this.uneject(r))}}}updateAddressList(e,n,r){if(!(n instanceof Zi))return;let i=new Set;for(let o of e)i.add((0,Hv.subchannelAddressToString)(o));for(let o of i)this.addressMap.has(o)||(Ee("Adding map entry for "+o),this.addressMap.set(o,{counter:new Wh,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let o of this.addressMap.keys())i.has(o)||(Ee("Removing map entry for "+o),this.addressMap.delete(o));let s=(0,Xv.getFirstUsableConfig)(n.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,s,r),n.getSuccessRateEjectionConfig()||n.getFailurePercentageEjectionConfig())if(this.timerStartTime){Ee("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let o=n.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(o)}else Ee("Starting new timer"),this.timerStartTime=new Date,this.startTimer(n.getIntervalMs()),this.switchAllBuckets();else{Ee("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let o of this.addressMap.values())this.uneject(o),o.ejectionTimeMultiplier=0}this.latestConfig=n}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return Hh}};Nn.OutlierDetectionLoadBalancer=Oa;function yA(){pA&&(0,Yv.registerLoadBalancerType)(Hh,Oa,Zi)}Nn.setup=yA});var Yh=g(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.OutlierDetectionLoadBalancingConfig=F.BaseSubchannelWrapper=F.registerAdminService=F.FilterStackFactory=F.BaseFilter=F.PickResultType=F.QueuePicker=F.UnavailablePicker=F.ChildLoadBalancerHandler=F.subchannelAddressToString=F.validateLoadBalancingConfig=F.getFirstUsableConfig=F.registerLoadBalancerType=F.createChildChannelControlHelper=F.BackoffTimeout=F.durationToMs=F.uriToString=F.createResolver=F.registerResolver=F.log=F.trace=void 0;var Jv=le();Object.defineProperty(F,"trace",{enumerable:!0,get:function(){return Jv.trace}});Object.defineProperty(F,"log",{enumerable:!0,get:function(){return Jv.log}});var Zv=_t();Object.defineProperty(F,"registerResolver",{enumerable:!0,get:function(){return Zv.registerResolver}});Object.defineProperty(F,"createResolver",{enumerable:!0,get:function(){return Zv.createResolver}});var vA=Qe();Object.defineProperty(F,"uriToString",{enumerable:!0,get:function(){return vA.uriToString}});var SA=Vh();Object.defineProperty(F,"durationToMs",{enumerable:!0,get:function(){return SA.durationToMs}});var TA=Ei();Object.defineProperty(F,"BackoffTimeout",{enumerable:!0,get:function(){return TA.BackoffTimeout}});var xa=on();Object.defineProperty(F,"createChildChannelControlHelper",{enumerable:!0,get:function(){return xa.createChildChannelControlHelper}});Object.defineProperty(F,"registerLoadBalancerType",{enumerable:!0,get:function(){return xa.registerLoadBalancerType}});Object.defineProperty(F,"getFirstUsableConfig",{enumerable:!0,get:function(){return xa.getFirstUsableConfig}});Object.defineProperty(F,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return xa.validateLoadBalancingConfig}});var EA=It();Object.defineProperty(F,"subchannelAddressToString",{enumerable:!0,get:function(){return EA.subchannelAddressToString}});var wA=lo();Object.defineProperty(F,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return wA.ChildLoadBalancerHandler}});var Xh=un();Object.defineProperty(F,"UnavailablePicker",{enumerable:!0,get:function(){return Xh.UnavailablePicker}});Object.defineProperty(F,"QueuePicker",{enumerable:!0,get:function(){return Xh.QueuePicker}});Object.defineProperty(F,"PickResultType",{enumerable:!0,get:function(){return Xh.PickResultType}});var CA=ia();Object.defineProperty(F,"BaseFilter",{enumerable:!0,get:function(){return CA.BaseFilter}});var _A=ch();Object.defineProperty(F,"FilterStackFactory",{enumerable:!0,get:function(){return _A.FilterStackFactory}});var bA=uo();Object.defineProperty(F,"registerAdminService",{enumerable:!0,get:function(){return bA.registerAdminService}});var IA=Sa();Object.defineProperty(F,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return IA.BaseSubchannelWrapper}});var AA=Qh();Object.defineProperty(F,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return AA.OutlierDetectionLoadBalancingConfig}})});var eS=g(Ma=>{"use strict";Object.defineProperty(Ma,"__esModule",{value:!0});Ma.setup=void 0;var RA=_t(),Jh=class{constructor(e,n,r){this.listener=n,this.addresses=[],this.hasReturnedResult=!1;let i;e.authority===""?i="/"+e.path:i=e.path,this.addresses=[{path:i}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}};function DA(){(0,RA.registerResolver)("unix",Jh)}Ma.setup=DA});var sS=g(Fa=>{"use strict";Object.defineProperty(Fa,"__esModule",{value:!0});Fa.setup=void 0;var tS=K("net"),Pa=$(),Zh=Ve(),nS=_t(),rS=Qe(),NA=le(),kA="ip_resolver";function iS(t){NA.trace(Pa.LogVerbosity.DEBUG,kA,t)}var ed="ipv4",td="ipv6",OA=443,La=class{constructor(e,n,r){var i;this.listener=n,this.addresses=[],this.error=null,this.hasReturnedResult=!1,iS("Resolver constructed for target "+(0,rS.uriToString)(e));let s=[];if(!(e.scheme===ed||e.scheme===td)){this.error={code:Pa.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new Zh.Metadata};return}let o=e.path.split(",");for(let a of o){let l=(0,rS.splitHostPort)(a);if(l===null){this.error={code:Pa.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new Zh.Metadata};return}if(e.scheme===ed&&!(0,tS.isIPv4)(l.host)||e.scheme===td&&!(0,tS.isIPv6)(l.host)){this.error={code:Pa.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new Zh.Metadata};return}s.push({host:l.host,port:(i=l.port)!==null&&i!==void 0?i:OA})}this.addresses=s,iS("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function xA(){(0,nS.registerResolver)(ed,La),(0,nS.registerResolver)(td,La)}Fa.setup=xA});var lS=g(qt=>{"use strict";Object.defineProperty(qt,"__esModule",{value:!0});qt.setup=qt.PickFirstLoadBalancer=qt.shuffled=qt.PickFirstLoadBalancingConfig=void 0;var oS=on(),Pe=et(),Ba=un(),MA=le(),PA=$(),LA="pick_first";function nd(t){MA.trace(PA.LogVerbosity.DEBUG,LA,t)}var es="pick_first",FA=250,ts=class t{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return es}toJsonObject(){return{[es]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new t(e.shuffleAddressList===!0)}};qt.PickFirstLoadBalancingConfig=ts;var rd=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:Ba.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function aS(t){let e=t.slice();for(let n=e.length-1;n>1;n--){let r=Math.floor(Math.random()*(n+1)),i=e[n];e[n]=e[r],e[r]=i}return e}qt.shuffled=aS;var qa=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=Pe.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(n,r,i,s,o)=>{this.onSubchannelStateUpdate(n,r,i,o)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(Pe.ConnectivityState.READY,new rd(this.currentPick)):this.children.length===0?this.updateState(Pe.ConnectivityState.IDLE,new Ba.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(Pe.ConnectivityState.TRANSIENT_FAILURE,new Ba.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(Pe.ConnectivityState.CONNECTING,new Ba.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(this.currentPick!==null){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,n,r,i){var s;if(!((s=this.currentPick)===null||s===void 0)&&s.realSubchannelEquals(e)){r!==Pe.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[o,a]of this.children.entries())if(e.realSubchannelEquals(a.subchannel)){r===Pe.ConnectivityState.READY&&this.pickSubchannel(a.subchannel),r===Pe.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0,i&&(this.lastError=i),this.maybeEnterStickyTransientFailureMode(),o===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(o+1)),a.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[n,r]of this.children.entries())if(n>=e){let i=r.subchannel.getConnectivityState();if(i===Pe.ConnectivityState.IDLE||i===Pe.ConnectivityState.CONNECTING){this.startConnecting(n);return}}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var n,r;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===Pe.ConnectivityState.IDLE&&(nd("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var i;(i=this.children[e])===null||i===void 0||i.subchannel.startConnecting()})),this.connectionDelayTimeout=(r=(n=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},FA)).unref)===null||r===void 0?void 0:r.call(n)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(nd("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,this.currentPick!==null&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,n){nd(Pe.ConnectivityState[this.currentState]+" -> "+Pe.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,n)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let n=e.map(r=>({subchannel:this.channelControlHelper.createSubchannel(r,{}),hasReportedTransientFailure:!1}));for(let{subchannel:r}of n)r.ref(),this.channelControlHelper.addChannelzChild(r.getChannelzRef());this.resetSubchannelList(),this.children=n;for(let{subchannel:r}of this.children)if(r.addConnectivityStateListener(this.subchannelStateListener),r.getConnectivityState()===Pe.ConnectivityState.READY){this.pickSubchannel(r);return}for(let r of this.children)r.subchannel.getConnectivityState()===Pe.ConnectivityState.TRANSIENT_FAILURE&&(r.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,n){n instanceof ts&&(n.getShuffleAddressList()&&(e=aS(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===Pe.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return es}};qt.PickFirstLoadBalancer=qa;function BA(){(0,oS.registerLoadBalancerType)(es,qa,ts),(0,oS.registerDefaultLoadBalancerType)(es)}qt.setup=BA});var uS=g($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});$r.setup=$r.RoundRobinLoadBalancer=void 0;var qA=on(),Le=et(),Ua=un(),UA=It(),VA=le(),zA=$(),GA="round_robin";function cS(t){VA.trace(zA.LogVerbosity.DEBUG,GA,t)}var Va="round_robin",id=class t{getLoadBalancerName(){return Va}constructor(){}toJsonObject(){return{[Va]:{}}}static createFromJson(e){return new t}},sd=class{constructor(e,n=0){this.subchannelList=e,this.nextIndex=n}pick(e){let n=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:Ua.PickResultType.COMPLETE,subchannel:n,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}},za=class{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=Le.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(n,r,i,s,o)=>{this.calculateAndUpdateState(),(i===Le.ConnectivityState.TRANSIENT_FAILURE||i===Le.ConnectivityState.IDLE)&&(o&&(this.lastError=o),this.channelControlHelper.requestReresolution(),n.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(n=>n.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(Le.ConnectivityState.READY)>0){let e=this.subchannels.filter(r=>r.getConnectivityState()===Le.ConnectivityState.READY),n=0;this.currentReadyPicker!==null&&(n=e.indexOf(this.currentReadyPicker.peekNextSubchannel()),n<0&&(n=0)),this.updateState(Le.ConnectivityState.READY,new sd(e,n))}else this.countSubchannelsWithState(Le.ConnectivityState.CONNECTING)>0?this.updateState(Le.ConnectivityState.CONNECTING,new Ua.QueuePicker(this)):this.countSubchannelsWithState(Le.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(Le.ConnectivityState.TRANSIENT_FAILURE,new Ua.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(Le.ConnectivityState.IDLE,new Ua.QueuePicker(this))}updateState(e,n){cS(Le.ConnectivityState[this.currentState]+" -> "+Le.ConnectivityState[e]),e===Le.ConnectivityState.READY?this.currentReadyPicker=n:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,n)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,n){this.resetSubchannelList(),cS("Connect to address list "+e.map(r=>(0,UA.subchannelAddressToString)(r))),this.subchannels=e.map(r=>this.channelControlHelper.createSubchannel(r,{}));for(let r of this.subchannels){r.ref(),r.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(r.getChannelzRef());let i=r.getConnectivityState();(i===Le.ConnectivityState.IDLE||i===Le.ConnectivityState.TRANSIENT_FAILURE)&&r.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return Va}};$r.RoundRobinLoadBalancer=za;function jA(){(0,qA.registerLoadBalancerType)(Va,za,id)}$r.setup=jA});var pS=g(D=>{"use strict";Object.defineProperty(D,"__esModule",{value:!0});D.experimental=D.addAdminServicesToServer=D.getChannelzHandlers=D.getChannelzServiceDefinition=D.InterceptorConfigurationError=D.InterceptingCall=D.RequesterBuilder=D.ListenerBuilder=D.StatusBuilder=D.getClientChannel=D.ServerCredentials=D.Server=D.setLogVerbosity=D.setLogger=D.load=D.loadObject=D.CallCredentials=D.ChannelCredentials=D.waitForClientReady=D.closeClient=D.Channel=D.makeGenericClientConstructor=D.makeClientConstructor=D.loadPackageDefinition=D.Client=D.compressionAlgorithms=D.propagate=D.connectivityState=D.status=D.logVerbosity=D.Metadata=D.credentials=void 0;var Ga=tc();Object.defineProperty(D,"CallCredentials",{enumerable:!0,get:function(){return Ga.CallCredentials}});var $A=xc();Object.defineProperty(D,"Channel",{enumerable:!0,get:function(){return $A.ChannelImplementation}});var WA=uh();Object.defineProperty(D,"compressionAlgorithms",{enumerable:!0,get:function(){return WA.CompressionAlgorithms}});var KA=et();Object.defineProperty(D,"connectivityState",{enumerable:!0,get:function(){return KA.ConnectivityState}});var ja=to();Object.defineProperty(D,"ChannelCredentials",{enumerable:!0,get:function(){return ja.ChannelCredentials}});var hS=Oc();Object.defineProperty(D,"Client",{enumerable:!0,get:function(){return hS.Client}});var od=$();Object.defineProperty(D,"logVerbosity",{enumerable:!0,get:function(){return od.LogVerbosity}});Object.defineProperty(D,"status",{enumerable:!0,get:function(){return od.Status}});Object.defineProperty(D,"propagate",{enumerable:!0,get:function(){return od.Propagate}});var dS=le(),ad=Pc();Object.defineProperty(D,"loadPackageDefinition",{enumerable:!0,get:function(){return ad.loadPackageDefinition}});Object.defineProperty(D,"makeClientConstructor",{enumerable:!0,get:function(){return ad.makeClientConstructor}});Object.defineProperty(D,"makeGenericClientConstructor",{enumerable:!0,get:function(){return ad.makeClientConstructor}});var HA=Ve();Object.defineProperty(D,"Metadata",{enumerable:!0,get:function(){return HA.Metadata}});var QA=Wv();Object.defineProperty(D,"Server",{enumerable:!0,get:function(){return QA.Server}});var YA=Fh();Object.defineProperty(D,"ServerCredentials",{enumerable:!0,get:function(){return YA.ServerCredentials}});var XA=Kv();Object.defineProperty(D,"StatusBuilder",{enumerable:!0,get:function(){return XA.StatusBuilder}});D.credentials={combineChannelCredentials:(t,...e)=>e.reduce((n,r)=>n.compose(r),t),combineCallCredentials:(t,...e)=>e.reduce((n,r)=>n.compose(r),t),createInsecure:ja.ChannelCredentials.createInsecure,createSsl:ja.ChannelCredentials.createSsl,createFromSecureContext:ja.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:Ga.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:Ga.CallCredentials.createFromGoogleCredential,createEmpty:Ga.CallCredentials.createEmpty};var JA=t=>t.close();D.closeClient=JA;var ZA=(t,e,n)=>t.waitForReady(e,n);D.waitForClientReady=ZA;var eR=(t,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};D.loadObject=eR;var tR=(t,e,n)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};D.load=tR;var nR=t=>{dS.setLogger(t)};D.setLogger=nR;var rR=t=>{dS.setLoggerVerbosity(t)};D.setLogVerbosity=rR;var iR=t=>hS.Client.prototype.getChannel.call(t);D.getClientChannel=iR;var $a=Dc();Object.defineProperty(D,"ListenerBuilder",{enumerable:!0,get:function(){return $a.ListenerBuilder}});Object.defineProperty(D,"RequesterBuilder",{enumerable:!0,get:function(){return $a.RequesterBuilder}});Object.defineProperty(D,"InterceptingCall",{enumerable:!0,get:function(){return $a.InterceptingCall}});Object.defineProperty(D,"InterceptorConfigurationError",{enumerable:!0,get:function(){return $a.InterceptorConfigurationError}});var fS=jn();Object.defineProperty(D,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return fS.getChannelzServiceDefinition}});Object.defineProperty(D,"getChannelzHandlers",{enumerable:!0,get:function(){return fS.getChannelzHandlers}});var sR=uo();Object.defineProperty(D,"addAdminServicesToServer",{enumerable:!0,get:function(){return sR.addAdminServicesToServer}});var oR=Yh();D.experimental=oR;var aR=Xu(),lR=eS(),cR=sS(),uR=lS(),hR=uS(),dR=Qh(),fR=jn();aR.setup(),lR.setup(),cR.setup(),uR.setup(),hR.setup(),dR.setup(),fR.setup()});var yf=(()=>{let e=class e{constructor(){this.title="sdlc"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Yn({type:e,selectors:[["app-root"]],standalone:!0,features:[Jn],decls:1,vars:0,template:function(i,s){i&1&&cs(0,"router-outlet")},dependencies:[jd,us]});let t=e;return t})();var vf=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Yn({type:e,selectors:[["app-not-found"]],standalone:!0,features:[Jn],decls:2,vars:0,template:function(i,s){i&1&&(qd(0,"p"),Vd(1,"not-found works!"),Ud())}});let t=e;return t})();var Sf=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Yn({type:e,selectors:[["app-layout"]],standalone:!0,features:[Jn],decls:1,vars:0,template:function(i,s){i&1&&cs(0,"router-outlet")},dependencies:[us]});let t=e;return t})();var Tf=[{path:"",loadChildren:()=>import("./chunk-KG7JK5O4.mjs").then(t=>t.landing_routes)},{path:"admin",loadChildren:()=>import("./chunk-7LLXFU2V.mjs").then(t=>t.admin_routes)},{path:"project",loadChildren:()=>import("./chunk-VSTQJV5S.mjs").then(t=>t.project_routes)},{path:"signup",loadComponent:()=>import("./chunk-BUISCEKD.mjs").then(t=>t.SignupComponent)},{path:"forget",loadComponent:()=>import("./chunk-B7MYAMHN.mjs").then(t=>t.LoginComponent)}];var Ef=[{path:"",redirectTo:"",pathMatch:"full"},{path:"",component:Sf,children:Tf},{path:"**",component:vf}];var wf="auth",Xr=class{constructor(e){return e}},Jr=class{constructor(){return ps(wf)}};var el=new os("angularfire2.auth-instances");function JS(t,e){let n=fs(wf,t,e);return n&&new Xr(n)}function ZS(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new Xr(r)}}var eT={provide:Jr,deps:[[new Vt,el]]},tT={provide:Xr,useFactory:JS,deps:[[new Vt,el],vs]},nT=(()=>{class t{constructor(){xn("angularfire",ds.full,"auth")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=as({type:t});static \u0275inj=ss({providers:[tT,eT]})}return t})();function Cf(t,...e){return{ngModule:nT,providers:[{provide:el,useFactory:ZS(t),multi:!0,deps:[Xn,ls,ms,Ss,[new Vt,gs],...e]}]}}var _f=ys(uf,!0);import{inspect as pR,TextEncoder as kO,TextDecoder as OO}from"util";import{randomBytes as gR}from"crypto";var rT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dt={},I,wl=wl||{},P=rT||self;function Ms(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function di(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function iT(t){return Object.prototype.hasOwnProperty.call(t,tl)&&t[tl]||(t[tl]=++sT)}var tl="closure_uid_"+(1e9*Math.random()>>>0),sT=0;function oT(t,e,n){return t.call.apply(t.bind,arguments)}function aT(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Ne(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ne=oT:Ne=aT,Ne.apply(null,arguments)}function Es(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function ve(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function tn(){this.s=this.s,this.o=this.o}var lT=0;tn.prototype.s=!1;tn.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),lT!=0)&&iT(this)};tn.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Ff=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function Cl(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function bf(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(Ms(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function ke(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}ke.prototype.h=function(){this.defaultPrevented=!0};var cT=function(){if(!P.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};P.addEventListener("test",n,e),P.removeEventListener("test",n,e)}catch{}return t}();function ii(t){return/^[\s\xa0]*$/.test(t)}function Ps(){var t=P.navigator;return t&&(t=t.userAgent)?t:""}function Et(t){return Ps().indexOf(t)!=-1}function _l(t){return _l[" "](t),t}_l[" "]=function(){};function uT(t,e){var n=JT;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var hT=Et("Opera"),nr=Et("Trident")||Et("MSIE"),Bf=Et("Edge"),ol=Bf||nr,qf=Et("Gecko")&&!(Ps().toLowerCase().indexOf("webkit")!=-1&&!Et("Edge"))&&!(Et("Trident")||Et("MSIE"))&&!Et("Edge"),dT=Ps().toLowerCase().indexOf("webkit")!=-1&&!Et("Edge");function Uf(){var t=P.document;return t?t.documentMode:void 0}var al;e:{if(ws="",Cs=function(){var t=Ps();if(qf)return/rv:([^\);]+)(\)|;)/.exec(t);if(Bf)return/Edge\/([\d\.]+)/.exec(t);if(nr)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(dT)return/WebKit\/(\S+)/.exec(t);if(hT)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),Cs&&(ws=Cs?Cs[1]:""),nr&&(_s=Uf(),_s!=null&&_s>parseFloat(ws))){al=String(_s);break e}al=ws}var ws,Cs,_s,ll;P.document&&nr?(nl=Uf(),ll=nl||parseInt(al,10)||void 0):ll=void 0;var nl,fT=ll;function si(t,e){if(ke.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(qf){e:{try{_l(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:pT[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&si.$.h.call(this)}}ve(si,ke);var pT={2:"touch",3:"pen",4:"mouse"};si.prototype.h=function(){si.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var fi="closure_listenable_"+(1e6*Math.random()|0),gT=0;function mT(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++gT,this.fa=this.ia=!1}function Ls(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function bl(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function yT(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function Vf(t){let e={};for(let n in t)e[n]=t[n];return e}var If="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function zf(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<If.length;s++)n=If[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Fs(t){this.src=t,this.g={},this.h=0}Fs.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=ul(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new mT(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function cl(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=Ff(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Ls(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function ul(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var Il="closure_lm_"+(1e6*Math.random()|0),rl={};function Gf(t,e,n,r,i){if(r&&r.once)return $f(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Gf(t,e[s],n,r,i);return null}return n=Dl(n),t&&t[fi]?t.O(e,n,di(r)?!!r.capture:!!r,i):jf(t,e,n,!1,r,i)}function jf(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=di(i)?!!i.capture:!!i,a=Rl(t);if(a||(t[Il]=a=new Fs(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=vT(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)cT||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Kf(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function vT(){function t(n){return e.call(t.src,t.listener,n)}let e=ST;return t}function $f(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)$f(t,e[s],n,r,i);return null}return n=Dl(n),t&&t[fi]?t.P(e,n,di(r)?!!r.capture:!!r,i):jf(t,e,n,!0,r,i)}function Wf(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)Wf(t,e[s],n,r,i);else r=di(r)?!!r.capture:!!r,n=Dl(n),t&&t[fi]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=ul(s,n,r,i),-1<n&&(Ls(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=Rl(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ul(e,n,r,i)),(n=-1<t?e[t]:null)&&Al(n))}function Al(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[fi])cl(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Kf(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Rl(e))?(cl(n,t),n.h==0&&(n.src=null,e[Il]=null)):Ls(t)}}}function Kf(t){return t in rl?rl[t]:rl[t]="on"+t}function ST(t,e){if(t.fa)t=!0;else{e=new si(e,this);var n=t.listener,r=t.la||t.src;t.ia&&Al(t),t=n.call(r,e)}return t}function Rl(t){return t=t[Il],t instanceof Fs?t:null}var il="__closure_events_fn_"+(1e9*Math.random()>>>0);function Dl(t){return typeof t=="function"?t:(t[il]||(t[il]=function(e){return t.handleEvent(e)}),t[il])}function ye(){tn.call(this),this.i=new Fs(this),this.S=this,this.J=null}ve(ye,tn);ye.prototype[fi]=!0;ye.prototype.removeEventListener=function(t,e,n,r){Wf(this,t,e,n,r)};function be(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new ke(e,t);else if(e instanceof ke)e.target=e.target||t;else{var i=e;e=new ke(r,t),zf(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=bs(o,r,!0,e)&&i}if(o=e.g=t,i=bs(o,r,!0,e)&&i,i=bs(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=bs(o,r,!1,e)&&i}ye.prototype.N=function(){if(ye.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Ls(n[r]);delete t.g[e],t.h--}}this.J=null};ye.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};ye.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function bs(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&cl(t.i,o),i=a.call(l,r)!==!1&&i}}return i&&!r.defaultPrevented}var Nl=P.JSON.stringify,hl=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function TT(){var t=kl;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var dl=class{constructor(){this.h=this.g=null}add(e,n){let r=Hf.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},Hf=new hl(()=>new fl,t=>t.reset()),fl=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function ET(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function wT(t){P.setTimeout(()=>{throw t},0)}var oi,ai=!1,kl=new dl,Qf=()=>{let t=P.Promise.resolve(void 0);oi=()=>{t.then(CT)}},CT=()=>{for(var t;t=TT();){try{t.h.call(t.g)}catch(n){wT(n)}var e=Hf;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}ai=!1};function Bs(t,e){ye.call(this),this.h=t||1,this.g=e||P,this.j=Ne(this.qb,this),this.l=Date.now()}ve(Bs,ye);I=Bs.prototype;I.ga=!1;I.T=null;I.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),be(this,"tick"),this.ga&&(Ol(this),this.start()))}};I.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Ol(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}I.N=function(){Bs.$.N.call(this),Ol(this),delete this.g};function xl(t,e,n){if(typeof t=="function")n&&(t=Ne(t,n));else if(t&&typeof t.handleEvent=="function")t=Ne(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:P.setTimeout(t,e||0)}function Yf(t){t.g=xl(()=>{t.g=null,t.i&&(t.i=!1,Yf(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var pl=class extends tn{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Yf(this)}N(){super.N(),this.g&&(P.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function li(t){tn.call(this),this.h=t,this.g={}}ve(li,tn);var Af=[];function Xf(t,e,n,r){Array.isArray(n)||(n&&(Af[0]=n.toString()),n=Af);for(var i=0;i<n.length;i++){var s=Gf(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Jf(t){bl(t.g,function(e,n){this.g.hasOwnProperty(n)&&Al(e)},t),t.g={}}li.prototype.N=function(){li.$.N.call(this),Jf(this)};li.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function qs(){this.g=!0}qs.prototype.Ea=function(){this.g=!1};function _T(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var c=a[l].split("=");if(1<c.length){var h=c[0];c=c[1];var d=h.split("_");o=2<=d.length&&d[1]=="type"?o+(h+"="+c+"&"):o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function bT(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function er(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+AT(t,n)+(r?" "+r:"")})}function IT(t,e){t.info(function(){return"TIMEOUT: "+e})}qs.prototype.info=function(){};function AT(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Nl(n)}catch{return e}}var Fn={},Rf=null;function Us(){return Rf=Rf||new ye}Fn.Ta="serverreachability";function Zf(t){ke.call(this,Fn.Ta,t)}ve(Zf,ke);function ci(t){let e=Us();be(e,new Zf(e))}Fn.STAT_EVENT="statevent";function ep(t,e){ke.call(this,Fn.STAT_EVENT,t),this.stat=e}ve(ep,ke);function qe(t){let e=Us();be(e,new ep(e,t))}Fn.Ua="timingevent";function tp(t,e){ke.call(this,Fn.Ua,t),this.size=e}ve(tp,ke);function pi(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return P.setTimeout(function(){t()},e)}var Vs={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},np={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Ml(){}Ml.prototype.h=null;function Df(t){return t.h||(t.h=t.i())}function rp(){}var gi={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Pl(){ke.call(this,"d")}ve(Pl,ke);function Ll(){ke.call(this,"c")}ve(Ll,ke);var gl;function zs(){}ve(zs,Ml);zs.prototype.g=function(){return new XMLHttpRequest};zs.prototype.i=function(){return{}};gl=new zs;function mi(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new li(this),this.P=RT,t=ol?125:void 0,this.V=new Bs(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new ip}function ip(){this.i=null,this.g="",this.h=!1}var RT=45e3,sp={},ml={};I=mi.prototype;I.setTimeout=function(t){this.P=t};function yl(t,e,n){t.L=1,t.A=js(Gt(e)),t.u=n,t.S=!0,op(t,null)}function op(t,e){t.G=Date.now(),yi(t),t.B=Gt(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),pp(n.i,"t",r),t.o=0,n=t.l.J,t.h=new ip,t.g=Pp(t.l,n?e:null,!t.u),0<t.O&&(t.M=new pl(Ne(t.Pa,t,t.g),t.O)),Xf(t.U,t.g,"readystatechange",t.nb),e=t.I?Vf(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),ci(),_T(t.j,t.v,t.B,t.m,t.W,t.u)}I.nb=function(t){t=t.target;let e=this.M;e&&wt(t)==3?e.l():this.Pa(t)};I.Pa=function(t){try{if(t==this.g)e:{let h=wt(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>h)&&(h!=3||ol||this.g&&(this.h.h||this.g.ja()||xf(this.g)))){this.J||h!=4||e==7||(e==8||0>=d?ci(3):ci(2)),Gs(this);var n=this.g.da();this.ca=n;t:if(ap(this)){var r=xf(this.g);t="";var i=r.length,s=wt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Mn(this),ri(this);var o="";break t}this.h.i=new P.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,bT(this.j,this.v,this.B,this.m,this.W,h,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ii(a)){var c=a;break t}}c=null}if(n=c)er(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,vl(this,n);else{this.i=!1,this.s=3,qe(12),Mn(this),ri(this);break e}}this.S?(lp(this,h,o),ol&&this.i&&h==3&&(Xf(this.U,this.V,"tick",this.mb),this.V.start())):(er(this.j,this.m,o,null),vl(this,o)),h==4&&Mn(this),this.i&&!this.J&&(h==4?kp(this.l,this):(this.i=!1,yi(this)))}else QT(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,qe(12)):(this.s=0,qe(13)),Mn(this),ri(this)}}}catch{}finally{}};function ap(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function lp(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=DT(t,n),i==ml){e==4&&(t.s=4,qe(14),r=!1),er(t.j,t.m,null,"[Incomplete Response]");break}else if(i==sp){t.s=4,qe(15),er(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else er(t.j,t.m,i,null),vl(t,i);ap(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,qe(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),zl(e),e.M=!0,qe(11))):(er(t.j,t.m,n,"[Invalid Chunked Response]"),Mn(t),ri(t))}I.mb=function(){if(this.g){var t=wt(this.g),e=this.g.ja();this.o<e.length&&(Gs(this),lp(this,t,e),this.i&&t!=4&&yi(this))}};function DT(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?ml:(n=Number(e.substring(n,r)),isNaN(n)?sp:(r+=1,r+n>e.length?ml:(e=e.slice(r,r+n),t.o=r+n,e)))}I.cancel=function(){this.J=!0,Mn(this)};function yi(t){t.Y=Date.now()+t.P,cp(t,t.P)}function cp(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=pi(Ne(t.lb,t),e)}function Gs(t){t.C&&(P.clearTimeout(t.C),t.C=null)}I.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(IT(this.j,this.B),this.L!=2&&(ci(),qe(17)),Mn(this),this.s=2,ri(this)):cp(this,this.Y-t)};function ri(t){t.l.H==0||t.J||kp(t.l,t)}function Mn(t){Gs(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Ol(t.V),Jf(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function vl(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Sl(n.i,t))){if(!t.K&&Sl(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Ns(n),Ks(n);else break e;Vl(n),qe(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=pi(Ne(n.ib,n),6e3));if(1>=yp(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Pn(n,11)}else if((t.K||n.g==t)&&Ns(n),!ii(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let h=c[3];h!=null&&(n.ra=h,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let f=c[5];f!=null&&typeof f=="number"&&0<f&&(r=1.5*f,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let p=t.g;if(p){let y=p.g?p.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(y){var s=r.i;s.g||y.indexOf("spdy")==-1&&y.indexOf("quic")==-1&&y.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Fl(s,s.h),s.h=null))}if(r.F){let S=p.g?p.g.getResponseHeader("X-HTTP-Session-Id"):null;S&&(r.Da=S,te(r.I,r.F,S))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=Mp(r,r.J?r.pa:null,r.Y),o.K){vp(r.i,o);var a=o,l=r.L;l&&a.setTimeout(l),a.C&&(Gs(a),yi(a)),r.g=o}else Dp(r);0<n.j.length&&Hs(n)}else c[0]!="stop"&&c[0]!="close"||Pn(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Pn(n,7):Ul(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}ci(4)}catch{}}function NT(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Ms(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function kT(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Ms(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function up(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Ms(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=kT(t),r=NT(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var hp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function OT(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Ln(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Ln){this.h=t.h,Rs(this,t.j),this.s=t.s,this.g=t.g,Ds(this,t.m),this.l=t.l;var e=t.i,n=new ui;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Nf(this,n),this.o=t.o}else t&&(e=String(t).match(hp))?(this.h=!1,Rs(this,e[1]||"",!0),this.s=ti(e[2]||""),this.g=ti(e[3]||"",!0),Ds(this,e[4]),this.l=ti(e[5]||"",!0),Nf(this,e[6]||"",!0),this.o=ti(e[7]||"")):(this.h=!1,this.i=new ui(null,this.h))}Ln.prototype.toString=function(){var t=[],e=this.j;e&&t.push(ni(e,kf,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(ni(e,kf,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(ni(n,n.charAt(0)=="/"?PT:MT,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",ni(n,FT)),t.join("")};function Gt(t){return new Ln(t)}function Rs(t,e,n){t.j=n?ti(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ds(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Nf(t,e,n){e instanceof ui?(t.i=e,BT(t.i,t.h)):(n||(e=ni(e,LT)),t.i=new ui(e,t.h))}function te(t,e,n){t.i.set(e,n)}function js(t){return te(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function ti(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function ni(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,xT),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function xT(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var kf=/[#\/\?@]/g,MT=/[#\?:]/g,PT=/[#\?]/g,LT=/[#\?@]/g,FT=/#/g;function ui(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function nn(t){t.g||(t.g=new Map,t.h=0,t.i&&OT(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}I=ui.prototype;I.add=function(t,e){nn(this),this.i=null,t=rr(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function dp(t,e){nn(t),e=rr(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function fp(t,e){return nn(t),e=rr(t,e),t.g.has(e)}I.forEach=function(t,e){nn(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};I.ta=function(){nn(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};I.Z=function(t){nn(this);let e=[];if(typeof t=="string")fp(this,t)&&(e=e.concat(this.g.get(rr(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};I.set=function(t,e){return nn(this),this.i=null,t=rr(this,t),fp(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};I.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function pp(t,e,n){dp(t,e),0<n.length&&(t.i=null,t.g.set(rr(t,e),Cl(n)),t.h+=n.length)}I.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function rr(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function BT(t,e){e&&!t.j&&(nn(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(dp(this,r),pp(this,i,n))},t)),t.j=e}var qT=class{constructor(t,e){this.g=t,this.map=e}};function gp(t){this.l=t||UT,P.PerformanceNavigationTiming?(t=P.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(P.g&&P.g.Ka&&P.g.Ka()&&P.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var UT=10;function mp(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function yp(t){return t.h?1:t.g?t.g.size:0}function Sl(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Fl(t,e){t.g?t.g.add(e):t.h=e}function vp(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}gp.prototype.cancel=function(){if(this.i=Sp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function Sp(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return Cl(t.i)}var VT=class{stringify(t){return P.JSON.stringify(t,void 0)}parse(t){return P.JSON.parse(t,void 0)}};function zT(){this.g=new VT}function GT(t,e,n){let r=n||"";try{up(t,function(i,s){let o=i;di(i)&&(o=Nl(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function jT(t,e){let n=new qs;if(P.Image){let r=new Image;r.onload=Es(Is,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Es(Is,n,r,"TestLoadImage: error",!1,e),r.onabort=Es(Is,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Es(Is,n,r,"TestLoadImage: timeout",!1,e),P.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Is(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function vi(t){this.l=t.ec||null,this.j=t.ob||!1}ve(vi,Ml);vi.prototype.g=function(){return new $s(this.l,this.j)};vi.prototype.i=function(t){return function(){return t}}({});function $s(t,e){ye.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Bl,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ve($s,ye);var Bl=0;I=$s.prototype;I.open=function(t,e){if(this.readyState!=Bl)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,hi(this)};I.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||P).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};I.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Si(this)),this.readyState=Bl};I.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,hi(this)),this.g&&(this.readyState=3,hi(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof P.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Tp(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function Tp(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}I.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Si(this):hi(this),this.readyState==3&&Tp(this)}};I.Za=function(t){this.g&&(this.response=this.responseText=t,Si(this))};I.Ya=function(t){this.g&&(this.response=t,Si(this))};I.ka=function(){this.g&&Si(this)};function Si(t){t.readyState=4,t.l=null,t.j=null,t.A=null,hi(t)}I.setRequestHeader=function(t,e){this.v.append(t,e)};I.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};I.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function hi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty($s.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var $T=P.JSON.parse;function ae(t){ye.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Ep,this.L=this.M=!1}ve(ae,ye);var Ep="",WT=/^https?$/i,KT=["POST","PUT"];I=ae.prototype;I.Oa=function(t){this.M=t};I.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():gl.g(),this.C=this.u?Df(this.u):Df(gl),this.g.onreadystatechange=Ne(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){Of(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=P.FormData&&t instanceof P.FormData,!(0<=Ff(KT,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{_p(this),0<this.B&&((this.L=HT(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ne(this.ua,this)):this.A=xl(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Of(this,s)}};function HT(t){return nr&&typeof t.timeout=="number"&&t.ontimeout!==void 0}I.ua=function(){typeof wl<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,be(this,"timeout"),this.abort(8))};function Of(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,wp(t),Ws(t)}function wp(t){t.F||(t.F=!0,be(t,"complete"),be(t,"error"))}I.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,be(this,"complete"),be(this,"abort"),Ws(this))};I.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ws(this,!0)),ae.$.N.call(this)};I.La=function(){this.s||(this.G||this.v||this.l?Cp(this):this.kb())};I.kb=function(){Cp(this)};function Cp(t){if(t.h&&typeof wl<"u"&&(!t.C[1]||wt(t)!=4||t.da()!=2)){if(t.v&&wt(t)==4)xl(t.La,0,t);else if(be(t,"readystatechange"),wt(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(hp)[1]||null;!i&&P.self&&P.self.location&&(i=P.self.location.protocol.slice(0,-1)),r=!WT.test(i?i.toLowerCase():"")}n=r}if(n)be(t,"complete"),be(t,"success");else{t.m=6;try{var s=2<wt(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",wp(t)}}finally{Ws(t)}}}}function Ws(t,e){if(t.g){_p(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||be(t,"ready");try{n.onreadystatechange=r}catch{}}}function _p(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(P.clearTimeout(t.A),t.A=null)}I.isActive=function(){return!!this.g};function wt(t){return t.g?t.g.readyState:0}I.da=function(){try{return 2<wt(this)?this.g.status:-1}catch{return-1}};I.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};I.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),$T(e)}};function xf(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Ep:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function QT(t){let e={};t=(t.g&&2<=wt(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(ii(t[r]))continue;var n=ET(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}yT(e,function(r){return r.join(", ")})}I.Ia=function(){return this.m};I.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function bp(t){let e="";return bl(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function ql(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=bp(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):te(t,e,n))}function Zr(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Ip(t){this.Ga=0,this.j=[],this.l=new qs,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Zr("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Zr("baseRetryDelayMs",5e3,t),this.hb=Zr("retryDelaySeedMs",1e4,t),this.eb=Zr("forwardChannelMaxRetries",2,t),this.xa=Zr("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new gp(t&&t.concurrentRequestLimit),this.Ja=new zT,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}I=Ip.prototype;I.ra=8;I.H=1;function Ul(t){if(Ap(t),t.H==3){var e=t.W++,n=Gt(t.I);if(te(n,"SID",t.K),te(n,"RID",e),te(n,"TYPE","terminate"),Ti(t,n),e=new mi(t,t.l,e),e.L=2,e.A=js(Gt(n)),n=!1,P.navigator&&P.navigator.sendBeacon)try{n=P.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&P.Image&&(new Image().src=e.A,n=!0),n||(e.g=Pp(e.l,null),e.g.ha(e.A)),e.G=Date.now(),yi(e)}xp(t)}function Ks(t){t.g&&(zl(t),t.g.cancel(),t.g=null)}function Ap(t){Ks(t),t.u&&(P.clearTimeout(t.u),t.u=null),Ns(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&P.clearTimeout(t.m),t.m=null)}function Hs(t){if(!mp(t.i)&&!t.m){t.m=!0;var e=t.Na;oi||Qf(),ai||(oi(),ai=!0),kl.add(e,t),t.C=0}}function YT(t,e){return yp(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=pi(Ne(t.Na,t,e),Op(t,t.C)),t.C++,!0)}I.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new mi(this,this.l,t),s=this.s;if(this.U&&(s?(s=Vf(s),zf(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=Rp(this,i,e),n=Gt(this.I),te(n,"RID",t),te(n,"CVER",22),this.F&&te(n,"X-HTTP-Session-Id",this.F),Ti(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(bp(s)))+"&"+e:this.o&&ql(n,this.o,s)),Fl(this.i,i),this.bb&&te(n,"TYPE","init"),this.P?(te(n,"$req",e),te(n,"SID","null"),i.aa=!0,yl(i,n,null)):yl(i,n,e),this.H=2}}else this.H==3&&(t?Mf(this,t):this.j.length==0||mp(this.i)||Mf(this))};function Mf(t,e){var n;e?n=e.m:n=t.W++;let r=Gt(t.I);te(r,"SID",t.K),te(r,"RID",n),te(r,"AID",t.V),Ti(t,r),t.o&&t.s&&ql(r,t.o,t.s),n=new mi(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Rp(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Fl(t.i,n),yl(n,r,e)}function Ti(t,e){t.na&&bl(t.na,function(n,r){te(e,r,n)}),t.h&&up({},function(n,r){te(e,r,n)})}function Rp(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Ne(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let l=0;l<n;l++){let c=i[l].g,h=i[l].map;if(c-=s,0>c)s=Math.max(0,i[l].g-100),a=!1;else try{GT(h,o,"req"+c+"_")}catch{r&&r(h)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function Dp(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;oi||Qf(),ai||(oi(),ai=!0),kl.add(e,t),t.A=0}}function Vl(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=pi(Ne(t.Ma,t),Op(t,t.A)),t.A++,!0)}I.Ma=function(){if(this.u=null,Np(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=pi(Ne(this.jb,this),t)}};I.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,qe(10),Ks(this),Np(this))};function zl(t){t.B!=null&&(P.clearTimeout(t.B),t.B=null)}function Np(t){t.g=new mi(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Gt(t.wa);te(e,"RID","rpc"),te(e,"SID",t.K),te(e,"AID",t.V),te(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&te(e,"TO",t.qa),te(e,"TYPE","xmlhttp"),Ti(t,e),t.o&&t.s&&ql(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=js(Gt(e)),n.u=null,n.S=!0,op(n,t)}I.ib=function(){this.v!=null&&(this.v=null,Ks(this),Vl(this),qe(19))};function Ns(t){t.v!=null&&(P.clearTimeout(t.v),t.v=null)}function kp(t,e){var n=null;if(t.g==e){Ns(t),zl(t),t.g=null;var r=2}else if(Sl(t.i,e))n=e.F,vp(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=Us(),be(r,new tp(r,n)),Hs(t)}else Dp(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&YT(t,e)||r==2&&Vl(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Pn(t,5);break;case 4:Pn(t,10);break;case 3:Pn(t,6);break;default:Pn(t,2)}}}function Op(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Pn(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Ne(t.pb,t);n||(n=new Ln("//www.google.com/images/cleardot.gif"),P.location&&P.location.protocol=="http"||Rs(n,"https"),js(n)),jT(n.toString(),r)}else qe(2);t.H=0,t.h&&t.h.za(e),xp(t),Ap(t)}I.pb=function(t){t?(this.l.info("Successfully pinged google.com"),qe(2)):(this.l.info("Failed to ping google.com"),qe(1))};function xp(t){if(t.H=0,t.ma=[],t.h){let e=Sp(t.i);(e.length!=0||t.j.length!=0)&&(bf(t.ma,e),bf(t.ma,t.j),t.i.i.length=0,Cl(t.j),t.j.length=0),t.h.ya()}}function Mp(t,e,n){var r=n instanceof Ln?Gt(n):new Ln(n);if(r.g!="")e&&(r.g=e+"."+r.g),Ds(r,r.m);else{var i=P.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Ln(null);r&&Rs(s,r),e&&(s.g=e),i&&Ds(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&te(r,n,e),te(r,"VER",t.ra),Ti(t,r),r}function Pp(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new ae(new vi({ob:n})):new ae(t.va),e.Oa(t.J),e}I.isActive=function(){return!!this.h&&this.h.isActive(this)};function Lp(){}I=Lp.prototype;I.Ba=function(){};I.Aa=function(){};I.za=function(){};I.ya=function(){};I.isActive=function(){return!0};I.Va=function(){};function ks(){if(nr&&!(10<=Number(fT)))throw Error("Environmental error: no available transport.")}ks.prototype.g=function(t,e){return new He(t,e)};function He(t,e){ye.call(this),this.g=new Ip(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!ii(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!ii(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new ir(this)}ve(He,ye);He.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;qe(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=Mp(t,null,t.Y),Hs(t)};He.prototype.close=function(){Ul(this.g)};He.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=Nl(t),t=n);e.j.push(new qT(e.fb++,t)),e.H==3&&Hs(e)};He.prototype.N=function(){this.g.h=null,delete this.j,Ul(this.g),delete this.g,He.$.N.call(this)};function Fp(t){Pl.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}ve(Fp,Pl);function Bp(){Ll.call(this),this.status=1}ve(Bp,Ll);function ir(t){this.g=t}ve(ir,Lp);ir.prototype.Ba=function(){be(this.g,"a")};ir.prototype.Aa=function(t){be(this.g,new Fp(t))};ir.prototype.za=function(t){be(this.g,new Bp)};ir.prototype.ya=function(){be(this.g,"b")};function XT(){this.blockSize=-1}function ht(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ve(ht,XT);ht.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function sl(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}ht.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)sl(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){sl(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){sl(this,r),i=0;break}}this.h=i,this.i+=e};ht.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function H(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var JT={};function Gl(t){return-128<=t&&128>t?uT(t,function(e){return new H([e|0],0>e?-1:0)}):new H([t|0],0>t?-1:0)}function Ct(t){if(isNaN(t)||!isFinite(t))return tr;if(0>t)return _e(Ct(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Tl;return new H(e,0)}function qp(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return _e(qp(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Ct(Math.pow(e,8)),r=tr,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Ct(Math.pow(e,s)),r=r.R(s).add(Ct(o))):(r=r.R(n),r=r.add(Ct(o)))}return r}var Tl=4294967296,tr=Gl(0),El=Gl(1),Pf=Gl(16777216);I=H.prototype;I.ea=function(){if(Je(this))return-_e(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Tl+r)*e,e*=Tl}return t};I.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(zt(this))return"0";if(Je(this))return"-"+_e(this).toString(t);for(var e=Ct(Math.pow(t,6)),n=this,r="";;){var i=xs(n,e).g;n=Os(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,zt(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};I.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function zt(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Je(t){return t.h==-1}I.X=function(t){return t=Os(this,t),Je(t)?-1:zt(t)?0:1};function _e(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new H(n,~t.h).add(El)}I.abs=function(){return Je(this)?_e(this):this};I.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new H(n,n[n.length-1]&-2147483648?-1:0)};function Os(t,e){return t.add(_e(e))}I.R=function(t){if(zt(this)||zt(t))return tr;if(Je(this))return Je(t)?_e(this).R(_e(t)):_e(_e(this).R(t));if(Je(t))return _e(this.R(_e(t)));if(0>this.X(Pf)&&0>t.X(Pf))return Ct(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,l=t.D(i)&65535;n[2*r+2*i]+=o*l,As(n,2*r+2*i),n[2*r+2*i+1]+=s*l,As(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,As(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,As(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new H(n,0)};function As(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function ei(t,e){this.g=t,this.h=e}function xs(t,e){if(zt(e))throw Error("division by zero");if(zt(t))return new ei(tr,tr);if(Je(t))return e=xs(_e(t),e),new ei(_e(e.g),_e(e.h));if(Je(e))return e=xs(t,_e(e)),new ei(_e(e.g),e.h);if(30<t.g.length){if(Je(t)||Je(e))throw Error("slowDivide_ only works with positive integers.");for(var n=El,r=e;0>=r.X(t);)n=Lf(n),r=Lf(r);var i=Zn(n,1),s=Zn(r,1);for(r=Zn(r,2),n=Zn(n,2);!zt(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Zn(r,1),n=Zn(n,1)}return e=Os(t,i.R(e)),new ei(i,e)}for(i=tr;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Ct(n),o=s.R(e);Je(o)||0<o.X(t);)n-=r,s=Ct(n),o=s.R(e);zt(s)&&(s=El),i=i.add(s),t=Os(t,o)}return new ei(i,t)}I.gb=function(t){return xs(this,t).h};I.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new H(n,this.h&t.h)};I.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new H(n,this.h|t.h)};I.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new H(n,this.h^t.h)};function Lf(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new H(n,t.h)}function Zn(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new H(i,t.h)}ks.prototype.createWebChannel=ks.prototype.g;He.prototype.send=He.prototype.u;He.prototype.open=He.prototype.m;He.prototype.close=He.prototype.close;Vs.NO_ERROR=0;Vs.TIMEOUT=8;Vs.HTTP_ERROR=6;np.COMPLETE="complete";rp.EventType=gi;gi.OPEN="a";gi.CLOSE="b";gi.ERROR="c";gi.MESSAGE="d";ye.prototype.listen=ye.prototype.O;ae.prototype.listenOnce=ae.prototype.P;ae.prototype.getLastError=ae.prototype.Sa;ae.prototype.getLastErrorCode=ae.prototype.Ia;ae.prototype.getStatus=ae.prototype.da;ae.prototype.getResponseJson=ae.prototype.Wa;ae.prototype.getResponseText=ae.prototype.ja;ae.prototype.send=ae.prototype.ha;ae.prototype.setWithCredentials=ae.prototype.Oa;ht.prototype.digest=ht.prototype.l;ht.prototype.reset=ht.prototype.reset;ht.prototype.update=ht.prototype.j;H.prototype.add=H.prototype.add;H.prototype.multiply=H.prototype.R;H.prototype.modulo=H.prototype.gb;H.prototype.compare=H.prototype.X;H.prototype.toNumber=H.prototype.ea;H.prototype.toString=H.prototype.toString;H.prototype.getBits=H.prototype.D;H.fromNumber=Ct;H.fromString=qp;var ZD=dt.createWebChannelTransport=function(){return new ks},eN=dt.getStatEventTarget=function(){return Us()},tN=dt.ErrorCode=Vs,nN=dt.EventType=np,rN=dt.Event=Fn,iN=dt.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},sN=dt.FetchXmlHttpFactory=vi,oN=dt.WebChannel=rp,aN=dt.XhrIo=ae,ZT=dt.Md5=ht,Up=dt.Integer=H;var Ad=Md(pS(),1),mR=Md(Bu(),1);var gS="@firebase/firestore",mS="4.4.0";var we=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};we.UNAUTHENTICATED=new we(null);we.GOOGLE_CREDENTIALS=new we("google-credentials-uid");we.FIRST_PARTY=new we("first-party-uid");we.MOCK_USER=new we("mock-user");var yR="10.7.0";var Yr=yR;function vR(t){Yr=t}function SR(t){return pR(t,{depth:100})}var Kr=new rf("@firebase/firestore");function ut(t,...e){if(Kr.logLevel<=hs.DEBUG){let n=e.map(Dd);Kr.debug(`Firestore (${Yr}): ${t}`,...n)}}function Rd(t,...e){if(Kr.logLevel<=hs.ERROR){let n=e.map(Dd);Kr.error(`Firestore (${Yr}): ${t}`,...n)}}function TR(t,...e){if(Kr.logLevel<=hs.WARN){let n=e.map(Dd);Kr.warn(`Firestore (${Yr}): ${t}`,...n)}}function Dd(t){if(typeof t=="string")return t;try{return SR(t)}catch{return t}}function We(t="Unexpected state"){let e=`FIRESTORE (${Yr}) INTERNAL ASSERTION FAILED: `+t;throw Rd(e),new Error(e)}function ld(t,e){t||We()}var Ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},me=class extends tf{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var On=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Wa=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},cd=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(we.UNAUTHENTICATED))}shutdown(){}},ud=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},hd=class{constructor(e){this.authProvider=e,this.currentUser=we.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.tokenCounter,i=l=>this.tokenCounter!==r?(r=this.tokenCounter,n(l)):Promise.resolve(),s=new On;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),s.resolve(),s=new On,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let l=s;e.enqueueRetryable(()=>U(this,null,function*(){yield l.promise,yield i(this.currentUser)}))},a=l=>{ut("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.tokenListener),o()};this.authProvider.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){let l=this.authProvider.getImmediate({optional:!0});l?a(l):(ut("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new On)}},0),o()}getToken(){let e=this.tokenCounter,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.tokenCounter!==e?(ut("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ld(typeof r.accessToken=="string"),new Wa(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.tokenListener)}getUser(){let e=this.auth&&this.auth.getUid();return ld(e===null||typeof e=="string"),new we(e)}},dd=class{constructor(e,n,r){this.sessionIndex=e,this.iamToken=n,this.authTokenFactory=r,this.type="FirstParty",this.user=we.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}},fd=class{constructor(e,n,r){this.sessionIndex=e,this.iamToken=n,this.authTokenFactory=r}getToken(){return Promise.resolve(new dd(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,n){e.enqueueRetryable(()=>n(we.FIRST_PARTY))}shutdown(){}invalidateToken(){}},pd=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},gd=class{constructor(e){this.appCheckProvider=e,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null}start(e,n){let r=s=>{s.error!=null&&ut("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.latestAppCheckToken;return this.latestAppCheckToken=s.token,ut("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.tokenListener=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{ut("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.appCheckProvider.getImmediate({optional:!0});s?i(s):ut("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ld(typeof n.token=="string"),this.latestAppCheckToken=n.token,new pd(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.tokenListener)}};function ER(t){if(!t)return new cd;switch(t.type){case"firstParty":return new fd(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new me(Ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}function wR(t){return gR(t)}var md=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="",i=20;for(;r.length<i;){let s=wR(40);for(let o=0;o<s.length;++o)r.length<i&&s[o]<n&&(r+=e.charAt(s[o]%e.length))}return r}};function bS(t,e){return t<e?-1:t>e?1:0}var yd=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&We(),r===void 0?r=e.length-n:r>e.length-n&&We(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},kn=class t extends yd{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new me(Ie.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}};var Hn=class t{constructor(e){this.path=e}static fromPath(e){return new t(kn.fromString(e))}static fromName(e){return new t(kn.fromString(e).popFirst(5))}static empty(){return new t(kn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&kn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return kn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2===0}static fromSegments(e){return new t(new kn(e.slice()))}};function IS(t){return t.name==="IndexedDbTransactionError"}var LO=15*1e3,FO=60*1e3;var CR="remoteDocuments";var AS="owner";var RS="mutationQueues";var DS="mutations";var NS="documentMutations",_R="remoteDocumentsV14";var kS="remoteDocumentGlobal";var OS="targets";var xS="targetDocuments";var MS="targetGlobal",PS="collectionParents";var LS="clientMetadata";var FS="bundles";var BS="namedQueries";var bR="indexConfiguration";var IR="indexState";var AR="indexEntries";var qS="documentOverlays";var RR=[RS,DS,NS,CR,OS,AS,MS,xS],DR=RR,NR=[...DR,LS],kR=[...NR,kS],OR=[...kR,PS],xR=[...OR,FS,BS],BO=[...xR,qS],MR=[RS,DS,NS,_R,OS,AS,MS,xS,LS,kS,PS,FS,BS,qS],PR=MR,qO=[...PR,bR,IR,AR];var Hr=class t{constructor(e,n){this.comparator=e,this.root=n||ns.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ns.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ns.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Wr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Wr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Wr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Wr(this.root,e,this.comparator,!0)}},Wr=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)this.isReverse?e=e.left:e=e.right;else if(s===0){this.nodeStack.push(e);break}else this.nodeStack.push(e),this.isReverse?e=e.right:e=e.left}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ns=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??t.EMPTY,this.right=o??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let n=this;return!n.left.isRed()&&!n.left.left.isRed()&&(n=n.moveRedLeft()),n=n.copy(null,null,null,n.left.removeMin(),null),n.fixUp()}remove(n,r){let i,s=this;if(r(n,s.key)<0)!s.left.isEmpty()&&!s.left.isRed()&&!s.left.left.isRed()&&(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(n,r),null);else{if(s.left.isRed()&&(s=s.rotateRight()),!s.right.isEmpty()&&!s.right.isRed()&&!s.right.left.isRed()&&(s=s.moveRedRight()),r(n,s.key)===0){if(s.right.isEmpty())return t.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(n,r))}return s.fixUp()}isRed(){return this.color}fixUp(){let n=this;return n.right.isRed()&&!n.left.isRed()&&(n=n.rotateLeft()),n.left.isRed()&&n.left.left.isRed()&&(n=n.rotateRight()),n.left.isRed()&&n.right.isRed()&&(n=n.colorFlip()),n}moveRedLeft(){let n=this.colorFlip();return n.right.left.isRed()&&(n=n.copy(null,null,null,null,n.right.rotateRight()),n=n.rotateLeft(),n=n.colorFlip()),n}moveRedRight(){let n=this.colorFlip();return n.left.left.isRed()&&(n=n.rotateRight(),n=n.colorFlip()),n}rotateLeft(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth(){let n=this.check();return Math.pow(2,n)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw We();let n=this.left.check();if(n!==this.right.check())throw We();return n+(this.isRed()?0:1)}}return t.EMPTY=null,t.RED=!0,t.BLACK=!1,t})(),vd=class{constructor(){this.size=0}get key(){throw We()}get value(){throw We()}get color(){throw We()}get left(){throw We()}get right(){throw We()}copy(e,n,r,i,s){return this}insert(e,n,r){return new ns(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};ns.EMPTY=new vd;var Ka=class t{constructor(e){this.comparator=e,this.data=new Hr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(n!==void 0?r=this.data.getIteratorFrom(n):r=this.data.getIterator();r.hasNext();){let i=r.getNext();if(!e(i.key))return}}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ha(this.data.getIterator())}getIteratorFrom(e){return new Ha(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Ha=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function LR(t){return Buffer.from(t,"base64").toString("binary")}function FR(t){return Buffer.from(t,"binary").toString("base64")}var Qr=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=LR(e);return new t(n)}static fromUint8Array(e){let n=BR(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return FR(this.binaryString)}toUint8Array(){return qR(this.binaryString)}approximateByteSize(){return this.binaryString.length*2}compareTo(e){return bS(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Qr.EMPTY_BYTE_STRING=new Qr("");function BR(t){let e="";for(let n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}function qR(t){let e=new Uint8Array(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}var UO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function yS(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function UR(t){return typeof t=="string"?Qr.fromBase64String(t):Qr.fromUint8Array(t)}var Sd=class{constructor(e,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}},Td="(default)",Ed=class t{constructor(e,n){this.projectId=e,this.database=n||Td}static empty(){return new t("","")}get isDefaultDatabase(){return this.database===Td}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};function VR(t,e){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new me(Ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ed(t.options.projectId,e)}function zR(t){return t===0&&1/t===1/-0}var GR="__max__";function jR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===GR}var VO=new Hr(Hn.comparator);var zO=new Hr(Hn.comparator);var GO=new Hr(Hn.comparator);var jO=new Ka(Hn.comparator);var $O=new Ka(bS);var WO=new Up([4294967295,4294967295],0);var KO=(()=>{let t={};return t.asc="ASCENDING",t.desc="DESCENDING",t})(),HO=(()=>{let t={};return t["<"]="LESS_THAN",t["<="]="LESS_THAN_OR_EQUAL",t[">"]="GREATER_THAN",t[">="]="GREATER_THAN_OR_EQUAL",t["=="]="EQUAL",t["!="]="NOT_EQUAL",t["array-contains"]="ARRAY_CONTAINS",t.in="IN",t["not-in"]="NOT_IN",t["array-contains-any"]="ARRAY_CONTAINS_ANY",t})(),QO=(()=>{let t={};return t.and="AND",t.or="OR",t})();var $R=5,WR=10,KR=13,vS=15,HR=20,QR=25,YR=30,XR=37,JR=45,ZR=50,e1=55,t1=60,n1=2,Qa=class{constructor(){}writeIndexValue(e,n){this.writeIndexValueAux(e,n),n.writeInfinity()}writeIndexValueAux(e,n){if("nullValue"in e)this.writeValueTypeLabel(n,$R);else if("booleanValue"in e)this.writeValueTypeLabel(n,WR),n.writeNumber(e.booleanValue?1:0);else if("integerValue"in e)this.writeValueTypeLabel(n,vS),n.writeNumber(yS(e.integerValue));else if("doubleValue"in e){let r=yS(e.doubleValue);isNaN(r)?this.writeValueTypeLabel(n,KR):(this.writeValueTypeLabel(n,vS),zR(r)?n.writeNumber(0):n.writeNumber(r))}else if("timestampValue"in e){let r=e.timestampValue;this.writeValueTypeLabel(n,HR),typeof r=="string"?n.writeString(r):(n.writeString(`${r.seconds||""}`),n.writeNumber(r.nanos||0))}else if("stringValue"in e)this.writeIndexString(e.stringValue,n),this.writeTruncationMarker(n);else if("bytesValue"in e)this.writeValueTypeLabel(n,YR),n.writeBytes(UR(e.bytesValue)),this.writeTruncationMarker(n);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.writeValueTypeLabel(n,JR),n.writeNumber(r.latitude||0),n.writeNumber(r.longitude||0)}else"mapValue"in e?jR(e)?this.writeValueTypeLabel(n,Number.MAX_SAFE_INTEGER):(this.writeIndexMap(e.mapValue,n),this.writeTruncationMarker(n)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,n),this.writeTruncationMarker(n)):We()}writeIndexString(e,n){this.writeValueTypeLabel(n,QR),this.writeUnlabeledIndexString(e,n)}writeUnlabeledIndexString(e,n){n.writeString(e)}writeIndexMap(e,n){let r=e.fields||{};this.writeValueTypeLabel(n,e1);for(let i of Object.keys(r))this.writeIndexString(i,n),this.writeIndexValueAux(r[i],n)}writeIndexArray(e,n){let r=e.values||[];this.writeValueTypeLabel(n,ZR);for(let i of r)this.writeIndexValueAux(i,n)}writeIndexEntityRef(e,n){this.writeValueTypeLabel(n,XR),Hn.fromName(e).path.forEach(i=>{this.writeValueTypeLabel(n,t1),this.writeUnlabeledIndexString(i,n)})}writeValueTypeLabel(e,n){e.writeNumber(n)}writeTruncationMarker(e){e.writeNumber(n1)}};Qa.INSTANCE=new Qa;var YO=new Uint8Array(0);var US=-1,VS=40*1024*1024,Ut=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Ut.DEFAULT_COLLECTION_PERCENTILE=10;Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3;Ut.DEFAULT=new Ut(VS,Ut.DEFAULT_COLLECTION_PERCENTILE,Ut.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT);Ut.DISABLED=new Ut(US,0,0);var SS=1*1024*1024,XO=1*60*1e3,JO=5*60*1e3;var ZO=30*60*1e3;var ex=5*60*1e6;var r1="1.9.1";var tx=`gl-node/${process.versions.node} fire/${Yr} grpc/${r1}`;var i1="ExponentialBackoff",s1=1e3,o1=1.5,a1=60*1e3,wd=class{constructor(e,n,r=s1,i=o1,s=a1){this.queue=e,this.timerId=n,this.initialDelayMs=r,this.backoffFactor=i,this.maxDelayMs=s,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let n=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,n-r);i>0&&ut(i1,`Backing off for ${i} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){this.timerPromise!==null&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){this.timerPromise!==null&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}};var nx=60*1e3,rx=10*1e3;var ix=10*1e3;var l1="AsyncQueue",Cd=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new On,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(Ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function c1(t,e){if(Rd(l1,`${e}: ${t}`),IS(t))return new me(Ie.UNAVAILABLE,`${e}: ${t}`);throw t}function u1(t,e,n,r){if(e===!0&&r===!0)throw new me(Ie.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function h1(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=d1(t);return e?`a custom ${e} object`:"an object"}}else return typeof t=="function"?"a function":We()}function d1(t){return t.constructor?t.constructor.name:null}function f1(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new me(Ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=h1(t);throw new me(Ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}var TS="FirestoreClient",p1=100;var _d=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=we.UNAUTHENTICATED,this.clientId=md.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>U(this,null,function*(){ut(TS,"Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(ut(TS,"Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}getConfiguration(){return U(this,null,function*(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:p1}})}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new me(Ie.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new On;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>U(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=c1(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function g1(t,e){return t.timeoutSeconds===e.timeoutSeconds}function zS(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var m1="ComponentProvider",ES=new Map;function y1(t){let e=ES.get(t);e&&(ut(m1,"Removing Datastore"),ES.delete(t),e.terminate())}function v1(t,e,n,r){return new Sd(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,zS(r.experimentalLongPollingOptions),r.useFetchStreams)}var GS="firestore.googleapis.com",wS=!0,CS=5,_S=30,S1=!0,Ya=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new me(Ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=GS,this.ssl=wS}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:wS;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=VS;else{if(e.cacheSizeBytes!==US&&e.cacheSizeBytes<SS)throw new me(Ie.INVALID_ARGUMENT,`cacheSizeBytes must be at least ${SS}`);this.cacheSizeBytes=e.cacheSizeBytes}u1("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=S1:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=zS((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),T1(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&g1(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};function T1(t){if(t.timeoutSeconds!==void 0){if(isNaN(t.timeoutSeconds))throw new me(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (must not be NaN)`);if(t.timeoutSeconds<CS)throw new me(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (minimum allowed value is ${CS})`);if(t.timeoutSeconds>_S)throw new me(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${t.timeoutSeconds} (maximum allowed value is ${_S})`)}}var Xa=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ya({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new me(Ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new me(Ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ya(e),e.credentials!==void 0&&(this._authCredentials=ER(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return y1(this),Promise.resolve()}};function jS(t,e,n,r={}){var i;t=f1(t,Xa);let s=t._getSettings(),o=`${e}:${n}`;if(s.host!==GS&&s.host!==o&&TR("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=we.MOCK_USER;else{a=ef(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new me(Ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new we(c)}t._authCredentials=new ud(new Wa(a,l))}}var E1="AsyncQueue",bd=class{constructor(){this.tail=Promise.resolve(),this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new wd(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()}}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let n=new On;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}retryNextOp(){return U(this,null,function*(){if(this.retryableOps.length!==0){try{yield this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(IS(e))ut(E1,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}})}enqueueInternal(e){let n=this.tail.then(()=>(this.operationInProgress=!0,e().catch(r=>{this.failure=r,this.operationInProgress=!1;let i=C1(r);throw Rd("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.operationInProgress=!1,r))));return this.tail=n,n}enqueueAfterDelay(e,n,r){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(n=0);let i=Cd.createAndSchedule(this,e,n,r,s=>this.removeDelayedOperation(s));return this.delayedOperations.push(i),i}verifyNotFailed(){this.failure&&We()}verifyOperationInProgress(){}drain(){return U(this,null,function*(){let e;do e=this.tail,yield e;while(e!==this.tail)})}containsDelayedOperation(e){for(let n of this.delayedOperations)if(n.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{this.delayedOperations.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.delayedOperations)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let n=this.delayedOperations.indexOf(e);this.delayedOperations.splice(n,1)}};function w1(){return new bd}function C1(t){let e=t.message||"";return t.stack&&(t.stack.includes(t.message)?e=t.stack:e=t.message+`
`+t.stack),e}var Id=class extends Xa{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=w1(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||_1(this),this._firestoreClient.terminate()}};function $S(t,e){let n=typeof t=="object"?t:lf(),r=typeof t=="string"?t:e||Td,i=of(n,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Zd("firestore");s&&jS(i,...s)}return i}function _1(t){var e,n,r;let i=t._freezeSettings(),s=v1(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new _d(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function b1(t,e=!0){vR(af),sf(new nf("firestore",(n,{instanceIdentifier:r,options:i})=>{let s=n.getProvider("app").getImmediate(),o=new Id(new hd(n.getProvider("auth-internal")),new gd(n.getProvider("app-check-internal")),VR(s,r),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),xn(gS,mS,t),xn(gS,mS,"esm2017")}var sx=new RegExp("[~\\*/\\[\\]]");b1("node");var rs=class{constructor(e){return e}},WS="firestore",Nd=class{constructor(){return ps(WS)}};var kd=new os("angularfire2.firestore-instances");function I1(t,e){let n=fs(WS,t,e);return n&&new rs(n)}function A1(t){return(e,n)=>{let r=e.runOutsideAngular(()=>t(n));return new rs(r)}}var R1={provide:Nd,deps:[[new Vt,kd]]},D1={provide:rs,useFactory:I1,deps:[[new Vt,kd],vs]},N1=(()=>{class t{constructor(){xn("angularfire",ds.full,"fst")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=as({type:t});static \u0275inj=ss({providers:[D1,R1]})}return t})();function KS(t,...e){return{ngModule:N1,providers:[{provide:kd,useFactory:A1(t),multi:!0,deps:[Xn,ls,ms,Ss,[new Vt,Jr],[new Vt,gs],...e]}]}}var HS=ys($S,!0);var k1="@",Od=class{constructor(e,n,r,i,s){this.doc=e,this.delegate=n,this.zone=r,this.animationType=i,this.moduleImpl=s,this._rendererFactoryPromise=null}loadImpl(){return(this.moduleImpl??import("./chunk-JHG2IHMO.mjs")).catch(n=>{throw new Pd(5300,!1)}).then(({\u0275createEngine:n,\u0275AnimationRendererFactory:r})=>{let i=n(this.animationType,this.doc),s=new r(this.delegate,i,this.zone);return this.delegate=s,s})}createRenderer(e,n){let r=this.delegate.createRenderer(e,n);if(r.\u0275type===0)return r;typeof r.throwOnSyntheticProps=="boolean"&&(r.throwOnSyntheticProps=!1);let i=new xd(r);return n?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(s=>{let o=s.createRenderer(e,n);i.use(o)}).catch(s=>{i.use(r)}),i}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}},xd=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let n of this.replay)n(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,n){return this.delegate.createElement(e,n)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,n){this.delegate.appendChild(e,n)}insertBefore(e,n,r,i){this.delegate.insertBefore(e,n,r,i)}removeChild(e,n,r){this.delegate.removeChild(e,n,r)}selectRootElement(e,n){return this.delegate.selectRootElement(e,n)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,n,r,i){this.delegate.setAttribute(e,n,r,i)}removeAttribute(e,n,r){this.delegate.removeAttribute(e,n,r)}addClass(e,n){this.delegate.addClass(e,n)}removeClass(e,n){this.delegate.removeClass(e,n)}setStyle(e,n,r,i){this.delegate.setStyle(e,n,r,i)}removeStyle(e,n,r){this.delegate.removeStyle(e,n,r)}setProperty(e,n,r){this.shouldReplay(n)&&this.replay.push(i=>i.setProperty(e,n,r)),this.delegate.setProperty(e,n,r)}setValue(e,n){this.delegate.setValue(e,n)}listen(e,n,r){return this.shouldReplay(n)&&this.replay.push(i=>i.listen(e,n,r)),this.delegate.listen(e,n,r)}shouldReplay(e){return this.replay!==null&&e.startsWith(k1)}};function QS(t="animations"){return Ld([{provide:Bd,useFactory:(e,n,r)=>new Od(e,n,r,t),deps:[Gd,Kd,Xn]},{provide:Fd,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}var YS={providers:[Jd(Ef),Qd(),en(hf(()=>df(Za.firebase))),en(ff),en(gf),$d(Wd()),en(cf.initializeApp(Za.firebase)),en(Cf(()=>_f())),en(KS(()=>HS())),en(pf,mf),QS(),Yd()]};var O1={providers:[Xd()]},XS=zd(YS,O1);var x1=()=>Hd(yf,XS),sP=x1;export{sP as a};
