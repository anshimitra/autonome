import{a as Ne,c as oe,e as Fe,g as xe,h as se,j as je,k as ae,n as Le,o as ce,p as V,q as E,r as m,s as ue}from"./chunk-VAMLT4MJ.js";import{a as Ue,c as We}from"./chunk-TCKOSIPS.js";import{b as Me,j as $e}from"./chunk-CZMSP4ID.js";import{v as Oe}from"./chunk-V7WGXI6X.js";import{G as _e,K as re,M as P,Mb as De,N as ne,Nb as z,P as Se,Qa as w,T as D,U as x,X as p,Xb as ie,Y as u,aa as j,c as C,f as Ie,h as ye,i as be,k as v,ka as L,l as b,m as te,n as F,r as B,ra as Ce,va as O,y as Pe,z as Re}from"./chunk-3FRMDLHP.js";import{f as T}from"./chunk-CQCHLVVT.js";var ot="firebase",st="10.7.1";E(ot,st,"app");var _=new De("ANGULARFIRE2_VERSION");function Yn(e,n,t){if(n){if(n.length===1)return n[0];let o=n.filter(s=>s.app===t);if(o.length===1)return o[0]}return t.container.getProvider(e).getImmediate({optional:!0})}var at=(e,n)=>{let t=n?[n]:V(),r=[];return t.forEach(i=>{i.container.getProvider(e).instances.forEach(s=>{r.includes(s)||r.push(s)})}),r},$=class{constructor(){return at(ct)}},ct="app-check";function M(){}var K=class{zone;delegate;constructor(n,t=be){this.zone=n,this.delegate=t}now(){return this.delegate.now()}schedule(n,t,r){let i=this.zone,o=function(s){i.runGuarded(()=>{n.apply(this,[s])})};return this.delegate.schedule(o,t,r)}},le=class{zone;task=null;constructor(n){this.zone=n}call(n,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",M,{},M,M)),t.pipe(Se({next:r,complete:r,error:r})).subscribe(n).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},q=(()=>{class e{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new K(Zone.current)),this.insideAngular=t.run(()=>new K(Zone.current,ye)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||e)(u(w))};static \u0275prov=D({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function Z(){let e=globalThis.\u0275AngularFireScheduler;if(!e)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return e}function ut(e){return Z().ngZone.runOutsideAngular(()=>e())}function R(e){return Z().ngZone.run(()=>e())}function de(e){return lt(Z())(e)}function lt(e){return function(t){return t=t.lift(new le(e.ngZone)),t.pipe(b(e.outsideAngular),v(e.insideAngular))}}var dt=(e,n)=>function(){let r=arguments;return n&&setTimeout(()=>{n.state==="scheduled"&&n.invoke()},10),R(()=>e.apply(void 0,r))},He=(e,n)=>function(){let t,r=arguments;for(let o=0;o<arguments.length;o++)typeof r[o]=="function"&&(n&&(t||=R(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",M,{},M,M))),r[o]=dt(r[o],t));let i=ut(()=>e.apply(this,r));if(!n)if(i instanceof C){let o=Z();return i.pipe(b(o.outsideAngular),v(o.insideAngular))}else return R(()=>i);return i instanceof C?i.pipe(de):i instanceof Promise?R(()=>new Promise((o,s)=>i.then(a=>R(()=>o(a)),a=>R(()=>s(a))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:R(()=>i)};var U=class{constructor(n){return n}},pe=class{constructor(){return V()}};function ht(e){return e&&e.length===1?e[0]:new U(ce())}var he=new p("angularfire2._apps"),ft={provide:U,useFactory:ht,deps:[[new L,he]]},gt={provide:pe,deps:[[new L,he]]};function mt(e){return(n,t)=>{let r=n.runOutsideAngular(()=>e(t));return new U(r)}}var At=(()=>{class e{constructor(t){E("angularfire",_.full,"core"),E("angularfire",_.full,"app"),E("angular",z.full,t.toString())}static \u0275fac=function(r){return new(r||e)(u(O))};static \u0275mod=j({type:e});static \u0275inj=x({providers:[ft,gt]})}return e})();function si(e,...n){return{ngModule:At,providers:[{provide:he,useFactory:mt(e),multi:!0,deps:[w,Ce,q,...n]}]}}var ai=He(Le,!0);var Et=new Map,kt={activated:!1,tokenObservers:[]},Tt={initialized:!1,enabled:!1};function f(e){return Et.get(e)||Object.assign({},kt)}function Ge(){return Tt}var vt="https://content-firebaseappcheck.googleapis.com/v1";var wt="exchangeDebugToken",Be={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Ti=24*60*60*1e3;var ge=class{constructor(n,t,r,i,o){if(this.operation=n,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=o,this.pending=null,this.nextErrorWaitInterval=i,i>o)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(n){return T(this,null,function*(){this.stop();try{this.pending=new oe,this.pending.promise.catch(t=>{}),yield It(this.getNextRun(n)),this.pending.resolve(),yield this.pending.promise,this.pending=new oe,this.pending.promise.catch(t=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(n){if(n)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function It(e){return new Promise(n=>{setTimeout(n,e)})}var yt={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},I=new xe("appCheck","AppCheck",yt);function qe(e){if(!f(e).activated)throw I.create("use-before-activation",{appName:e.name})}function Ze(r,i){return T(this,arguments,function*({url:e,body:n},t){let o={"Content-Type":"application/json"},s=t.getImmediate({optional:!0});if(s){let h=yield s.getHeartbeatsHeader();h&&(o["X-Firebase-Client"]=h)}let a={method:"POST",body:JSON.stringify(n),headers:o},c;try{c=yield fetch(e,a)}catch(h){throw I.create("fetch-network-error",{originalErrorMessage:h?.message})}if(c.status!==200)throw I.create("fetch-status-error",{httpStatus:c.status});let d;try{d=yield c.json()}catch(h){throw I.create("fetch-parse-error",{originalErrorMessage:h?.message})}let g=d.ttl.match(/^([\d.]+)(s)$/);if(!g||!g[2]||isNaN(Number(g[1])))throw I.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${d.ttl}`});let S=Number(g[1])*1e3,H=Date.now();return{token:d.token,expireTimeMillis:H+S,issuedAtTimeMillis:H}})}function Xe(e,n){let{projectId:t,appId:r,apiKey:i}=e.options;return{url:`${vt}/projects/${t}/apps/${r}:${wt}?key=${i}`,body:{debug_token:n}}}var bt="firebase-app-check-database",Pt=1,me="firebase-app-check-store";var X=null;function Rt(){return X||(X=new Promise((e,n)=>{try{let t=indexedDB.open(bt,Pt);t.onsuccess=r=>{e(r.target.result)},t.onerror=r=>{var i;n(I.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(me,{keyPath:"compositeKey"})}}}catch(t){n(I.create("storage-open",{originalErrorMessage:t?.message}))}}),X)}function _t(e,n){return St(Ct(e),n)}function St(e,n){return T(this,null,function*(){let r=(yield Rt()).transaction(me,"readwrite"),o=r.objectStore(me).put({compositeKey:e,value:n});return new Promise((s,a)=>{o.onsuccess=c=>{s()},r.onerror=c=>{var d;a(I.create("storage-set",{originalErrorMessage:(d=c.target.error)===null||d===void 0?void 0:d.message}))}})})}function Ct(e){return`${e.options.appId}-${e.name}`}var Ae=new je("@firebase/app-check");function fe(e,n){return Fe()?_t(e,n).catch(t=>{Ae.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function Ye(){return Ge().enabled}function Je(){return T(this,null,function*(){let e=Ge();if(e.enabled&&e.token)return e.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Dt={error:"UNKNOWN_ERROR"};function Ot(e){return Ne.encodeString(JSON.stringify(e),!1)}function Ee(e,n=!1){return T(this,null,function*(){let t=e.app;qe(t);let r=f(t),i=r.token,o;if(i&&!W(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(W(c)?i=c:yield fe(t,void 0))}if(!n&&i&&W(i))return{token:i.token};let s=!1;if(Ye()){r.exchangeTokenPromise||(r.exchangeTokenPromise=Ze(Xe(t,yield Je()),e.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),s=!0);let c=yield r.exchangeTokenPromise;return yield fe(t,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),s=!0),i=yield f(t).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Ae.warn(c.message):Ae.error(c),o=c}let a;return i?o?W(i)?a={token:i.token,internalError:o}:a=Ve(o):(a={token:i.token},r.token=i,yield fe(t,i)):a=Ve(o),s&&xt(t,a),a})}function Mt(e){return T(this,null,function*(){let n=e.app;qe(n);let{provider:t}=f(n);if(Ye()){let r=yield Je(),{token:i}=yield Ze(Xe(n,r),e.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield t.getToken();return{token:r}}})}function Nt(e,n,t,r){let{app:i}=e,o=f(i),s={next:t,error:r,type:n};if(o.tokenObservers=[...o.tokenObservers,s],o.token&&W(o.token)){let a=o.token;Promise.resolve().then(()=>{t({token:a.token}),ze(e)}).catch(()=>{})}o.cachedTokenPromise.then(()=>ze(e))}function Qe(e,n){let t=f(e),r=t.tokenObservers.filter(i=>i.next!==n);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function ze(e){let{app:n}=e,t=f(n),r=t.tokenRefresher;r||(r=Ft(e),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Ft(e){let{app:n}=e;return new ge(()=>T(this,null,function*(){let t=f(n),r;if(t.token?r=yield Ee(e,!0):r=yield Ee(e),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let t=f(n);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Be.RETRIAL_MIN_WAIT,Be.RETRIAL_MAX_WAIT)}function xt(e,n){let t=f(e).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&n.error!=null?r.error(n.error):r.next(n)}catch{}}function W(e){return e.expireTimeMillis-Date.now()>0}function Ve(e){return{token:Ot(Dt),error:e}}var ke=class{constructor(n,t){this.app=n,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:n}=f(this.app);for(let t of n)Qe(this.app,t.next);return Promise.resolve()}};function jt(e,n){return new ke(e,n)}function Lt(e){return{getToken:n=>Ee(e,n),getLimitedUseToken:()=>Mt(e),addTokenListener:n=>Nt(e,"INTERNAL",n),removeTokenListener:n=>Qe(e.app,n)}}var $t="@firebase/app-check",Ut="0.8.1";var Wt="app-check",Ke="app-check-internal";function Ht(){ae(new se(Wt,e=>{let n=e.getProvider("app").getImmediate(),t=e.getProvider("heartbeat");return jt(n,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,t)=>{e.getProvider(Ke).initialize()})),ae(new se(Ke,e=>{let n=e.getProvider("app-check").getImmediate();return Lt(n)},"PUBLIC").setInstantiationMode("EXPLICIT")),E($t,Ut)}Ht();var Bt=["localhost","0.0.0.0","127.0.0.1"],Oi=typeof window<"u"&&Bt.includes(window.location.hostname);var Vt="firebase",Kt="10.7.1";m.registerVersion(Vt,Kt,"app-compat");var Gt=["ngOnDestroy"],tt=(e,n,t,r={})=>new Proxy(e,{get:(i,o)=>t.runOutsideAngular(()=>{if(e[o])return r?.spy?.get&&r.spy.get(o,e[o]),e[o];if(Gt.indexOf(o)>-1)return()=>{};let s=n.toPromise().then(a=>{let c=a?.[o];return typeof c=="function"?c.bind(a):c?.then?c.then(d=>t.run(()=>d)):t.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>s[c],apply:(a,c,d)=>s.then(g=>{let S=g?.(...d);return r?.spy?.apply&&r.spy.apply(o,d,S),S})})})});var Y=class{constructor(n){return n}},J=new p("angularfire2.app.options"),Q=new p("angularfire2.app.name");function Te(e,n,t){let r=typeof t=="string"&&t||"[DEFAULT]",i=typeof t=="object"&&t||{};i.name=i.name||r;let s=m.apps.filter(a=>a&&a.name===i.name)[0]||n.runOutsideAngular(()=>m.initializeApp(e,i));try{if(JSON.stringify(e)!==JSON.stringify(s.options)){let a=!!module.hot;qt("error",`${s.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Y(s)}var qt=(e,...n)=>{ie()&&typeof console<"u"&&console[e](...n)},Zt={provide:Y,useFactory:Te,deps:[J,w,[new L,Q]]},Bi=(()=>{class e{static initializeApp(t,r){return{ngModule:e,providers:[{provide:J,useValue:t},{provide:Q,useValue:r}]}}constructor(t){m.registerVersion("angularfire",_.full,"core"),m.registerVersion("angularfire",_.full,"app-compat"),m.registerVersion("angular",z.full,t.toString())}static \u0275fac=function(r){return new(r||e)(u(O))};static \u0275mod=j({type:e});static \u0275inj=x({providers:[Zt]})}return e})();function rt(e,n,t,r,i){let[,o,s]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===e)||[];if(o)return Xt(i,s)||(et("error",`${n} was already initialized on the ${t} Firebase App with different settings.${Yt?" You may need to reload as Firebase is not HMR aware.":""}`),et("warn",{is:i,was:s})),o;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([e,a,i]),a}}function Xt(e,n){try{return e.toString()===n.toString()}catch{return e===n}}var Yt=typeof module<"u"&&!!module.hot,et=(e,...n)=>{ie()&&typeof console<"u"&&console[e](...n)};globalThis.\u0275AngularfireInstanceCache||=[];var Jt=new p("angularfire2.auth.use-emulator"),Qt=new p("angularfire2.auth.settings"),er=new p("angularfire2.auth.tenant-id"),tr=new p("angularfire2.auth.langugage-code"),rr=new p("angularfire2.auth.use-device-language"),nr=new p("angularfire.auth.persistence"),ir=(e,n,t,r,i,o,s,a)=>rt(`${e.name}.auth`,"AngularFireAuth",e.name,()=>{let c=n.runOutsideAngular(()=>e.auth());if(t&&c.useEmulator(...t),r&&(c.tenantId=r),c.languageCode=i,o&&c.useDeviceLanguage(),s)for(let[d,g]of Object.entries(s))c.settings[d]=g;return a&&c.setPersistence(a),c},[t,r,i,o,s,a]),nt=(()=>{class e{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,o,s,a,c,d,g,S,H,h){let ve=new Ie,N=F(void 0).pipe(v(s.outsideAngular),P(()=>o.runOutsideAngular(()=>import("./chunk-SNFXN3EY.js"))),B(()=>Te(t,o,r)),B(k=>ir(k,o,a,d,g,S,c,H)),re({bufferSize:1,refCount:!1}));if(Oe(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=F(null);else{N.pipe(_e()).subscribe();let k=N.pipe(P(l=>l.getRedirectResult().then(A=>A,()=>null)),de,re({bufferSize:1,refCount:!1})),we=N.pipe(P(l=>new C(A=>({unsubscribe:o.runOutsideAngular(()=>l.onAuthStateChanged(y=>A.next(y),y=>A.error(y),()=>A.complete()))})))),ee=N.pipe(P(l=>new C(A=>({unsubscribe:o.runOutsideAngular(()=>l.onIdTokenChanged(y=>A.next(y),y=>A.error(y),()=>A.complete()))}))));this.authState=k.pipe(ne(we),b(s.outsideAngular),v(s.insideAngular)),this.user=k.pipe(ne(ee),b(s.outsideAngular),v(s.insideAngular)),this.idToken=this.user.pipe(P(l=>l?te(l.getIdToken()):F(null))),this.idTokenResult=this.user.pipe(P(l=>l?te(l.getIdTokenResult()):F(null))),this.credential=Pe(k,ve,this.authState.pipe(Re(l=>!l))).pipe(B(l=>l?.user?l:null),b(s.outsideAngular),v(s.insideAngular))}return tt(this,N,o,{spy:{apply:(k,we,ee)=>{(k.startsWith("signIn")||k.startsWith("createUser"))&&ee.then(l=>ve.next(l))}}})}static \u0275fac=function(r){return new(r||e)(u(J),u(Q,8),u(O),u(w),u(q),u(Jt,8),u(Qt,8),u(er,8),u(tr,8),u(rr,8),u(nr,8),u($,8))};static \u0275prov=D({token:e,factory:e.\u0275fac,providedIn:"any"})}return e})();var co=(()=>{let n=class n{constructor(r,i,o,s){this.afAuth=r,this.http=i,this.router=o,this.messageService=s,this.baseUrl=Ue.baseUrl}login(){let r=new ue;this.afAuth.signInWithPopup(r).then(i=>{let o=i.user,s={id:o?.uid,email:o?.email,name:o?.displayName,photoURL:o?.photoURL,status:!0,role:10,createdAt:new Date().toLocaleString()};this.getUserByEmail(s.email).subscribe(a=>{a.length>0?(this.messageService.add({severity:"success",summary:"Success",detail:"You are loggedIn"}),localStorage.setItem("user",JSON.stringify(a[0])),setTimeout(()=>{this.router.navigate(["/project"],{queryParams:{userId:a[0].id}})},2e3)):this.addUser(s).subscribe(c=>{this.messageService.add({severity:"success",summary:"Success",detail:"You are registered"}),localStorage.setItem("user",JSON.stringify(c)),setTimeout(()=>{this.router.navigate(["/project"],{queryParams:{userId:s.id}})},2e3)},c=>{this.messageService.add({severity:"error",summary:"Error",detail:"Error Adding User"}),console.log("Error Adding User",c)})},a=>{this.messageService.add({severity:"error",summary:"Error",detail:"Login failed"})})},i=>{this.messageService.add({severity:"error",summary:"Error",detail:"Login failed"})})}addUser(r){return this.http.post(`${this.baseUrl}/users`,r)}getUserByEmail(r){return this.http.get(`${this.baseUrl}/users?email=${r}`)}};n.\u0275fac=function(i){return new(i||n)(u(nt),u(Me),u($e),u(We))},n.\u0275prov=D({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();export{_ as a,Yn as b,at as c,$ as d,q as e,He as f,Bi as g,U as h,pe as i,si as j,ai as k,co as l};
